<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7 : Virtual lab admin interface : /admin/oauth/Auth/OpenID/FileStore.php source</title>
    <link rel="stylesheet" href="../../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Virtual lab admin interface</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7 at Tue Dec  7 15:36:31 2010 -->
<!-- PHPXref (c) 2000-2007 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../../';
subdir='admin/oauth/Auth/OpenID';
filename='FileStore.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/admin/oauth/Auth/OpenID/</a> -> <a href="FileStore.php.html">FileStore.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="FileStore.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="FileStore.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">/**</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> * This file supplies a Memcached store backend for OpenID servers and</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * consumers.</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> *</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> * PHP versions 4 and 5</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> *</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * LICENSE: See the COPYING file included in this distribution.</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> *</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> * @author JanRain, Inc. &lt;openid@janrain.com&gt;</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * @copyright 2005-2008 Janrain, Inc.</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> * @license http://www.apache.org/licenses/LICENSE-2.0 Apache</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> */</span>
<a name="l16"><span class="linenum">  16</span></a>  
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment">/**</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> * Require base class for creating a new interface.</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> */</span>
<a name="l20"><span class="linenum">  20</span></a>  require_once 'Auth/OpenID.php';
<a name="l21"><span class="linenum">  21</span></a>  require_once 'Auth/OpenID/Interface.php';
<a name="l22"><span class="linenum">  22</span></a>  require_once 'Auth/OpenID/HMAC.php';
<a name="l23"><span class="linenum">  23</span></a>  require_once 'Auth/OpenID/Nonce.php';
<a name="l24"><span class="linenum">  24</span></a>  
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment">/**</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> * This is a filesystem-based store for OpenID associations and</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> * nonces.  This store should be safe for use in concurrent systems on</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * both windows and unix (excluding NFS filesystems).  There are a</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * couple race conditions in the system, but those failure cases have</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> * been set up in such a way that the worst-case behavior is someone</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * having to try to log in a second time.</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> *</span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * Most of the methods of this class are implementation details.</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * People wishing to just use this store need only pay attention to</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * the constructor.</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> *</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> */</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('Auth_OpenID_OpenIDStore')" href="../../../../_classes/auth_openid_openidstore.html" onMouseOver="classPopup(event,'auth_openid_openidstore')">Auth_OpenID_OpenIDStore</a> {
<a name="l40"><span class="linenum">  40</span></a>  
<a name="l41"><span class="linenum">  41</span></a>      <span class="comment">/**</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment">     * Initializes a new {@link Auth_OpenID_FileStore}.  This</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment">     * initializes the nonce and association directories, which are</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment">     * subdirectories of the directory passed in.</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment">     *</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment">     * @param string $directory This is the directory to put the store</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment">     * directories in.</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment">     */</span>
<a name="l49"><span class="linenum">  49</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_FileStore')" href="../../../../_functions/auth_openid_filestore.html" onMouseOver="funcPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a>)
<a name="l50"><span class="linenum">  50</span></a>      {
<a name="l51"><span class="linenum">  51</span></a>          if (!<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('ensureDir')" href="../../../../_functions/ensuredir.html" onMouseOver="funcPopup(event,'ensuredir')">ensureDir</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a>)) {
<a name="l52"><span class="linenum">  52</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>('Not a directory and failed to create: '
<a name="l53"><span class="linenum">  53</span></a>                            . <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a>, E_USER_ERROR);
<a name="l54"><span class="linenum">  54</span></a>          }
<a name="l55"><span class="linenum">  55</span></a>          <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a> = <a class="phpfunction" onClick="logFunction('realpath')" href="../../../../_functions/realpath.html" onMouseOver="phpfuncPopup(event,'realpath')">realpath</a>(<a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a>);
<a name="l56"><span class="linenum">  56</span></a>  
<a name="l57"><span class="linenum">  57</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('directory')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/directory.html">directory</a> = <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a>;
<a name="l58"><span class="linenum">  58</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('active')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/active.html">active</a> = true;
<a name="l59"><span class="linenum">  59</span></a>  
<a name="l60"><span class="linenum">  60</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nonce_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/nonce_dir.html">nonce_dir</a> = <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a> . <a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a> . 'nonces';
<a name="l61"><span class="linenum">  61</span></a>  
<a name="l62"><span class="linenum">  62</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('association_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/association_dir.html">association_dir</a> = <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a> . <a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a> .
<a name="l63"><span class="linenum">  63</span></a>              'associations';
<a name="l64"><span class="linenum">  64</span></a>  
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment">        // Temp dir must be on the same filesystem as the assciations</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment">        // $directory.</span>
<a name="l67"><span class="linenum">  67</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('temp_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/temp_dir.html">temp_dir</a> = <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a> . <a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a> . 'temp';
<a name="l68"><span class="linenum">  68</span></a>  
<a name="l69"><span class="linenum">  69</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('max_nonce_age')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/max_nonce_age.html">max_nonce_age</a> = 6 * 60 * 60; <span class="comment">// Six hours, in seconds</span>
<a name="l70"><span class="linenum">  70</span></a>  
<a name="l71"><span class="linenum">  71</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_setup')" href="../../../../_functions/_setup.html" onMouseOver="funcPopup(event,'_setup')">_setup</a>()) {
<a name="l72"><span class="linenum">  72</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>('Failed to initialize OpenID file store in ' .
<a name="l73"><span class="linenum">  73</span></a>                            <a class="var it167" onMouseOver="hilite(167)" onMouseOut="lolite()" onClick="logVariable('directory')" href="../../../../_variables/directory.html">$directory</a>, E_USER_ERROR);
<a name="l74"><span class="linenum">  74</span></a>          }
<a name="l75"><span class="linenum">  75</span></a>      }
<a name="l76"><span class="linenum">  76</span></a>  
<a name="l77"><span class="linenum">  77</span></a>      function <a class="function" onClick="logFunction('destroy')" href="../../../../_functions/destroy.html" onMouseOver="funcPopup(event,'destroy')">destroy</a>()
<a name="l78"><span class="linenum">  78</span></a>      {
<a name="l79"><span class="linenum">  79</span></a>          <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_rmtree')" href="../../../../_functions/_rmtree.html" onMouseOver="funcPopup(event,'_rmtree')">_rmtree</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('directory')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/directory.html">directory</a>);
<a name="l80"><span class="linenum">  80</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('active')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/active.html">active</a> = false;
<a name="l81"><span class="linenum">  81</span></a>      }
<a name="l82"><span class="linenum">  82</span></a>  
<a name="l83"><span class="linenum">  83</span></a>      <span class="comment">/**</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment">     * Make sure that the directories in which we store our data</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment">     * exist.</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment">     *</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment">     * @access private</span>
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment">     */</span>
<a name="l89"><span class="linenum">  89</span></a>      function <a class="function" onClick="logFunction('_setup')" href="../../../../_functions/_setup.html" onMouseOver="funcPopup(event,'_setup')">_setup</a>()
<a name="l90"><span class="linenum">  90</span></a>      {
<a name="l91"><span class="linenum">  91</span></a>          return (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('ensureDir')" href="../../../../_functions/ensuredir.html" onMouseOver="funcPopup(event,'ensuredir')">ensureDir</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nonce_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/nonce_dir.html">nonce_dir</a>) &amp;&amp;
<a name="l92"><span class="linenum">  92</span></a>                  <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('ensureDir')" href="../../../../_functions/ensuredir.html" onMouseOver="funcPopup(event,'ensuredir')">ensureDir</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('association_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/association_dir.html">association_dir</a>) &amp;&amp;
<a name="l93"><span class="linenum">  93</span></a>                  <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('ensureDir')" href="../../../../_functions/ensuredir.html" onMouseOver="funcPopup(event,'ensuredir')">ensureDir</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('temp_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/temp_dir.html">temp_dir</a>));
<a name="l94"><span class="linenum">  94</span></a>      }
<a name="l95"><span class="linenum">  95</span></a>  
<a name="l96"><span class="linenum">  96</span></a>      <span class="comment">/**</span>
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment">     * Create a temporary file on the same filesystem as</span>
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment">     * $this-&gt;association_dir.</span>
<a name="l99"><span class="linenum">  99</span></a>  <span class="comment">     *</span>
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment">     * The temporary directory should not be cleaned if there are any</span>
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment">     * processes using the store. If there is no active process using</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment">     * the store, it is safe to remove all of the files in the</span>
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment">     * temporary directory.</span>
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment">     *</span>
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment">     * @return array ($fd, $filename)</span>
<a name="l106"><span class="linenum"> 106</span></a>  <span class="comment">     * @access private</span>
<a name="l107"><span class="linenum"> 107</span></a>  <span class="comment">     */</span>
<a name="l108"><span class="linenum"> 108</span></a>      function <a class="function" onClick="logFunction('_mktemp')" href="../../../../_functions/_mktemp.html" onMouseOver="funcPopup(event,'_mktemp')">_mktemp</a>()
<a name="l109"><span class="linenum"> 109</span></a>      {
<a name="l110"><span class="linenum"> 110</span></a>          <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a> = <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_mkstemp')" href="../../../../_functions/_mkstemp.html" onMouseOver="funcPopup(event,'_mkstemp')">_mkstemp</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('temp_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/temp_dir.html">temp_dir</a>);
<a name="l111"><span class="linenum"> 111</span></a>          <a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('file_obj')" href="../../../../_variables/file_obj.html">$file_obj</a> = @fopen(<a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a>, 'wb');
<a name="l112"><span class="linenum"> 112</span></a>          if (<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('file_obj')" href="../../../../_variables/file_obj.html">$file_obj</a> !== false) {
<a name="l113"><span class="linenum"> 113</span></a>              return array(<a class="var it174" onMouseOver="hilite(174)" onMouseOut="lolite()" onClick="logVariable('file_obj')" href="../../../../_variables/file_obj.html">$file_obj</a>, <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a>);
<a name="l114"><span class="linenum"> 114</span></a>          } else {
<a name="l115"><span class="linenum"> 115</span></a>              <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a>);
<a name="l116"><span class="linenum"> 116</span></a>          }
<a name="l117"><span class="linenum"> 117</span></a>      }
<a name="l118"><span class="linenum"> 118</span></a>  
<a name="l119"><span class="linenum"> 119</span></a>      function <a class="function" onClick="logFunction('cleanupNonces')" href="../../../../_functions/cleanupnonces.html" onMouseOver="funcPopup(event,'cleanupnonces')">cleanupNonces</a>()
<a name="l120"><span class="linenum"> 120</span></a>      {
<a name="l121"><span class="linenum"> 121</span></a>          global <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('Auth_OpenID_SKEW')" href="../../../../_variables/Auth_OpenID_SKEW.html">$Auth_OpenID_SKEW</a>;
<a name="l122"><span class="linenum"> 122</span></a>  
<a name="l123"><span class="linenum"> 123</span></a>          <a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('nonces')" href="../../../../_variables/nonces.html">$nonces</a> = <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_listdir')" href="../../../../_functions/_listdir.html" onMouseOver="funcPopup(event,'_listdir')">_listdir</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nonce_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/nonce_dir.html">nonce_dir</a>);
<a name="l124"><span class="linenum"> 124</span></a>          <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../../../_variables/now.html">$now</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l125"><span class="linenum"> 125</span></a>  
<a name="l126"><span class="linenum"> 126</span></a>          <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('removed')" href="../../../../_variables/removed.html">$removed</a> = 0;
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment">        // Check all nonces for expiry</span>
<a name="l128"><span class="linenum"> 128</span></a>          foreach (<a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('nonces')" href="../../../../_variables/nonces.html">$nonces</a> as <a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('nonce_fname')" href="../../../../_variables/nonce_fname.html">$nonce_fname</a>) {
<a name="l129"><span class="linenum"> 129</span></a>              <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('base')" href="../../../../_variables/base.html">$base</a> = <a class="phpfunction" onClick="logFunction('basename')" href="../../../../_functions/basename.html" onMouseOver="phpfuncPopup(event,'basename')">basename</a>(<a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('nonce_fname')" href="../../../../_variables/nonce_fname.html">$nonce_fname</a>);
<a name="l130"><span class="linenum"> 130</span></a>              <a class="var it37" onMouseOver="hilite(37)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../../../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('-', <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('base')" href="../../../../_variables/base.html">$base</a>, 2);
<a name="l131"><span class="linenum"> 131</span></a>              <a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../../../_variables/timestamp.html">$timestamp</a> = <a class="var it37" onMouseOver="hilite(37)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../../../_variables/parts.html">$parts</a>[0];
<a name="l132"><span class="linenum"> 132</span></a>              <a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../../../_variables/timestamp.html">$timestamp</a> = <a class="phpfunction" onClick="logFunction('intval')" href="../../../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../../../_variables/timestamp.html">$timestamp</a>, 16);
<a name="l133"><span class="linenum"> 133</span></a>              if (<a class="phpfunction" onClick="logFunction('abs')" href="../../../../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>(<a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../../../_variables/timestamp.html">$timestamp</a> - <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../../../_variables/now.html">$now</a>) &gt; <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('Auth_OpenID_SKEW')" href="../../../../_variables/Auth_OpenID_SKEW.html">$Auth_OpenID_SKEW</a>) {
<a name="l134"><span class="linenum"> 134</span></a>                  <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it179" onMouseOver="hilite(179)" onMouseOut="lolite()" onClick="logVariable('nonce_fname')" href="../../../../_variables/nonce_fname.html">$nonce_fname</a>);
<a name="l135"><span class="linenum"> 135</span></a>                  <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('removed')" href="../../../../_variables/removed.html">$removed</a> += 1;
<a name="l136"><span class="linenum"> 136</span></a>              }
<a name="l137"><span class="linenum"> 137</span></a>          }
<a name="l138"><span class="linenum"> 138</span></a>          return <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('removed')" href="../../../../_variables/removed.html">$removed</a>;
<a name="l139"><span class="linenum"> 139</span></a>      }
<a name="l140"><span class="linenum"> 140</span></a>  
<a name="l141"><span class="linenum"> 141</span></a>      <span class="comment">/**</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment">     * Create a unique filename for a given server url and</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment">     * handle. This implementation does not assume anything about the</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment">     * format of the handle. The filename that is returned will</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment">     * contain the domain name from the server URL for ease of human</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment">     * inspection of the data directory.</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment">     *</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment">     * @return string $filename</span>
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment">     */</span>
<a name="l150"><span class="linenum"> 150</span></a>      function <a class="function" onClick="logFunction('getAssociationFilename')" href="../../../../_functions/getassociationfilename.html" onMouseOver="funcPopup(event,'getassociationfilename')">getAssociationFilename</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>)
<a name="l151"><span class="linenum"> 151</span></a>      {
<a name="l152"><span class="linenum"> 152</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('active')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/active.html">active</a>) {
<a name="l153"><span class="linenum"> 153</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;FileStore no longer active&quot;, E_USER_ERROR);
<a name="l154"><span class="linenum"> 154</span></a>              return null;
<a name="l155"><span class="linenum"> 155</span></a>          }
<a name="l156"><span class="linenum"> 156</span></a>  
<a name="l157"><span class="linenum"> 157</span></a>          if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, '://') === false) {
<a name="l158"><span class="linenum"> 158</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(sprintf(&quot;Bad server URL: %s&quot;, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>),
<a name="l159"><span class="linenum"> 159</span></a>                            E_USER_WARNING);
<a name="l160"><span class="linenum"> 160</span></a>              return null;
<a name="l161"><span class="linenum"> 161</span></a>          }
<a name="l162"><span class="linenum"> 162</span></a>  
<a name="l163"><span class="linenum"> 163</span></a>          list(<a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('proto')" href="../../../../_variables/proto.html">$proto</a>, <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../../../_variables/rest.html">$rest</a>) = <a class="phpfunction" onClick="logFunction('explode')" href="../../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('://', <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, 2);
<a name="l164"><span class="linenum"> 164</span></a>          <a class="var it37" onMouseOver="hilite(37)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../../../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('/', <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../../../_variables/rest.html">$rest</a>);
<a name="l165"><span class="linenum"> 165</span></a>          <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('domain')" href="../../../../_variables/domain.html">$domain</a> = <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_filenameEscape')" href="../../../../_functions/_filenameescape.html" onMouseOver="funcPopup(event,'_filenameescape')">_filenameEscape</a>(<a class="var it37" onMouseOver="hilite(37)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../../../_variables/parts.html">$parts</a>[0]);
<a name="l166"><span class="linenum"> 166</span></a>          <a class="var it186" onMouseOver="hilite(186)" onMouseOut="lolite()" onClick="logVariable('url_hash')" href="../../../../_variables/url_hash.html">$url_hash</a> = <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_safe64')" href="../../../../_functions/_safe64.html" onMouseOver="funcPopup(event,'_safe64')">_safe64</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>);
<a name="l167"><span class="linenum"> 167</span></a>          if (<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>) {
<a name="l168"><span class="linenum"> 168</span></a>              <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('handle_hash')" href="../../../../_variables/handle_hash.html">$handle_hash</a> = <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_safe64')" href="../../../../_functions/_safe64.html" onMouseOver="funcPopup(event,'_safe64')">_safe64</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>);
<a name="l169"><span class="linenum"> 169</span></a>          } else {
<a name="l170"><span class="linenum"> 170</span></a>              <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('handle_hash')" href="../../../../_variables/handle_hash.html">$handle_hash</a> = '';
<a name="l171"><span class="linenum"> 171</span></a>          }
<a name="l172"><span class="linenum"> 172</span></a>  
<a name="l173"><span class="linenum"> 173</span></a>          <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> = sprintf('%s-%s-%s-%s', <a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('proto')" href="../../../../_variables/proto.html">$proto</a>, <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('domain')" href="../../../../_variables/domain.html">$domain</a>, <a class="var it186" onMouseOver="hilite(186)" onMouseOut="lolite()" onClick="logVariable('url_hash')" href="../../../../_variables/url_hash.html">$url_hash</a>,
<a name="l174"><span class="linenum"> 174</span></a>                              <a class="var it187" onMouseOver="hilite(187)" onMouseOut="lolite()" onClick="logVariable('handle_hash')" href="../../../../_variables/handle_hash.html">$handle_hash</a>);
<a name="l175"><span class="linenum"> 175</span></a>  
<a name="l176"><span class="linenum"> 176</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('association_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/association_dir.html">association_dir</a>. <a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a> . <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>;
<a name="l177"><span class="linenum"> 177</span></a>      }
<a name="l178"><span class="linenum"> 178</span></a>  
<a name="l179"><span class="linenum"> 179</span></a>      <span class="comment">/**</span>
<a name="l180"><span class="linenum"> 180</span></a>  <span class="comment">     * Store an association in the association directory.</span>
<a name="l181"><span class="linenum"> 181</span></a>  <span class="comment">     */</span>
<a name="l182"><span class="linenum"> 182</span></a>      function <a class="function" onClick="logFunction('storeAssociation')" href="../../../../_functions/storeassociation.html" onMouseOver="funcPopup(event,'storeassociation')">storeAssociation</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>)
<a name="l183"><span class="linenum"> 183</span></a>      {
<a name="l184"><span class="linenum"> 184</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('active')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/active.html">active</a>) {
<a name="l185"><span class="linenum"> 185</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;FileStore no longer active&quot;, E_USER_ERROR);
<a name="l186"><span class="linenum"> 186</span></a>              return false;
<a name="l187"><span class="linenum"> 187</span></a>          }
<a name="l188"><span class="linenum"> 188</span></a>  
<a name="l189"><span class="linenum"> 189</span></a>          <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('association_s')" href="../../../../_variables/association_s.html">$association_s</a> = <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>-&gt;<a class="phpfunction" onClick="logFunction('serialize')" href="../../../../_functions/serialize.html" onMouseOver="phpfuncPopup(event,'serialize')">serialize</a>();
<a name="l190"><span class="linenum"> 190</span></a>          <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getAssociationFilename')" href="../../../../_functions/getassociationfilename.html" onMouseOver="funcPopup(event,'getassociationfilename')">getAssociationFilename</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>,
<a name="l191"><span class="linenum"> 191</span></a>                                                    <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>-&gt;<a onClick="logVariable('handle')" class="var it2319" onMouseOver="hilite(2319)" onMouseOut="lolite()" href="../../../../_variables/handle.html">handle</a>);
<a name="l192"><span class="linenum"> 192</span></a>          list(<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('tmp_file')" href="../../../../_variables/tmp_file.html">$tmp_file</a>, <a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('tmp')" href="../../../../_variables/tmp.html">$tmp</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_mktemp')" href="../../../../_functions/_mktemp.html" onMouseOver="funcPopup(event,'_mktemp')">_mktemp</a>();
<a name="l193"><span class="linenum"> 193</span></a>  
<a name="l194"><span class="linenum"> 194</span></a>          if (!<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('tmp_file')" href="../../../../_variables/tmp_file.html">$tmp_file</a>) {
<a name="l195"><span class="linenum"> 195</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;_mktemp didn't return a valid file descriptor&quot;,
<a name="l196"><span class="linenum"> 196</span></a>                            E_USER_WARNING);
<a name="l197"><span class="linenum"> 197</span></a>              return false;
<a name="l198"><span class="linenum"> 198</span></a>          }
<a name="l199"><span class="linenum"> 199</span></a>  
<a name="l200"><span class="linenum"> 200</span></a>          <a class="phpfunction" onClick="logFunction('fwrite')" href="../../../../_functions/fwrite.html" onMouseOver="phpfuncPopup(event,'fwrite')">fwrite</a>(<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('tmp_file')" href="../../../../_variables/tmp_file.html">$tmp_file</a>, <a class="var it190" onMouseOver="hilite(190)" onMouseOut="lolite()" onClick="logVariable('association_s')" href="../../../../_variables/association_s.html">$association_s</a>);
<a name="l201"><span class="linenum"> 201</span></a>  
<a name="l202"><span class="linenum"> 202</span></a>          <a class="phpfunction" onClick="logFunction('fflush')" href="../../../../_functions/fflush.html" onMouseOver="phpfuncPopup(event,'fflush')">fflush</a>(<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('tmp_file')" href="../../../../_variables/tmp_file.html">$tmp_file</a>);
<a name="l203"><span class="linenum"> 203</span></a>  
<a name="l204"><span class="linenum"> 204</span></a>          <a class="phpfunction" onClick="logFunction('fclose')" href="../../../../_functions/fclose.html" onMouseOver="phpfuncPopup(event,'fclose')">fclose</a>(<a class="var it191" onMouseOver="hilite(191)" onMouseOut="lolite()" onClick="logVariable('tmp_file')" href="../../../../_variables/tmp_file.html">$tmp_file</a>);
<a name="l205"><span class="linenum"> 205</span></a>  
<a name="l206"><span class="linenum"> 206</span></a>          if (@<a class="phpfunction" onClick="logFunction('rename')" href="../../../../_functions/rename.html" onMouseOver="phpfuncPopup(event,'rename')">rename</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('tmp')" href="../../../../_variables/tmp.html">$tmp</a>, <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>)) {
<a name="l207"><span class="linenum"> 207</span></a>              return true;
<a name="l208"><span class="linenum"> 208</span></a>          } else {
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment">            // In case we are running on Windows, try unlinking the</span>
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment">            // file in case it exists.</span>
<a name="l211"><span class="linenum"> 211</span></a>              @<a class="phpfunction" onClick="logFunction('unlink')" href="../../../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>);
<a name="l212"><span class="linenum"> 212</span></a>  
<a name="l213"><span class="linenum"> 213</span></a>  <span class="comment">            // Now the target should not exist. Try renaming again,</span>
<a name="l214"><span class="linenum"> 214</span></a>  <span class="comment">            // giving up if it fails.</span>
<a name="l215"><span class="linenum"> 215</span></a>              if (@<a class="phpfunction" onClick="logFunction('rename')" href="../../../../_functions/rename.html" onMouseOver="phpfuncPopup(event,'rename')">rename</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('tmp')" href="../../../../_variables/tmp.html">$tmp</a>, <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>)) {
<a name="l216"><span class="linenum"> 216</span></a>                  return true;
<a name="l217"><span class="linenum"> 217</span></a>              }
<a name="l218"><span class="linenum"> 218</span></a>          }
<a name="l219"><span class="linenum"> 219</span></a>  
<a name="l220"><span class="linenum"> 220</span></a>  <span class="comment">        // If there was an error, don't leave the temporary file</span>
<a name="l221"><span class="linenum"> 221</span></a>  <span class="comment">        // around.</span>
<a name="l222"><span class="linenum"> 222</span></a>          <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it192" onMouseOver="hilite(192)" onMouseOut="lolite()" onClick="logVariable('tmp')" href="../../../../_variables/tmp.html">$tmp</a>);
<a name="l223"><span class="linenum"> 223</span></a>          return false;
<a name="l224"><span class="linenum"> 224</span></a>      }
<a name="l225"><span class="linenum"> 225</span></a>  
<a name="l226"><span class="linenum"> 226</span></a>      <span class="comment">/**</span>
<a name="l227"><span class="linenum"> 227</span></a>  <span class="comment">     * Retrieve an association. If no handle is specified, return the</span>
<a name="l228"><span class="linenum"> 228</span></a>  <span class="comment">     * association with the most recent issue time.</span>
<a name="l229"><span class="linenum"> 229</span></a>  <span class="comment">     *</span>
<a name="l230"><span class="linenum"> 230</span></a>  <span class="comment">     * @return mixed $association</span>
<a name="l231"><span class="linenum"> 231</span></a>  <span class="comment">     */</span>
<a name="l232"><span class="linenum"> 232</span></a>      function <a class="function" onClick="logFunction('getAssociation')" href="../../../../_functions/getassociation.html" onMouseOver="funcPopup(event,'getassociation')">getAssociation</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a> = null)
<a name="l233"><span class="linenum"> 233</span></a>      {
<a name="l234"><span class="linenum"> 234</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('active')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/active.html">active</a>) {
<a name="l235"><span class="linenum"> 235</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;FileStore no longer active&quot;, E_USER_ERROR);
<a name="l236"><span class="linenum"> 236</span></a>              return null;
<a name="l237"><span class="linenum"> 237</span></a>          }
<a name="l238"><span class="linenum"> 238</span></a>  
<a name="l239"><span class="linenum"> 239</span></a>          if (<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a> === null) {
<a name="l240"><span class="linenum"> 240</span></a>              <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a> = '';
<a name="l241"><span class="linenum"> 241</span></a>          }
<a name="l242"><span class="linenum"> 242</span></a>  
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">        // The filename with the empty handle is a prefix of all other</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">        // associations for the given server URL.</span>
<a name="l245"><span class="linenum"> 245</span></a>          <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getAssociationFilename')" href="../../../../_functions/getassociationfilename.html" onMouseOver="funcPopup(event,'getassociationfilename')">getAssociationFilename</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>);
<a name="l246"><span class="linenum"> 246</span></a>  
<a name="l247"><span class="linenum"> 247</span></a>          if (<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>) {
<a name="l248"><span class="linenum"> 248</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_getAssociation')" href="../../../../_functions/_getassociation.html" onMouseOver="funcPopup(event,'_getassociation')">_getAssociation</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>);
<a name="l249"><span class="linenum"> 249</span></a>          } else {
<a name="l250"><span class="linenum"> 250</span></a>              <a class="var it193" onMouseOver="hilite(193)" onMouseOut="lolite()" onClick="logVariable('association_files')" href="../../../../_variables/association_files.html">$association_files</a> =
<a name="l251"><span class="linenum"> 251</span></a>                  <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_listdir')" href="../../../../_functions/_listdir.html" onMouseOver="funcPopup(event,'_listdir')">_listdir</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('association_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/association_dir.html">association_dir</a>);
<a name="l252"><span class="linenum"> 252</span></a>              <a class="var it194" onMouseOver="hilite(194)" onMouseOut="lolite()" onClick="logVariable('matching_files')" href="../../../../_variables/matching_files.html">$matching_files</a> = array();
<a name="l253"><span class="linenum"> 253</span></a>  
<a name="l254"><span class="linenum"> 254</span></a>  <span class="comment">            // strip off the path to do the comparison</span>
<a name="l255"><span class="linenum"> 255</span></a>              <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a> = <a class="phpfunction" onClick="logFunction('basename')" href="../../../../_functions/basename.html" onMouseOver="phpfuncPopup(event,'basename')">basename</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>);
<a name="l256"><span class="linenum"> 256</span></a>              foreach (<a class="var it193" onMouseOver="hilite(193)" onMouseOut="lolite()" onClick="logVariable('association_files')" href="../../../../_variables/association_files.html">$association_files</a> as <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('association_file')" href="../../../../_variables/association_file.html">$association_file</a>) {
<a name="l257"><span class="linenum"> 257</span></a>                  <a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('base')" href="../../../../_variables/base.html">$base</a> = <a class="phpfunction" onClick="logFunction('basename')" href="../../../../_functions/basename.html" onMouseOver="phpfuncPopup(event,'basename')">basename</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('association_file')" href="../../../../_variables/association_file.html">$association_file</a>);
<a name="l258"><span class="linenum"> 258</span></a>                  if (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it156" onMouseOver="hilite(156)" onMouseOut="lolite()" onClick="logVariable('base')" href="../../../../_variables/base.html">$base</a>, <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a>) === 0) {
<a name="l259"><span class="linenum"> 259</span></a>                      <a class="var it194" onMouseOver="hilite(194)" onMouseOut="lolite()" onClick="logVariable('matching_files')" href="../../../../_variables/matching_files.html">$matching_files</a>[] = <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('association_file')" href="../../../../_variables/association_file.html">$association_file</a>;
<a name="l260"><span class="linenum"> 260</span></a>                  }
<a name="l261"><span class="linenum"> 261</span></a>              }
<a name="l262"><span class="linenum"> 262</span></a>  
<a name="l263"><span class="linenum"> 263</span></a>              <a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('matching_associations')" href="../../../../_variables/matching_associations.html">$matching_associations</a> = array();
<a name="l264"><span class="linenum"> 264</span></a>  <span class="comment">            // read the matching files and sort by time issued</span>
<a name="l265"><span class="linenum"> 265</span></a>              foreach (<a class="var it194" onMouseOver="hilite(194)" onMouseOut="lolite()" onClick="logVariable('matching_files')" href="../../../../_variables/matching_files.html">$matching_files</a> as <a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('full_name')" href="../../../../_variables/full_name.html">$full_name</a>) {
<a name="l266"><span class="linenum"> 266</span></a>                  <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_getAssociation')" href="../../../../_functions/_getassociation.html" onMouseOver="funcPopup(event,'_getassociation')">_getAssociation</a>(<a class="var it197" onMouseOver="hilite(197)" onMouseOut="lolite()" onClick="logVariable('full_name')" href="../../../../_variables/full_name.html">$full_name</a>);
<a name="l267"><span class="linenum"> 267</span></a>                  if (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a> !== null) {
<a name="l268"><span class="linenum"> 268</span></a>                      <a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('matching_associations')" href="../../../../_variables/matching_associations.html">$matching_associations</a>[] = array(<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>-&gt;<a onClick="logVariable('issued')" class="var it2319" onMouseOver="hilite(2319)" onMouseOut="lolite()" href="../../../../_variables/issued.html">issued</a>,
<a name="l269"><span class="linenum"> 269</span></a>                                                       <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>);
<a name="l270"><span class="linenum"> 270</span></a>                  }
<a name="l271"><span class="linenum"> 271</span></a>              }
<a name="l272"><span class="linenum"> 272</span></a>  
<a name="l273"><span class="linenum"> 273</span></a>              <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('issued')" href="../../../../_variables/issued.html">$issued</a> = array();
<a name="l274"><span class="linenum"> 274</span></a>              <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('assocs')" href="../../../../_variables/assocs.html">$assocs</a> = array();
<a name="l275"><span class="linenum"> 275</span></a>              foreach (<a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('matching_associations')" href="../../../../_variables/matching_associations.html">$matching_associations</a> as <a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a> =&gt; <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>) {
<a name="l276"><span class="linenum"> 276</span></a>                  <a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('issued')" href="../../../../_variables/issued.html">$issued</a>[<a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] = <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>[0];
<a name="l277"><span class="linenum"> 277</span></a>                  <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('assocs')" href="../../../../_variables/assocs.html">$assocs</a>[<a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>] = <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>[1];
<a name="l278"><span class="linenum"> 278</span></a>              }
<a name="l279"><span class="linenum"> 279</span></a>  
<a name="l280"><span class="linenum"> 280</span></a>              <a class="phpfunction" onClick="logFunction('array_multisort')" href="../../../../_functions/array_multisort.html" onMouseOver="phpfuncPopup(event,'array_multisort')">array_multisort</a>(<a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('issued')" href="../../../../_variables/issued.html">$issued</a>, SORT_DESC, <a class="var it199" onMouseOver="hilite(199)" onMouseOut="lolite()" onClick="logVariable('assocs')" href="../../../../_variables/assocs.html">$assocs</a>, SORT_DESC,
<a name="l281"><span class="linenum"> 281</span></a>                              <a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('matching_associations')" href="../../../../_variables/matching_associations.html">$matching_associations</a>);
<a name="l282"><span class="linenum"> 282</span></a>  
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">            // return the most recently issued one.</span>
<a name="l284"><span class="linenum"> 284</span></a>              if (<a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('matching_associations')" href="../../../../_variables/matching_associations.html">$matching_associations</a>) {
<a name="l285"><span class="linenum"> 285</span></a>                  list(<a class="var it198" onMouseOver="hilite(198)" onMouseOut="lolite()" onClick="logVariable('issued')" href="../../../../_variables/issued.html">$issued</a>, <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>) = <a class="var it196" onMouseOver="hilite(196)" onMouseOut="lolite()" onClick="logVariable('matching_associations')" href="../../../../_variables/matching_associations.html">$matching_associations</a>[0];
<a name="l286"><span class="linenum"> 286</span></a>                  return <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>;
<a name="l287"><span class="linenum"> 287</span></a>              } else {
<a name="l288"><span class="linenum"> 288</span></a>                  return null;
<a name="l289"><span class="linenum"> 289</span></a>              }
<a name="l290"><span class="linenum"> 290</span></a>          }
<a name="l291"><span class="linenum"> 291</span></a>      }
<a name="l292"><span class="linenum"> 292</span></a>  
<a name="l293"><span class="linenum"> 293</span></a>      <span class="comment">/**</span>
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment">     * @access private</span>
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment">     */</span>
<a name="l296"><span class="linenum"> 296</span></a>      function <a class="function" onClick="logFunction('_getAssociation')" href="../../../../_functions/_getassociation.html" onMouseOver="funcPopup(event,'_getassociation')">_getAssociation</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>)
<a name="l297"><span class="linenum"> 297</span></a>      {
<a name="l298"><span class="linenum"> 298</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('active')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/active.html">active</a>) {
<a name="l299"><span class="linenum"> 299</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;FileStore no longer active&quot;, E_USER_ERROR);
<a name="l300"><span class="linenum"> 300</span></a>              return null;
<a name="l301"><span class="linenum"> 301</span></a>          }
<a name="l302"><span class="linenum"> 302</span></a>  
<a name="l303"><span class="linenum"> 303</span></a>          <a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('assoc_file')" href="../../../../_variables/assoc_file.html">$assoc_file</a> = @fopen(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>, 'rb');
<a name="l304"><span class="linenum"> 304</span></a>  
<a name="l305"><span class="linenum"> 305</span></a>          if (<a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('assoc_file')" href="../../../../_variables/assoc_file.html">$assoc_file</a> === false) {
<a name="l306"><span class="linenum"> 306</span></a>              return null;
<a name="l307"><span class="linenum"> 307</span></a>          }
<a name="l308"><span class="linenum"> 308</span></a>  
<a name="l309"><span class="linenum"> 309</span></a>          <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('assoc_s')" href="../../../../_variables/assoc_s.html">$assoc_s</a> = <a class="phpfunction" onClick="logFunction('fread')" href="../../../../_functions/fread.html" onMouseOver="phpfuncPopup(event,'fread')">fread</a>(<a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('assoc_file')" href="../../../../_variables/assoc_file.html">$assoc_file</a>, <a class="phpfunction" onClick="logFunction('filesize')" href="../../../../_functions/filesize.html" onMouseOver="phpfuncPopup(event,'filesize')">filesize</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>));
<a name="l310"><span class="linenum"> 310</span></a>          <a class="phpfunction" onClick="logFunction('fclose')" href="../../../../_functions/fclose.html" onMouseOver="phpfuncPopup(event,'fclose')">fclose</a>(<a class="var it201" onMouseOver="hilite(201)" onMouseOut="lolite()" onClick="logVariable('assoc_file')" href="../../../../_variables/assoc_file.html">$assoc_file</a>);
<a name="l311"><span class="linenum"> 311</span></a>  
<a name="l312"><span class="linenum"> 312</span></a>          if (!<a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('assoc_s')" href="../../../../_variables/assoc_s.html">$assoc_s</a>) {
<a name="l313"><span class="linenum"> 313</span></a>              return null;
<a name="l314"><span class="linenum"> 314</span></a>          }
<a name="l315"><span class="linenum"> 315</span></a>  
<a name="l316"><span class="linenum"> 316</span></a>          <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a> =
<a name="l317"><span class="linenum"> 317</span></a>              <a class="class" onClick="logClass('Auth_OpenID_Association')" href="../../../../_classes/auth_openid_association.html" onMouseOver="classPopup(event,'auth_openid_association')">Auth_OpenID_Association</a>::<a class="function" onClick="logFunction('deserialize')" href="../../../../_functions/deserialize.html" onMouseOver="funcPopup(event,'deserialize')">deserialize</a>('Auth_OpenID_Association',
<a name="l318"><span class="linenum"> 318</span></a>                                                  <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('assoc_s')" href="../../../../_variables/assoc_s.html">$assoc_s</a>);
<a name="l319"><span class="linenum"> 319</span></a>  
<a name="l320"><span class="linenum"> 320</span></a>          if (!<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>) {
<a name="l321"><span class="linenum"> 321</span></a>              <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>);
<a name="l322"><span class="linenum"> 322</span></a>              return null;
<a name="l323"><span class="linenum"> 323</span></a>          }
<a name="l324"><span class="linenum"> 324</span></a>  
<a name="l325"><span class="linenum"> 325</span></a>          if (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>-&gt;<a class="function" onClick="logFunction('getExpiresIn')" href="../../../../_functions/getexpiresin.html" onMouseOver="funcPopup(event,'getexpiresin')">getExpiresIn</a>() == 0) {
<a name="l326"><span class="linenum"> 326</span></a>              <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>);
<a name="l327"><span class="linenum"> 327</span></a>              return null;
<a name="l328"><span class="linenum"> 328</span></a>          } else {
<a name="l329"><span class="linenum"> 329</span></a>              return <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>;
<a name="l330"><span class="linenum"> 330</span></a>          }
<a name="l331"><span class="linenum"> 331</span></a>      }
<a name="l332"><span class="linenum"> 332</span></a>  
<a name="l333"><span class="linenum"> 333</span></a>      <span class="comment">/**</span>
<a name="l334"><span class="linenum"> 334</span></a>  <span class="comment">     * Remove an association if it exists. Do nothing if it does not.</span>
<a name="l335"><span class="linenum"> 335</span></a>  <span class="comment">     *</span>
<a name="l336"><span class="linenum"> 336</span></a>  <span class="comment">     * @return bool $success</span>
<a name="l337"><span class="linenum"> 337</span></a>  <span class="comment">     */</span>
<a name="l338"><span class="linenum"> 338</span></a>      function <a class="function" onClick="logFunction('removeAssociation')" href="../../../../_functions/removeassociation.html" onMouseOver="funcPopup(event,'removeassociation')">removeAssociation</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>)
<a name="l339"><span class="linenum"> 339</span></a>      {
<a name="l340"><span class="linenum"> 340</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('active')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/active.html">active</a>) {
<a name="l341"><span class="linenum"> 341</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;FileStore no longer active&quot;, E_USER_ERROR);
<a name="l342"><span class="linenum"> 342</span></a>              return null;
<a name="l343"><span class="linenum"> 343</span></a>          }
<a name="l344"><span class="linenum"> 344</span></a>  
<a name="l345"><span class="linenum"> 345</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getAssociation')" href="../../../../_functions/getassociation.html" onMouseOver="funcPopup(event,'getassociation')">getAssociation</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>);
<a name="l346"><span class="linenum"> 346</span></a>          if (<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> === null) {
<a name="l347"><span class="linenum"> 347</span></a>              return false;
<a name="l348"><span class="linenum"> 348</span></a>          } else {
<a name="l349"><span class="linenum"> 349</span></a>              <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getAssociationFilename')" href="../../../../_functions/getassociationfilename.html" onMouseOver="funcPopup(event,'getassociationfilename')">getAssociationFilename</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>);
<a name="l350"><span class="linenum"> 350</span></a>              return <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>);
<a name="l351"><span class="linenum"> 351</span></a>          }
<a name="l352"><span class="linenum"> 352</span></a>      }
<a name="l353"><span class="linenum"> 353</span></a>  
<a name="l354"><span class="linenum"> 354</span></a>      <span class="comment">/**</span>
<a name="l355"><span class="linenum"> 355</span></a>  <span class="comment">     * Return whether this nonce is present. As a side effect, mark it</span>
<a name="l356"><span class="linenum"> 356</span></a>  <span class="comment">     * as no longer present.</span>
<a name="l357"><span class="linenum"> 357</span></a>  <span class="comment">     *</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">     * @return bool $present</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment">     */</span>
<a name="l360"><span class="linenum"> 360</span></a>      function <a class="function" onClick="logFunction('useNonce')" href="../../../../_functions/usenonce.html" onMouseOver="funcPopup(event,'usenonce')">useNonce</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../../../_variables/timestamp.html">$timestamp</a>, <a class="var it203" onMouseOver="hilite(203)" onMouseOut="lolite()" onClick="logVariable('salt')" href="../../../../_variables/salt.html">$salt</a>)
<a name="l361"><span class="linenum"> 361</span></a>      {
<a name="l362"><span class="linenum"> 362</span></a>          global <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('Auth_OpenID_SKEW')" href="../../../../_variables/Auth_OpenID_SKEW.html">$Auth_OpenID_SKEW</a>;
<a name="l363"><span class="linenum"> 363</span></a>  
<a name="l364"><span class="linenum"> 364</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('active')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/active.html">active</a>) {
<a name="l365"><span class="linenum"> 365</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;FileStore no longer active&quot;, E_USER_ERROR);
<a name="l366"><span class="linenum"> 366</span></a>              return null;
<a name="l367"><span class="linenum"> 367</span></a>          }
<a name="l368"><span class="linenum"> 368</span></a>  
<a name="l369"><span class="linenum"> 369</span></a>          if ( <a class="phpfunction" onClick="logFunction('abs')" href="../../../../_functions/abs.html" onMouseOver="phpfuncPopup(event,'abs')">abs</a>(<a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../../../_variables/timestamp.html">$timestamp</a> - <a class="phpfunction" onClick="logFunction('time')" href="../../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()) &gt; <a class="var it175" onMouseOver="hilite(175)" onMouseOut="lolite()" onClick="logVariable('Auth_OpenID_SKEW')" href="../../../../_variables/Auth_OpenID_SKEW.html">$Auth_OpenID_SKEW</a> ) {
<a name="l370"><span class="linenum"> 370</span></a>              return False;
<a name="l371"><span class="linenum"> 371</span></a>          }
<a name="l372"><span class="linenum"> 372</span></a>  
<a name="l373"><span class="linenum"> 373</span></a>          if (<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>) {
<a name="l374"><span class="linenum"> 374</span></a>              list(<a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('proto')" href="../../../../_variables/proto.html">$proto</a>, <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../../../_variables/rest.html">$rest</a>) = <a class="phpfunction" onClick="logFunction('explode')" href="../../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('://', <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, 2);
<a name="l375"><span class="linenum"> 375</span></a>          } else {
<a name="l376"><span class="linenum"> 376</span></a>              <a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('proto')" href="../../../../_variables/proto.html">$proto</a> = '';
<a name="l377"><span class="linenum"> 377</span></a>              <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../../../_variables/rest.html">$rest</a> = '';
<a name="l378"><span class="linenum"> 378</span></a>          }
<a name="l379"><span class="linenum"> 379</span></a>  
<a name="l380"><span class="linenum"> 380</span></a>          <a class="var it37" onMouseOver="hilite(37)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../../../_variables/parts.html">$parts</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>('/', <a class="var it184" onMouseOver="hilite(184)" onMouseOut="lolite()" onClick="logVariable('rest')" href="../../../../_variables/rest.html">$rest</a>, 2);
<a name="l381"><span class="linenum"> 381</span></a>          <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('domain')" href="../../../../_variables/domain.html">$domain</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_filenameEscape')" href="../../../../_functions/_filenameescape.html" onMouseOver="funcPopup(event,'_filenameescape')">_filenameEscape</a>(<a class="var it37" onMouseOver="hilite(37)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../../../_variables/parts.html">$parts</a>[0]);
<a name="l382"><span class="linenum"> 382</span></a>          <a class="var it186" onMouseOver="hilite(186)" onMouseOut="lolite()" onClick="logVariable('url_hash')" href="../../../../_variables/url_hash.html">$url_hash</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_safe64')" href="../../../../_functions/_safe64.html" onMouseOver="funcPopup(event,'_safe64')">_safe64</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>);
<a name="l383"><span class="linenum"> 383</span></a>          <a class="var it204" onMouseOver="hilite(204)" onMouseOut="lolite()" onClick="logVariable('salt_hash')" href="../../../../_variables/salt_hash.html">$salt_hash</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_safe64')" href="../../../../_functions/_safe64.html" onMouseOver="funcPopup(event,'_safe64')">_safe64</a>(<a class="var it203" onMouseOver="hilite(203)" onMouseOut="lolite()" onClick="logVariable('salt')" href="../../../../_variables/salt.html">$salt</a>);
<a name="l384"><span class="linenum"> 384</span></a>  
<a name="l385"><span class="linenum"> 385</span></a>          <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> = sprintf('%08x-%s-%s-%s-%s', <a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../../../_variables/timestamp.html">$timestamp</a>, <a class="var it183" onMouseOver="hilite(183)" onMouseOut="lolite()" onClick="logVariable('proto')" href="../../../../_variables/proto.html">$proto</a>,
<a name="l386"><span class="linenum"> 386</span></a>                              <a class="var it185" onMouseOver="hilite(185)" onMouseOut="lolite()" onClick="logVariable('domain')" href="../../../../_variables/domain.html">$domain</a>, <a class="var it186" onMouseOver="hilite(186)" onMouseOut="lolite()" onClick="logVariable('url_hash')" href="../../../../_variables/url_hash.html">$url_hash</a>, <a class="var it204" onMouseOver="hilite(204)" onMouseOut="lolite()" onClick="logVariable('salt_hash')" href="../../../../_variables/salt_hash.html">$salt_hash</a>);
<a name="l387"><span class="linenum"> 387</span></a>          <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nonce_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/nonce_dir.html">nonce_dir</a> . <a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a> . <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>;
<a name="l388"><span class="linenum"> 388</span></a>  
<a name="l389"><span class="linenum"> 389</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = @fopen(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>, 'x');
<a name="l390"><span class="linenum"> 390</span></a>  
<a name="l391"><span class="linenum"> 391</span></a>          if (<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> === false) {
<a name="l392"><span class="linenum"> 392</span></a>              return false;
<a name="l393"><span class="linenum"> 393</span></a>          } else {
<a name="l394"><span class="linenum"> 394</span></a>              <a class="phpfunction" onClick="logFunction('fclose')" href="../../../../_functions/fclose.html" onMouseOver="phpfuncPopup(event,'fclose')">fclose</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>);
<a name="l395"><span class="linenum"> 395</span></a>              return true;
<a name="l396"><span class="linenum"> 396</span></a>          }
<a name="l397"><span class="linenum"> 397</span></a>      }
<a name="l398"><span class="linenum"> 398</span></a>  
<a name="l399"><span class="linenum"> 399</span></a>      <span class="comment">/**</span>
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment">     * Remove expired entries from the database. This is potentially</span>
<a name="l401"><span class="linenum"> 401</span></a>  <span class="comment">     * expensive, so only run when it is acceptable to take time.</span>
<a name="l402"><span class="linenum"> 402</span></a>  <span class="comment">     *</span>
<a name="l403"><span class="linenum"> 403</span></a>  <span class="comment">     * @access private</span>
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">     */</span>
<a name="l405"><span class="linenum"> 405</span></a>      function <a class="function" onClick="logFunction('_allAssocs')" href="../../../../_functions/_allassocs.html" onMouseOver="funcPopup(event,'_allassocs')">_allAssocs</a>()
<a name="l406"><span class="linenum"> 406</span></a>      {
<a name="l407"><span class="linenum"> 407</span></a>          <a class="var it205" onMouseOver="hilite(205)" onMouseOut="lolite()" onClick="logVariable('all_associations')" href="../../../../_variables/all_associations.html">$all_associations</a> = array();
<a name="l408"><span class="linenum"> 408</span></a>  
<a name="l409"><span class="linenum"> 409</span></a>          <a class="var it206" onMouseOver="hilite(206)" onMouseOut="lolite()" onClick="logVariable('association_filenames')" href="../../../../_variables/association_filenames.html">$association_filenames</a> =
<a name="l410"><span class="linenum"> 410</span></a>              <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_listdir')" href="../../../../_functions/_listdir.html" onMouseOver="funcPopup(event,'_listdir')">_listdir</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('association_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/association_dir.html">association_dir</a>);
<a name="l411"><span class="linenum"> 411</span></a>  
<a name="l412"><span class="linenum"> 412</span></a>          foreach (<a class="var it206" onMouseOver="hilite(206)" onMouseOut="lolite()" onClick="logVariable('association_filenames')" href="../../../../_variables/association_filenames.html">$association_filenames</a> as <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('association_filename')" href="../../../../_variables/association_filename.html">$association_filename</a>) {
<a name="l413"><span class="linenum"> 413</span></a>              <a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('association_file')" href="../../../../_variables/association_file.html">$association_file</a> = fopen(<a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('association_filename')" href="../../../../_variables/association_filename.html">$association_filename</a>, 'rb');
<a name="l414"><span class="linenum"> 414</span></a>  
<a name="l415"><span class="linenum"> 415</span></a>              if (<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('association_file')" href="../../../../_variables/association_file.html">$association_file</a> !== false) {
<a name="l416"><span class="linenum"> 416</span></a>                  <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('assoc_s')" href="../../../../_variables/assoc_s.html">$assoc_s</a> = <a class="phpfunction" onClick="logFunction('fread')" href="../../../../_functions/fread.html" onMouseOver="phpfuncPopup(event,'fread')">fread</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('association_file')" href="../../../../_variables/association_file.html">$association_file</a>,
<a name="l417"><span class="linenum"> 417</span></a>                                   <a class="phpfunction" onClick="logFunction('filesize')" href="../../../../_functions/filesize.html" onMouseOver="phpfuncPopup(event,'filesize')">filesize</a>(<a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('association_filename')" href="../../../../_variables/association_filename.html">$association_filename</a>));
<a name="l418"><span class="linenum"> 418</span></a>                  <a class="phpfunction" onClick="logFunction('fclose')" href="../../../../_functions/fclose.html" onMouseOver="phpfuncPopup(event,'fclose')">fclose</a>(<a class="var it195" onMouseOver="hilite(195)" onMouseOut="lolite()" onClick="logVariable('association_file')" href="../../../../_variables/association_file.html">$association_file</a>);
<a name="l419"><span class="linenum"> 419</span></a>  
<a name="l420"><span class="linenum"> 420</span></a>  <span class="comment">                // Remove expired or corrupted associations</span>
<a name="l421"><span class="linenum"> 421</span></a>                  <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a> =
<a name="l422"><span class="linenum"> 422</span></a>                    <a class="class" onClick="logClass('Auth_OpenID_Association')" href="../../../../_classes/auth_openid_association.html" onMouseOver="classPopup(event,'auth_openid_association')">Auth_OpenID_Association</a>::<a class="function" onClick="logFunction('deserialize')" href="../../../../_functions/deserialize.html" onMouseOver="funcPopup(event,'deserialize')">deserialize</a>(
<a name="l423"><span class="linenum"> 423</span></a>                           'Auth_OpenID_Association', <a class="var it202" onMouseOver="hilite(202)" onMouseOut="lolite()" onClick="logVariable('assoc_s')" href="../../../../_variables/assoc_s.html">$assoc_s</a>);
<a name="l424"><span class="linenum"> 424</span></a>  
<a name="l425"><span class="linenum"> 425</span></a>                  if (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a> === null) {
<a name="l426"><span class="linenum"> 426</span></a>                      <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(
<a name="l427"><span class="linenum"> 427</span></a>                                                   <a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('association_filename')" href="../../../../_variables/association_filename.html">$association_filename</a>);
<a name="l428"><span class="linenum"> 428</span></a>                  } else {
<a name="l429"><span class="linenum"> 429</span></a>                      if (<a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>-&gt;<a class="function" onClick="logFunction('getExpiresIn')" href="../../../../_functions/getexpiresin.html" onMouseOver="funcPopup(event,'getexpiresin')">getExpiresIn</a>() == 0) {
<a name="l430"><span class="linenum"> 430</span></a>                          <a class="var it205" onMouseOver="hilite(205)" onMouseOut="lolite()" onClick="logVariable('all_associations')" href="../../../../_variables/all_associations.html">$all_associations</a>[] = array(<a class="var it207" onMouseOver="hilite(207)" onMouseOut="lolite()" onClick="logVariable('association_filename')" href="../../../../_variables/association_filename.html">$association_filename</a>,
<a name="l431"><span class="linenum"> 431</span></a>                                                      <a class="var it189" onMouseOver="hilite(189)" onMouseOut="lolite()" onClick="logVariable('association')" href="../../../../_variables/association.html">$association</a>);
<a name="l432"><span class="linenum"> 432</span></a>                      }
<a name="l433"><span class="linenum"> 433</span></a>                  }
<a name="l434"><span class="linenum"> 434</span></a>              }
<a name="l435"><span class="linenum"> 435</span></a>          }
<a name="l436"><span class="linenum"> 436</span></a>  
<a name="l437"><span class="linenum"> 437</span></a>          return <a class="var it205" onMouseOver="hilite(205)" onMouseOut="lolite()" onClick="logVariable('all_associations')" href="../../../../_variables/all_associations.html">$all_associations</a>;
<a name="l438"><span class="linenum"> 438</span></a>      }
<a name="l439"><span class="linenum"> 439</span></a>  
<a name="l440"><span class="linenum"> 440</span></a>      function <a class="function" onClick="logFunction('clean')" href="../../../../_functions/clean.html" onMouseOver="funcPopup(event,'clean')">clean</a>()
<a name="l441"><span class="linenum"> 441</span></a>      {
<a name="l442"><span class="linenum"> 442</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('active')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/active.html">active</a>) {
<a name="l443"><span class="linenum"> 443</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;FileStore no longer active&quot;, E_USER_ERROR);
<a name="l444"><span class="linenum"> 444</span></a>              return null;
<a name="l445"><span class="linenum"> 445</span></a>          }
<a name="l446"><span class="linenum"> 446</span></a>  
<a name="l447"><span class="linenum"> 447</span></a>          <a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('nonces')" href="../../../../_variables/nonces.html">$nonces</a> = <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_listdir')" href="../../../../_functions/_listdir.html" onMouseOver="funcPopup(event,'_listdir')">_listdir</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nonce_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/nonce_dir.html">nonce_dir</a>);
<a name="l448"><span class="linenum"> 448</span></a>          <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../../../_variables/now.html">$now</a> = <a class="phpfunction" onClick="logFunction('time')" href="../../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>();
<a name="l449"><span class="linenum"> 449</span></a>  
<a name="l450"><span class="linenum"> 450</span></a>  <span class="comment">        // Check all nonces for expiry</span>
<a name="l451"><span class="linenum"> 451</span></a>          foreach (<a class="var it176" onMouseOver="hilite(176)" onMouseOut="lolite()" onClick="logVariable('nonces')" href="../../../../_variables/nonces.html">$nonces</a> as <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../../../../_variables/nonce.html">$nonce</a>) {
<a name="l452"><span class="linenum"> 452</span></a>              if (!<a class="function" onClick="logFunction('Auth_OpenID_checkTimestamp')" href="../../../../_functions/auth_openid_checktimestamp.html" onMouseOver="funcPopup(event,'auth_openid_checktimestamp')">Auth_OpenID_checkTimestamp</a>(<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../../../../_variables/nonce.html">$nonce</a>, <a class="var it177" onMouseOver="hilite(177)" onMouseOut="lolite()" onClick="logVariable('now')" href="../../../../_variables/now.html">$now</a>)) {
<a name="l453"><span class="linenum"> 453</span></a>                  <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('nonce_dir')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/nonce_dir.html">nonce_dir</a> . <a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a> . <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../../../../_variables/nonce.html">$nonce</a>;
<a name="l454"><span class="linenum"> 454</span></a>                  <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>);
<a name="l455"><span class="linenum"> 455</span></a>              }
<a name="l456"><span class="linenum"> 456</span></a>          }
<a name="l457"><span class="linenum"> 457</span></a>  
<a name="l458"><span class="linenum"> 458</span></a>          foreach (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_allAssocs')" href="../../../../_functions/_allassocs.html" onMouseOver="funcPopup(event,'_allassocs')">_allAssocs</a>() as <a class="var it209" onMouseOver="hilite(209)" onMouseOut="lolite()" onClick="logVariable('pair')" href="../../../../_variables/pair.html">$pair</a>) {
<a name="l459"><span class="linenum"> 459</span></a>              list(<a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('assoc_filename')" href="../../../../_variables/assoc_filename.html">$assoc_filename</a>, <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>) = <a class="var it209" onMouseOver="hilite(209)" onMouseOut="lolite()" onClick="logVariable('pair')" href="../../../../_variables/pair.html">$pair</a>;
<a name="l460"><span class="linenum"> 460</span></a>              if (<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>-&gt;<a class="function" onClick="logFunction('getExpiresIn')" href="../../../../_functions/getexpiresin.html" onMouseOver="funcPopup(event,'getexpiresin')">getExpiresIn</a>() == 0) {
<a name="l461"><span class="linenum"> 461</span></a>                  <a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('assoc_filename')" href="../../../../_variables/assoc_filename.html">$assoc_filename</a>);
<a name="l462"><span class="linenum"> 462</span></a>              }
<a name="l463"><span class="linenum"> 463</span></a>          }
<a name="l464"><span class="linenum"> 464</span></a>      }
<a name="l465"><span class="linenum"> 465</span></a>  
<a name="l466"><span class="linenum"> 466</span></a>      <span class="comment">/**</span>
<a name="l467"><span class="linenum"> 467</span></a>  <span class="comment">     * @access private</span>
<a name="l468"><span class="linenum"> 468</span></a>  <span class="comment">     */</span>
<a name="l469"><span class="linenum"> 469</span></a>      function <a class="function" onClick="logFunction('_rmtree')" href="../../../../_functions/_rmtree.html" onMouseOver="funcPopup(event,'_rmtree')">_rmtree</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>)
<a name="l470"><span class="linenum"> 470</span></a>      {
<a name="l471"><span class="linenum"> 471</span></a>          if (<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>[strlen(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>) - 1] != <a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a>) {
<a name="l472"><span class="linenum"> 472</span></a>              <a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a> .= <a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a>;
<a name="l473"><span class="linenum"> 473</span></a>          }
<a name="l474"><span class="linenum"> 474</span></a>  
<a name="l475"><span class="linenum"> 475</span></a>          if (<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a> = <a class="phpfunction" onClick="logFunction('opendir')" href="../../../../_functions/opendir.html" onMouseOver="phpfuncPopup(event,'opendir')">opendir</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>)) {
<a name="l476"><span class="linenum"> 476</span></a>              while (<a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../../_variables/item.html">$item</a> = readdir(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>)) {
<a name="l477"><span class="linenum"> 477</span></a>                  if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../../_variables/item.html">$item</a>, array('.', '..'))) {
<a name="l478"><span class="linenum"> 478</span></a>                      if (<a class="phpfunction" onClick="logFunction('is_dir')" href="../../../../_functions/is_dir.html" onMouseOver="phpfuncPopup(event,'is_dir')">is_dir</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a> . <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../../_variables/item.html">$item</a>)) {
<a name="l479"><span class="linenum"> 479</span></a>  
<a name="l480"><span class="linenum"> 480</span></a>                          if (!<a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_rmtree')" href="../../../../_functions/_rmtree.html" onMouseOver="funcPopup(event,'_rmtree')">_rmtree</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a> . <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../../_variables/item.html">$item</a>)) {
<a name="l481"><span class="linenum"> 481</span></a>                              return false;
<a name="l482"><span class="linenum"> 482</span></a>                          }
<a name="l483"><span class="linenum"> 483</span></a>                      } else if (<a class="phpfunction" onClick="logFunction('is_file')" href="../../../../_functions/is_file.html" onMouseOver="phpfuncPopup(event,'is_file')">is_file</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a> . <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../../_variables/item.html">$item</a>)) {
<a name="l484"><span class="linenum"> 484</span></a>                          if (!<a class="phpfunction" onClick="logFunction('unlink')" href="../../../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a> . <a class="var it211" onMouseOver="hilite(211)" onMouseOut="lolite()" onClick="logVariable('item')" href="../../../../_variables/item.html">$item</a>)) {
<a name="l485"><span class="linenum"> 485</span></a>                              return false;
<a name="l486"><span class="linenum"> 486</span></a>                          }
<a name="l487"><span class="linenum"> 487</span></a>                      }
<a name="l488"><span class="linenum"> 488</span></a>                  }
<a name="l489"><span class="linenum"> 489</span></a>              }
<a name="l490"><span class="linenum"> 490</span></a>  
<a name="l491"><span class="linenum"> 491</span></a>              <a class="phpfunction" onClick="logFunction('closedir')" href="../../../../_functions/closedir.html" onMouseOver="phpfuncPopup(event,'closedir')">closedir</a>(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>);
<a name="l492"><span class="linenum"> 492</span></a>  
<a name="l493"><span class="linenum"> 493</span></a>              if (!@<a class="phpfunction" onClick="logFunction('rmdir')" href="../../../../_functions/rmdir.html" onMouseOver="phpfuncPopup(event,'rmdir')">rmdir</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>)) {
<a name="l494"><span class="linenum"> 494</span></a>                  return false;
<a name="l495"><span class="linenum"> 495</span></a>              }
<a name="l496"><span class="linenum"> 496</span></a>  
<a name="l497"><span class="linenum"> 497</span></a>              return true;
<a name="l498"><span class="linenum"> 498</span></a>          } else {
<a name="l499"><span class="linenum"> 499</span></a>  <span class="comment">            // Couldn't open directory.</span>
<a name="l500"><span class="linenum"> 500</span></a>              return false;
<a name="l501"><span class="linenum"> 501</span></a>          }
<a name="l502"><span class="linenum"> 502</span></a>      }
<a name="l503"><span class="linenum"> 503</span></a>  
<a name="l504"><span class="linenum"> 504</span></a>      <span class="comment">/**</span>
<a name="l505"><span class="linenum"> 505</span></a>  <span class="comment">     * @access private</span>
<a name="l506"><span class="linenum"> 506</span></a>  <span class="comment">     */</span>
<a name="l507"><span class="linenum"> 507</span></a>      function <a class="function" onClick="logFunction('_mkstemp')" href="../../../../_functions/_mkstemp.html" onMouseOver="funcPopup(event,'_mkstemp')">_mkstemp</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>)
<a name="l508"><span class="linenum"> 508</span></a>      {
<a name="l509"><span class="linenum"> 509</span></a>          foreach (<a class="phpfunction" onClick="logFunction('range')" href="../../../../_functions/range.html" onMouseOver="phpfuncPopup(event,'range')">range</a>(0, 4) as <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../../_variables/i.html">$i</a>) {
<a name="l510"><span class="linenum"> 510</span></a>              <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a> = <a class="phpfunction" onClick="logFunction('tempnam')" href="../../../../_functions/tempnam.html" onMouseOver="phpfuncPopup(event,'tempnam')">tempnam</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>, &quot;php_openid_filestore_&quot;);
<a name="l511"><span class="linenum"> 511</span></a>  
<a name="l512"><span class="linenum"> 512</span></a>              if (<a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a> !== false) {
<a name="l513"><span class="linenum"> 513</span></a>                  return <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a>;
<a name="l514"><span class="linenum"> 514</span></a>              }
<a name="l515"><span class="linenum"> 515</span></a>          }
<a name="l516"><span class="linenum"> 516</span></a>          return false;
<a name="l517"><span class="linenum"> 517</span></a>      }
<a name="l518"><span class="linenum"> 518</span></a>  
<a name="l519"><span class="linenum"> 519</span></a>      <span class="comment">/**</span>
<a name="l520"><span class="linenum"> 520</span></a>  <span class="comment">     * @access private</span>
<a name="l521"><span class="linenum"> 521</span></a>  <span class="comment">     */</span>
<a name="l522"><span class="linenum"> 522</span></a>      function <a class="function" onClick="logFunction('_mkdtemp')" href="../../../../_functions/_mkdtemp.html" onMouseOver="funcPopup(event,'_mkdtemp')">_mkdtemp</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>)
<a name="l523"><span class="linenum"> 523</span></a>      {
<a name="l524"><span class="linenum"> 524</span></a>          foreach (<a class="phpfunction" onClick="logFunction('range')" href="../../../../_functions/range.html" onMouseOver="phpfuncPopup(event,'range')">range</a>(0, 4) as <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../../_variables/i.html">$i</a>) {
<a name="l525"><span class="linenum"> 525</span></a>              <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a> = <a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a> . <a class="phpfunction" onClick="logFunction('strval')" href="../../../../_functions/strval.html" onMouseOver="phpfuncPopup(event,'strval')">strval</a>(<a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a>) . <a class="phpfunction" onClick="logFunction('strval')" href="../../../../_functions/strval.html" onMouseOver="phpfuncPopup(event,'strval')">strval</a>(<a class="phpfunction" onClick="logFunction('getmypid')" href="../../../../_functions/getmypid.html" onMouseOver="phpfuncPopup(event,'getmypid')">getmypid</a>()) .
<a name="l526"><span class="linenum"> 526</span></a>                  &quot;-&quot; . <a class="phpfunction" onClick="logFunction('strval')" href="../../../../_functions/strval.html" onMouseOver="phpfuncPopup(event,'strval')">strval</a>(<a class="phpfunction" onClick="logFunction('rand')" href="../../../../_functions/rand.html" onMouseOver="phpfuncPopup(event,'rand')">rand</a>(1, <a class="phpfunction" onClick="logFunction('time')" href="../../../../_functions/time.html" onMouseOver="phpfuncPopup(event,'time')">time</a>()));
<a name="l527"><span class="linenum"> 527</span></a>              if (!<a class="phpfunction" onClick="logFunction('mkdir')" href="../../../../_functions/mkdir.html" onMouseOver="phpfuncPopup(event,'mkdir')">mkdir</a>(<a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a>, 0700)) {
<a name="l528"><span class="linenum"> 528</span></a>                  return false;
<a name="l529"><span class="linenum"> 529</span></a>              } else {
<a name="l530"><span class="linenum"> 530</span></a>                  return <a class="var it34" onMouseOver="hilite(34)" onMouseOut="lolite()" onClick="logVariable('name')" href="../../../../_variables/name.html">$name</a>;
<a name="l531"><span class="linenum"> 531</span></a>              }
<a name="l532"><span class="linenum"> 532</span></a>          }
<a name="l533"><span class="linenum"> 533</span></a>          return false;
<a name="l534"><span class="linenum"> 534</span></a>      }
<a name="l535"><span class="linenum"> 535</span></a>  
<a name="l536"><span class="linenum"> 536</span></a>      <span class="comment">/**</span>
<a name="l537"><span class="linenum"> 537</span></a>  <span class="comment">     * @access private</span>
<a name="l538"><span class="linenum"> 538</span></a>  <span class="comment">     */</span>
<a name="l539"><span class="linenum"> 539</span></a>      function <a class="function" onClick="logFunction('_listdir')" href="../../../../_functions/_listdir.html" onMouseOver="funcPopup(event,'_listdir')">_listdir</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>)
<a name="l540"><span class="linenum"> 540</span></a>      {
<a name="l541"><span class="linenum"> 541</span></a>          <a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a> = <a class="phpfunction" onClick="logFunction('opendir')" href="../../../../_functions/opendir.html" onMouseOver="phpfuncPopup(event,'opendir')">opendir</a>(<a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a>);
<a name="l542"><span class="linenum"> 542</span></a>          <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../../../_variables/files.html">$files</a> = array();
<a name="l543"><span class="linenum"> 543</span></a>          while (false !== (<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> = readdir(<a class="var it182" onMouseOver="hilite(182)" onMouseOut="lolite()" onClick="logVariable('handle')" href="../../../../_variables/handle.html">$handle</a>))) {
<a name="l544"><span class="linenum"> 544</span></a>              if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>, array('.', '..'))) {
<a name="l545"><span class="linenum"> 545</span></a>                  <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../../../_variables/files.html">$files</a>[] = <a class="var it173" onMouseOver="hilite(173)" onMouseOut="lolite()" onClick="logVariable('dir')" href="../../../../_variables/dir.html">$dir</a> . <a class="constant" onClick="logConstant('DIRECTORY_SEPARATOR')" href="../../../../_constants/DIRECTORY_SEPARATOR.html" onMouseOver="constPopup(event,'DIRECTORY_SEPARATOR')">DIRECTORY_SEPARATOR</a> . <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>;
<a name="l546"><span class="linenum"> 546</span></a>              }
<a name="l547"><span class="linenum"> 547</span></a>          }
<a name="l548"><span class="linenum"> 548</span></a>          return <a class="var it212" onMouseOver="hilite(212)" onMouseOut="lolite()" onClick="logVariable('files')" href="../../../../_variables/files.html">$files</a>;
<a name="l549"><span class="linenum"> 549</span></a>      }
<a name="l550"><span class="linenum"> 550</span></a>  
<a name="l551"><span class="linenum"> 551</span></a>      <span class="comment">/**</span>
<a name="l552"><span class="linenum"> 552</span></a>  <span class="comment">     * @access private</span>
<a name="l553"><span class="linenum"> 553</span></a>  <span class="comment">     */</span>
<a name="l554"><span class="linenum"> 554</span></a>      function <a class="function" onClick="logFunction('_isFilenameSafe')" href="../../../../_functions/_isfilenamesafe.html" onMouseOver="funcPopup(event,'_isfilenamesafe')">_isFilenameSafe</a>(<a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../../../_variables/char.html">$char</a>)
<a name="l555"><span class="linenum"> 555</span></a>      {
<a name="l556"><span class="linenum"> 556</span></a>          <a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('_Auth_OpenID_filename_allowed')" href="../../../../_variables/_Auth_OpenID_filename_allowed.html">$_Auth_OpenID_filename_allowed</a> = Auth_OpenID_letters .
<a name="l557"><span class="linenum"> 557</span></a>              Auth_OpenID_digits . &quot;.&quot;;
<a name="l558"><span class="linenum"> 558</span></a>          return (<a class="phpfunction" onClick="logFunction('strpos')" href="../../../../_functions/strpos.html" onMouseOver="phpfuncPopup(event,'strpos')">strpos</a>(<a class="var it213" onMouseOver="hilite(213)" onMouseOut="lolite()" onClick="logVariable('_Auth_OpenID_filename_allowed')" href="../../../../_variables/_Auth_OpenID_filename_allowed.html">$_Auth_OpenID_filename_allowed</a>, <a class="var it158" onMouseOver="hilite(158)" onMouseOut="lolite()" onClick="logVariable('char')" href="../../../../_variables/char.html">$char</a>) !== false);
<a name="l559"><span class="linenum"> 559</span></a>      }
<a name="l560"><span class="linenum"> 560</span></a>  
<a name="l561"><span class="linenum"> 561</span></a>      <span class="comment">/**</span>
<a name="l562"><span class="linenum"> 562</span></a>  <span class="comment">     * @access private</span>
<a name="l563"><span class="linenum"> 563</span></a>  <span class="comment">     */</span>
<a name="l564"><span class="linenum"> 564</span></a>      function <a class="function" onClick="logFunction('_safe64')" href="../../../../_functions/_safe64.html" onMouseOver="funcPopup(event,'_safe64')">_safe64</a>(<a class="var it214" onMouseOver="hilite(214)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../../../_variables/str.html">$str</a>)
<a name="l565"><span class="linenum"> 565</span></a>      {
<a name="l566"><span class="linenum"> 566</span></a>          <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('h64')" href="../../../../_variables/h64.html">$h64</a> = <a class="phpfunction" onClick="logFunction('base64_encode')" href="../../../../_functions/base64_encode.html" onMouseOver="phpfuncPopup(event,'base64_encode')">base64_encode</a>(<a class="function" onClick="logFunction('Auth_OpenID_SHA1')" href="../../../../_functions/auth_openid_sha1.html" onMouseOver="funcPopup(event,'auth_openid_sha1')">Auth_OpenID_SHA1</a>(<a class="var it214" onMouseOver="hilite(214)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../../../_variables/str.html">$str</a>));
<a name="l567"><span class="linenum"> 567</span></a>          <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('h64')" href="../../../../_variables/h64.html">$h64</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('+', '_', <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('h64')" href="../../../../_variables/h64.html">$h64</a>);
<a name="l568"><span class="linenum"> 568</span></a>          <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('h64')" href="../../../../_variables/h64.html">$h64</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('/', '.', <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('h64')" href="../../../../_variables/h64.html">$h64</a>);
<a name="l569"><span class="linenum"> 569</span></a>          <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('h64')" href="../../../../_variables/h64.html">$h64</a> = <a class="phpfunction" onClick="logFunction('str_replace')" href="../../../../_functions/str_replace.html" onMouseOver="phpfuncPopup(event,'str_replace')">str_replace</a>('=', '', <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('h64')" href="../../../../_variables/h64.html">$h64</a>);
<a name="l570"><span class="linenum"> 570</span></a>          return <a class="var it215" onMouseOver="hilite(215)" onMouseOut="lolite()" onClick="logVariable('h64')" href="../../../../_variables/h64.html">$h64</a>;
<a name="l571"><span class="linenum"> 571</span></a>      }
<a name="l572"><span class="linenum"> 572</span></a>  
<a name="l573"><span class="linenum"> 573</span></a>      <span class="comment">/**</span>
<a name="l574"><span class="linenum"> 574</span></a>  <span class="comment">     * @access private</span>
<a name="l575"><span class="linenum"> 575</span></a>  <span class="comment">     */</span>
<a name="l576"><span class="linenum"> 576</span></a>      function <a class="function" onClick="logFunction('_filenameEscape')" href="../../../../_functions/_filenameescape.html" onMouseOver="funcPopup(event,'_filenameescape')">_filenameEscape</a>(<a class="var it214" onMouseOver="hilite(214)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../../../_variables/str.html">$str</a>)
<a name="l577"><span class="linenum"> 577</span></a>      {
<a name="l578"><span class="linenum"> 578</span></a>          <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> = &quot;&quot;;
<a name="l579"><span class="linenum"> 579</span></a>          <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('b')" href="../../../../_variables/b.html">$b</a> = <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('toBytes')" href="../../../../_functions/tobytes.html" onMouseOver="funcPopup(event,'tobytes')">toBytes</a>(<a class="var it214" onMouseOver="hilite(214)" onMouseOut="lolite()" onClick="logVariable('str')" href="../../../../_variables/str.html">$str</a>);
<a name="l580"><span class="linenum"> 580</span></a>  
<a name="l581"><span class="linenum"> 581</span></a>          for (<a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../../_variables/i.html">$i</a> = 0; <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../../_variables/i.html">$i</a> &lt; <a class="phpfunction" onClick="logFunction('count')" href="../../../../_functions/count.html" onMouseOver="phpfuncPopup(event,'count')">count</a>(<a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('b')" href="../../../../_variables/b.html">$b</a>); <a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../../_variables/i.html">$i</a>++) {
<a name="l582"><span class="linenum"> 582</span></a>              <a class="var it217" onMouseOver="hilite(217)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../../../_variables/c.html">$c</a> = <a class="var it216" onMouseOver="hilite(216)" onMouseOut="lolite()" onClick="logVariable('b')" href="../../../../_variables/b.html">$b</a>[<a class="var it166" onMouseOver="hilite(166)" onMouseOut="lolite()" onClick="logVariable('i')" href="../../../../_variables/i.html">$i</a>];
<a name="l583"><span class="linenum"> 583</span></a>              if (<a class="class" onClick="logClass('Auth_OpenID_FileStore')" href="../../../../_classes/auth_openid_filestore.html" onMouseOver="classPopup(event,'auth_openid_filestore')">Auth_OpenID_FileStore</a>::<a class="function" onClick="logFunction('_isFilenameSafe')" href="../../../../_functions/_isfilenamesafe.html" onMouseOver="funcPopup(event,'_isfilenamesafe')">_isFilenameSafe</a>(<a class="var it217" onMouseOver="hilite(217)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../../../_variables/c.html">$c</a>)) {
<a name="l584"><span class="linenum"> 584</span></a>                  <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> .= <a class="var it217" onMouseOver="hilite(217)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../../../_variables/c.html">$c</a>;
<a name="l585"><span class="linenum"> 585</span></a>              } else {
<a name="l586"><span class="linenum"> 586</span></a>                  <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a> .= sprintf(&quot;_%02X&quot;, <a class="phpfunction" onClick="logFunction('ord')" href="../../../../_functions/ord.html" onMouseOver="phpfuncPopup(event,'ord')">ord</a>(<a class="var it217" onMouseOver="hilite(217)" onMouseOut="lolite()" onClick="logVariable('c')" href="../../../../_variables/c.html">$c</a>));
<a name="l587"><span class="linenum"> 587</span></a>              }
<a name="l588"><span class="linenum"> 588</span></a>          }
<a name="l589"><span class="linenum"> 589</span></a>          return <a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>;
<a name="l590"><span class="linenum"> 590</span></a>      }
<a name="l591"><span class="linenum"> 591</span></a>  
<a name="l592"><span class="linenum"> 592</span></a>      <span class="comment">/**</span>
<a name="l593"><span class="linenum"> 593</span></a>  <span class="comment">     * Attempt to remove a file, returning whether the file existed at</span>
<a name="l594"><span class="linenum"> 594</span></a>  <span class="comment">     * the time of the call.</span>
<a name="l595"><span class="linenum"> 595</span></a>  <span class="comment">     *</span>
<a name="l596"><span class="linenum"> 596</span></a>  <span class="comment">     * @access private</span>
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">     * @return bool $result True if the file was present, false if not.</span>
<a name="l598"><span class="linenum"> 598</span></a>  <span class="comment">     */</span>
<a name="l599"><span class="linenum"> 599</span></a>      function <a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>)
<a name="l600"><span class="linenum"> 600</span></a>      {
<a name="l601"><span class="linenum"> 601</span></a>          return @<a class="phpfunction" onClick="logFunction('unlink')" href="../../../../_functions/unlink.html" onMouseOver="phpfuncPopup(event,'unlink')">unlink</a>(<a class="var it188" onMouseOver="hilite(188)" onMouseOut="lolite()" onClick="logVariable('filename')" href="../../../../_variables/filename.html">$filename</a>);
<a name="l602"><span class="linenum"> 602</span></a>      }
<a name="l603"><span class="linenum"> 603</span></a>  
<a name="l604"><span class="linenum"> 604</span></a>      function <a class="function" onClick="logFunction('cleanupAssociations')" href="../../../../_functions/cleanupassociations.html" onMouseOver="funcPopup(event,'cleanupassociations')">cleanupAssociations</a>()
<a name="l605"><span class="linenum"> 605</span></a>      {
<a name="l606"><span class="linenum"> 606</span></a>          <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('removed')" href="../../../../_variables/removed.html">$removed</a> = 0;
<a name="l607"><span class="linenum"> 607</span></a>          foreach (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_allAssocs')" href="../../../../_functions/_allassocs.html" onMouseOver="funcPopup(event,'_allassocs')">_allAssocs</a>() as <a class="var it209" onMouseOver="hilite(209)" onMouseOut="lolite()" onClick="logVariable('pair')" href="../../../../_variables/pair.html">$pair</a>) {
<a name="l608"><span class="linenum"> 608</span></a>              list(<a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('assoc_filename')" href="../../../../_variables/assoc_filename.html">$assoc_filename</a>, <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>) = <a class="var it209" onMouseOver="hilite(209)" onMouseOut="lolite()" onClick="logVariable('pair')" href="../../../../_variables/pair.html">$pair</a>;
<a name="l609"><span class="linenum"> 609</span></a>              if (<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>-&gt;<a class="function" onClick="logFunction('getExpiresIn')" href="../../../../_functions/getexpiresin.html" onMouseOver="funcPopup(event,'getexpiresin')">getExpiresIn</a>() == 0) {
<a name="l610"><span class="linenum"> 610</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_removeIfPresent')" href="../../../../_functions/_removeifpresent.html" onMouseOver="funcPopup(event,'_removeifpresent')">_removeIfPresent</a>(<a class="var it210" onMouseOver="hilite(210)" onMouseOut="lolite()" onClick="logVariable('assoc_filename')" href="../../../../_variables/assoc_filename.html">$assoc_filename</a>);
<a name="l611"><span class="linenum"> 611</span></a>                  <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('removed')" href="../../../../_variables/removed.html">$removed</a> += 1;
<a name="l612"><span class="linenum"> 612</span></a>              }
<a name="l613"><span class="linenum"> 613</span></a>          }
<a name="l614"><span class="linenum"> 614</span></a>          return <a class="var it178" onMouseOver="hilite(178)" onMouseOut="lolite()" onClick="logVariable('removed')" href="../../../../_variables/removed.html">$removed</a>;
<a name="l615"><span class="linenum"> 615</span></a>      }
<a name="l616"><span class="linenum"> 616</span></a>  }
<a name="l617"><span class="linenum"> 617</span></a>  
<a name="l618"><span class="linenum"> 618</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'getassociationfilename': ['getassociationfilename', 'Create a unique filename for a given server url and handle. This implementation does not assume anything about the format of the handle. The filename that is returned will contain the domain name from the server URL for ease of human inspection of the data directory. ', [['admin/oauth/Auth/OpenID','FileStore.php',141]], 3],
'getexpiresin': ['getexpiresin', 'This returns the number of seconds this association is still valid for, or 0 if the association is no longer valid. ', [['admin/oauth/Auth/OpenID','Association.php',147]], 11],
'auth_openid_filestore': ['auth_openid_filestore', 'Initializes a new {@link Auth_OpenID_FileStore}.  This initializes the nonce and association directories, which are subdirectories of the directory passed in. ', [['admin/oauth/Auth/OpenID','FileStore.php',41]], 0],
'usenonce': ['usenonce', 'Return whether this nonce is present. As a side effect, mark it as no longer present. ', [['admin/oauth/Auth/OpenID','FileStore.php',354],['admin/oauth/Auth/OpenID','MemcachedStore.php',161],['admin/oauth/Auth/OpenID','SQLStore.php',480],['admin/oauth/Auth/OpenID','DumbStore.php',81],['admin/oauth/Auth/OpenID','Interface.php',164]], 1],
'_getassociation': ['_getassociation', '', [['admin/oauth/Auth/OpenID','FileStore.php',296],['admin/oauth/Auth/OpenID','Consumer.php',1432]], 3],
'deserialize': ['deserialize', 'Parse an association as stored by serialize().  This is the inverse of serialize. ', [['admin/oauth/Auth/OpenID','Association.php',202]], 2],
'tobytes': ['tobytes', 'Get the bytes in a string independently of multibyte support conditions. ', [['admin/oauth/Auth','OpenID.php',469]], 1],
'_allassocs': ['_allassocs', 'Remove expired entries from the database. This is potentially expensive, so only run when it is acceptable to take time. ', [['admin/oauth/Auth/OpenID','FileStore.php',399]], 2],
'_isfilenamesafe': ['_isfilenamesafe', '', [['admin/oauth/Auth/OpenID','FileStore.php',554]], 1],
'_mkdtemp': ['_mkdtemp', '', [['admin/oauth/Auth/OpenID','FileStore.php',522]], 0],
'getassociation': ['getassociation', 'Retrieve an association. If no handle is specified, return the association with the most recent issue time. ', [['admin/oauth/Auth/OpenID','FileStore.php',226],['admin/oauth/Auth/OpenID','Server.php',1393],['admin/oauth/Auth/OpenID','MemcachedStore.php',87],['admin/oauth/Auth/OpenID','SQLStore.php',409],['admin/oauth/Auth/OpenID','DumbStore.php',65],['admin/oauth/Auth/OpenID','Interface.php',104]], 7],
'auth_openid_checktimestamp': ['auth_openid_checktimestamp', '', [['admin/oauth/Auth/OpenID','Nonce.php',59]], 1],
'_filenameescape': ['_filenameescape', '', [['admin/oauth/Auth/OpenID','FileStore.php',576]], 2],
'_rmtree': ['_rmtree', '', [['admin/oauth/Auth/OpenID','FileStore.php',469]], 2],
'_listdir': ['_listdir', '', [['admin/oauth/Auth/OpenID','FileStore.php',539]], 4],
'storeassociation': ['storeassociation', 'Store an association in the association directory. ', [['admin/oauth/Auth/OpenID','FileStore.php',179],['admin/oauth/Auth/OpenID','MemcachedStore.php',50],['admin/oauth/Auth/OpenID','SQLStore.php',346],['admin/oauth/Auth/OpenID','DumbStore.php',58],['admin/oauth/Auth/OpenID','Interface.php',31]], 2],
'_safe64': ['_safe64', '', [['admin/oauth/Auth/OpenID','FileStore.php',564]], 4],
'removeassociation': ['removeassociation', 'Remove an association if it exists. Do nothing if it does not. ', [['admin/oauth/Auth/OpenID','FileStore.php',333],['admin/oauth/Auth/OpenID','MemcachedStore.php',122],['admin/oauth/Auth/OpenID','SQLStore.php',392],['admin/oauth/Auth/OpenID','DumbStore.php',73],['admin/oauth/Auth/OpenID','Interface.php',140]], 4],
'ensuredir': ['ensuredir', 'Create dir_name as a directory if it does not exist. If it exists, make sure that it is, in fact, a directory.  Returns true if the operation succeeded; false if not. ', [['admin/oauth/Auth','OpenID.php',199]], 5],
'auth_openid_sha1': ['auth_openid_sha1', 'SHA1_BLOCKSIZE is this module\'s SHA1 blocksize used by the fallback implementation. ', [['admin/oauth/Auth/OpenID','HMAC.php',19]], 5],
'cleanupassociations': ['cleanupassociations', '', [['admin/oauth/Auth/OpenID','FileStore.php',604],['admin/oauth/Auth/OpenID','SQLStore.php',559],['admin/oauth/Auth/OpenID','Interface.php',77]], 1],
'cleanupnonces': ['cleanupnonces', '', [['admin/oauth/Auth/OpenID','FileStore.php',119],['admin/oauth/Auth/OpenID','SQLStore.php',548],['admin/oauth/Auth/OpenID','Interface.php',62]], 1],
'clean': ['clean', '', [['admin/oauth/Auth/OpenID','FileStore.php',440]], 0],
'_mkstemp': ['_mkstemp', '', [['admin/oauth/Auth/OpenID','FileStore.php',507]], 1],
'_removeifpresent': ['_removeifpresent', 'Attempt to remove a file, returning whether the file existed at the time of the call. ', [['admin/oauth/Auth/OpenID','FileStore.php',592]], 10],
'destroy': ['destroy', '', [['admin/oauth/Auth/OpenID','FileStore.php',77]], 0],
'_mktemp': ['_mktemp', 'Create a temporary file on the same filesystem as $this->association_dir. ', [['admin/oauth/Auth/OpenID','FileStore.php',96]], 1],
'_setup': ['_setup', 'Make sure that the directories in which we store our data exist. ', [['admin/oauth/Auth/OpenID','FileStore.php',83]], 1],
'fflush': ['fflush', '', [], 1],
'is_dir': ['is_dir', '', [], 5],
'explode': ['explode', '', [], 76],
'is_file': ['is_file', '', [], 10],
'array_multisort': ['array_multisort', '', [], 2],
'unlink': ['unlink', '', [], 9],
'rename': ['rename', '', [], 2],
'rmdir': ['rmdir', '', [], 1],
'closedir': ['closedir', '', [], 5],
'strpos': ['strpos', '', [], 73],
'fclose': ['fclose', '', [], 18],
'count': ['count', '', [], 141],
'trigger_error': ['trigger_error', '', [], 35],
'strval': ['strval', '', [], 12],
'in_array': ['in_array', '', [], 83],
'abs': ['abs', '', [], 8],
'filesize': ['filesize', '', [], 5],
'str_replace': ['str_replace', '', [], 21],
'fwrite': ['fwrite', '', [], 14],
'getmypid': ['getmypid', '', [], 1],
'tempnam': ['tempnam', '', [], 3],
'time': ['time', '', [], 34],
'range': ['range', '', [], 3],
'intval': ['intval', '', [], 24],
'serialize': ['serialize', '', [], 6],
'base64_encode': ['base64_encode', '', [], 11],
'rand': ['rand', '', [], 5],
'ord': ['ord', '', [], 19],
'realpath': ['realpath', '', [], 3],
'fread': ['fread', '', [], 12],
'basename': ['basename', '', [], 10],
'mkdir': ['mkdir', '', [], 11],
'opendir': ['opendir', '', [], 7]};
CLASS_DATA={
'auth_openid_association': ['auth_openid_association', 'This class represents an association between a server and a consumer.  In general, users of this library will never see instances of this object.  The only exception is if you implement a custom {@link Auth_OpenID_OpenIDStore}. ', [['admin/oauth/Auth/OpenID','Association.php',32]], 6],
'auth_openid_openidstore': ['auth_openid_openidstore', 'This is the interface for the store objects the OpenID library uses. It is a single class that provides all of the persistence mechanisms that the OpenID library needs, for both servers and consumers.  If you want to create an SQL-driven store, please see then {@link Auth_OpenID_SQLStore} class. ', [['admin/oauth/Auth/OpenID','Interface.php',16]], 10],
'auth_openid': ['auth_openid', 'The OpenID utility function class. ', [['admin/oauth/Auth','OpenID.php',109]], 116],
'auth_openid_filestore': ['auth_openid_filestore', 'This is a filesystem-based store for OpenID associations and nonces.  This store should be safe for use in concurrent systems on both windows and unix (excluding NFS filesystems).  There are a couple race conditions in the system, but those failure cases have been set up in such a way that the worst-case behavior is someone having to try to log in a second time. ', [['admin/oauth/Auth/OpenID','FileStore.php',25]], 20]};
CONST_DATA={
'DIRECTORY_SEPARATOR': ['DIRECTORY_SEPARATOR', '', [['fckeditor/editor/filemanager/connectors/php','phpcompat.php',14]], 17]};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Tue Dec  7 15:36:31 2010</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7</a></i></td>
	</tr>
</table>
</body></html>
