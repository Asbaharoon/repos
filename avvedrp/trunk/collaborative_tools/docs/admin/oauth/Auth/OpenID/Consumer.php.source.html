<!doctype html public "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
    <title>PHPXRef 0.7 : Virtual lab admin interface : /admin/oauth/Auth/OpenID/Consumer.php source</title>
    <link rel="stylesheet" href="../../../../sample.css" type="text/css">
    <link rel="stylesheet" href="../../../../sample-print.css" type="text/css" media="print">
    <style id="hilight" type="text/css"></style>
    <meta http-equiv="content-type" content="text/html;charset=iso-8859-1">
</head>
<body bgcolor="#ffffff" text="#000000" link="#801800" vlink="#300540" alink="#ffffff">
<table class="pagetitle" width="100%">
	<tr>
        <td valign="top" class="pagetitle">
            [ <a href="../../../../index.html">Index</a> ]
        </td>
        <td align="right" class="pagetitle">
		    <h2 style="margin-bottom: 0px">PHP Cross Reference of Virtual lab admin interface</h2>
	    </td>
    </tr>
</table>


<!-- Generated by PHPXref 0.7 at Tue Dec  7 15:36:31 2010 -->
<!-- PHPXref (c) 2000-2007 Gareth Watts - gareth@omnipotent.net -->
<!-- http://phpxref.sourceforge.net/ -->

<script src="../../../../phpxref.js" type="text/javascript"></script>
<script language="JavaScript" type="text/javascript">
<!--
ext='.html';
relbase='../../../../';
subdir='admin/oauth/Auth/OpenID';
filename='Consumer.php.source.html';
cookiekey='phpxref';
handleNavFrame(relbase, subdir, filename);

// -->
</script>
<script language="JavaScript" type="text/javascript">
if (gwGetCookie('xrefnav')=='off')
  document.write('<p class="navlinks">[ <a href="javascript:navOn()">Show Explorer<\/a> ]<\/p>');
else
  document.write('<p class="navlinks">[ <a href="javascript:navOff()">Hide Explorer<\/a> ]<\/p>');
</script>
<noscript>
<p class="navlinks">
[ <a href="../../../../nav.html" target="_top">Show Explorer</a> ]
[ <a href="index.html" target="_top">Hide Navbar</a> ]
</p>
</noscript>
<script language="JavaScript" type="text/javascript">
<!--

document.writeln('<table align="right" class="searchbox-link"><tr><td><a class="searchbox-link" href="javascript:void(0)" onMouseOver="showSearchBox()">Search</a><br>');
document.writeln('<table border="0" cellspacing="0" cellpadding="0" class="searchbox" id="searchbox">');
document.writeln('<tr><td class="searchbox-title">');
document.writeln('<a class="searchbox-title" href="javascript:showSearchPopup()">Search History +</a>');
document.writeln('<\/td><\/tr>');

document.writeln('<tr><td class="searchbox-body" id="searchbox-body">');
document.writeln('<form name="search" style="margin:0px; padding:0px" onSubmit=\'return jump()\'>');
document.writeln('<a class="searchbox-body" href="../../../../_classes/index.html">Class<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="classname"><br>');
document.writeln('<a id="funcsearchlink" class="searchbox-body" href="../../../../_functions/index.html">Function<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="funcname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_variables/index.html">Variable<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="varname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_constants/index.html">Constant<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="constname"><br>');
document.writeln('<a class="searchbox-body" href="../../../../_tables/index.html">Table<\/a>: ');
document.writeln('<input type="text" size=10 value="" name="tablename"><br>');
document.writeln('<input type="submit" class="searchbox-button" value="Search">');
document.writeln('<\/form>');
document.writeln('<\/td><\/tr><\/table>');
document.writeln('<\/td><\/tr><\/table>');
// -->
</script>
<div id="search-popup" class="searchpopup"><p id="searchpopup-title" class="searchpopup-title">title</p><div id="searchpopup-body" class="searchpopup-body">Body</div><p class="searchpopup-close"><a href="javascript:gwCloseActive()">[close]</a></p></div>
<h2 class="listing-heading"><a href="./index.html">/admin/oauth/Auth/OpenID/</a> -> <a href="Consumer.php.html">Consumer.php</a> (source)</h2>
<div class="listing">
<p class="viewlinks">[<a href="Consumer.php.html">Summary view</a>]
[<a href="javascript:window.print();">Print</a>]
[<a href="Consumer.php.source.txt" target="_new">Text view</a>]
</p>
<pre>
<a name="l1"><span class="linenum">   1</span></a>  &lt;?php
<a name="l2"><span class="linenum">   2</span></a>  
<a name="l3"><span class="linenum">   3</span></a>  <span class="comment">/**</span>
<a name="l4"><span class="linenum">   4</span></a>  <span class="comment"> * This module documents the main interface with the OpenID consumer</span>
<a name="l5"><span class="linenum">   5</span></a>  <span class="comment"> * library.  The only part of the library which has to be used and</span>
<a name="l6"><span class="linenum">   6</span></a>  <span class="comment"> * isn't documented in full here is the store required to create an</span>
<a name="l7"><span class="linenum">   7</span></a>  <span class="comment"> * Auth_OpenID_Consumer instance.  More on the abstract store type and</span>
<a name="l8"><span class="linenum">   8</span></a>  <span class="comment"> * concrete implementations of it that are provided in the</span>
<a name="l9"><span class="linenum">   9</span></a>  <span class="comment"> * documentation for the Auth_OpenID_Consumer constructor.</span>
<a name="l10"><span class="linenum">  10</span></a>  <span class="comment"> *</span>
<a name="l11"><span class="linenum">  11</span></a>  <span class="comment"> * OVERVIEW</span>
<a name="l12"><span class="linenum">  12</span></a>  <span class="comment"> *</span>
<a name="l13"><span class="linenum">  13</span></a>  <span class="comment"> * The OpenID identity verification process most commonly uses the</span>
<a name="l14"><span class="linenum">  14</span></a>  <span class="comment"> * following steps, as visible to the user of this library:</span>
<a name="l15"><span class="linenum">  15</span></a>  <span class="comment"> *</span>
<a name="l16"><span class="linenum">  16</span></a>  <span class="comment"> *   1. The user enters their OpenID into a field on the consumer's</span>
<a name="l17"><span class="linenum">  17</span></a>  <span class="comment"> *      site, and hits a login button.</span>
<a name="l18"><span class="linenum">  18</span></a>  <span class="comment"> *   2. The consumer site discovers the user's OpenID server using the</span>
<a name="l19"><span class="linenum">  19</span></a>  <span class="comment"> *      YADIS protocol.</span>
<a name="l20"><span class="linenum">  20</span></a>  <span class="comment"> *   3. The consumer site sends the browser a redirect to the identity</span>
<a name="l21"><span class="linenum">  21</span></a>  <span class="comment"> *      server.  This is the authentication request as described in</span>
<a name="l22"><span class="linenum">  22</span></a>  <span class="comment"> *      the OpenID specification.</span>
<a name="l23"><span class="linenum">  23</span></a>  <span class="comment"> *   4. The identity server's site sends the browser a redirect back</span>
<a name="l24"><span class="linenum">  24</span></a>  <span class="comment"> *      to the consumer site.  This redirect contains the server's</span>
<a name="l25"><span class="linenum">  25</span></a>  <span class="comment"> *      response to the authentication request.</span>
<a name="l26"><span class="linenum">  26</span></a>  <span class="comment"> *</span>
<a name="l27"><span class="linenum">  27</span></a>  <span class="comment"> * The most important part of the flow to note is the consumer's site</span>
<a name="l28"><span class="linenum">  28</span></a>  <span class="comment"> * must handle two separate HTTP requests in order to perform the full</span>
<a name="l29"><span class="linenum">  29</span></a>  <span class="comment"> * identity check.</span>
<a name="l30"><span class="linenum">  30</span></a>  <span class="comment"> *</span>
<a name="l31"><span class="linenum">  31</span></a>  <span class="comment"> * LIBRARY DESIGN</span>
<a name="l32"><span class="linenum">  32</span></a>  <span class="comment"> * </span>
<a name="l33"><span class="linenum">  33</span></a>  <span class="comment"> * This consumer library is designed with that flow in mind.  The goal</span>
<a name="l34"><span class="linenum">  34</span></a>  <span class="comment"> * is to make it as easy as possible to perform the above steps</span>
<a name="l35"><span class="linenum">  35</span></a>  <span class="comment"> * securely.</span>
<a name="l36"><span class="linenum">  36</span></a>  <span class="comment"> *</span>
<a name="l37"><span class="linenum">  37</span></a>  <span class="comment"> * At a high level, there are two important parts in the consumer</span>
<a name="l38"><span class="linenum">  38</span></a>  <span class="comment"> * library.  The first important part is this module, which contains</span>
<a name="l39"><span class="linenum">  39</span></a>  <span class="comment"> * the interface to actually use this library.  The second is the</span>
<a name="l40"><span class="linenum">  40</span></a>  <span class="comment"> * Auth_OpenID_Interface class, which describes the interface to use</span>
<a name="l41"><span class="linenum">  41</span></a>  <span class="comment"> * if you need to create a custom method for storing the state this</span>
<a name="l42"><span class="linenum">  42</span></a>  <span class="comment"> * library needs to maintain between requests.</span>
<a name="l43"><span class="linenum">  43</span></a>  <span class="comment"> *</span>
<a name="l44"><span class="linenum">  44</span></a>  <span class="comment"> * In general, the second part is less important for users of the</span>
<a name="l45"><span class="linenum">  45</span></a>  <span class="comment"> * library to know about, as several implementations are provided</span>
<a name="l46"><span class="linenum">  46</span></a>  <span class="comment"> * which cover a wide variety of situations in which consumers may use</span>
<a name="l47"><span class="linenum">  47</span></a>  <span class="comment"> * the library.</span>
<a name="l48"><span class="linenum">  48</span></a>  <span class="comment"> *</span>
<a name="l49"><span class="linenum">  49</span></a>  <span class="comment"> * This module contains a class, Auth_OpenID_Consumer, with methods</span>
<a name="l50"><span class="linenum">  50</span></a>  <span class="comment"> * corresponding to the actions necessary in each of steps 2, 3, and 4</span>
<a name="l51"><span class="linenum">  51</span></a>  <span class="comment"> * described in the overview.  Use of this library should be as easy</span>
<a name="l52"><span class="linenum">  52</span></a>  <span class="comment"> * as creating an Auth_OpenID_Consumer instance and calling the</span>
<a name="l53"><span class="linenum">  53</span></a>  <span class="comment"> * methods appropriate for the action the site wants to take.</span>
<a name="l54"><span class="linenum">  54</span></a>  <span class="comment"> *</span>
<a name="l55"><span class="linenum">  55</span></a>  <span class="comment"> * STORES AND DUMB MODE</span>
<a name="l56"><span class="linenum">  56</span></a>  <span class="comment"> *</span>
<a name="l57"><span class="linenum">  57</span></a>  <span class="comment"> * OpenID is a protocol that works best when the consumer site is able</span>
<a name="l58"><span class="linenum">  58</span></a>  <span class="comment"> * to store some state.  This is the normal mode of operation for the</span>
<a name="l59"><span class="linenum">  59</span></a>  <span class="comment"> * protocol, and is sometimes referred to as smart mode.  There is</span>
<a name="l60"><span class="linenum">  60</span></a>  <span class="comment"> * also a fallback mode, known as dumb mode, which is available when</span>
<a name="l61"><span class="linenum">  61</span></a>  <span class="comment"> * the consumer site is not able to store state.  This mode should be</span>
<a name="l62"><span class="linenum">  62</span></a>  <span class="comment"> * avoided when possible, as it leaves the implementation more</span>
<a name="l63"><span class="linenum">  63</span></a>  <span class="comment"> * vulnerable to replay attacks.</span>
<a name="l64"><span class="linenum">  64</span></a>  <span class="comment"> *</span>
<a name="l65"><span class="linenum">  65</span></a>  <span class="comment"> * The mode the library works in for normal operation is determined by</span>
<a name="l66"><span class="linenum">  66</span></a>  <span class="comment"> * the store that it is given.  The store is an abstraction that</span>
<a name="l67"><span class="linenum">  67</span></a>  <span class="comment"> * handles the data that the consumer needs to manage between http</span>
<a name="l68"><span class="linenum">  68</span></a>  <span class="comment"> * requests in order to operate efficiently and securely.</span>
<a name="l69"><span class="linenum">  69</span></a>  <span class="comment"> *</span>
<a name="l70"><span class="linenum">  70</span></a>  <span class="comment"> * Several store implementation are provided, and the interface is</span>
<a name="l71"><span class="linenum">  71</span></a>  <span class="comment"> * fully documented so that custom stores can be used as well.  See</span>
<a name="l72"><span class="linenum">  72</span></a>  <span class="comment"> * the documentation for the Auth_OpenID_Consumer class for more</span>
<a name="l73"><span class="linenum">  73</span></a>  <span class="comment"> * information on the interface for stores.  The implementations that</span>
<a name="l74"><span class="linenum">  74</span></a>  <span class="comment"> * are provided allow the consumer site to store the necessary data in</span>
<a name="l75"><span class="linenum">  75</span></a>  <span class="comment"> * several different ways, including several SQL databases and normal</span>
<a name="l76"><span class="linenum">  76</span></a>  <span class="comment"> * files on disk.</span>
<a name="l77"><span class="linenum">  77</span></a>  <span class="comment"> *</span>
<a name="l78"><span class="linenum">  78</span></a>  <span class="comment"> * There is an additional concrete store provided that puts the system</span>
<a name="l79"><span class="linenum">  79</span></a>  <span class="comment"> * in dumb mode.  This is not recommended, as it removes the library's</span>
<a name="l80"><span class="linenum">  80</span></a>  <span class="comment"> * ability to stop replay attacks reliably.  It still uses time-based</span>
<a name="l81"><span class="linenum">  81</span></a>  <span class="comment"> * checking to make replay attacks only possible within a small</span>
<a name="l82"><span class="linenum">  82</span></a>  <span class="comment"> * window, but they remain possible within that window.  This store</span>
<a name="l83"><span class="linenum">  83</span></a>  <span class="comment"> * should only be used if the consumer site has no way to retain data</span>
<a name="l84"><span class="linenum">  84</span></a>  <span class="comment"> * between requests at all.</span>
<a name="l85"><span class="linenum">  85</span></a>  <span class="comment"> *</span>
<a name="l86"><span class="linenum">  86</span></a>  <span class="comment"> * IMMEDIATE MODE</span>
<a name="l87"><span class="linenum">  87</span></a>  <span class="comment"> *</span>
<a name="l88"><span class="linenum">  88</span></a>  <span class="comment"> * In the flow described above, the user may need to confirm to the</span>
<a name="l89"><span class="linenum">  89</span></a>  <span class="comment"> * lidentity server that it's ok to authorize his or her identity.</span>
<a name="l90"><span class="linenum">  90</span></a>  <span class="comment"> * The server may draw pages asking for information from the user</span>
<a name="l91"><span class="linenum">  91</span></a>  <span class="comment"> * before it redirects the browser back to the consumer's site.  This</span>
<a name="l92"><span class="linenum">  92</span></a>  <span class="comment"> * is generally transparent to the consumer site, so it is typically</span>
<a name="l93"><span class="linenum">  93</span></a>  <span class="comment"> * ignored as an implementation detail.</span>
<a name="l94"><span class="linenum">  94</span></a>  <span class="comment"> *</span>
<a name="l95"><span class="linenum">  95</span></a>  <span class="comment"> * There can be times, however, where the consumer site wants to get a</span>
<a name="l96"><span class="linenum">  96</span></a>  <span class="comment"> * response immediately.  When this is the case, the consumer can put</span>
<a name="l97"><span class="linenum">  97</span></a>  <span class="comment"> * the library in immediate mode.  In immediate mode, there is an</span>
<a name="l98"><span class="linenum">  98</span></a>  <span class="comment"> * extra response possible from the server, which is essentially the</span>
<a name="l99"><span class="linenum">  99</span></a>  <span class="comment"> * server reporting that it doesn't have enough information to answer</span>
<a name="l100"><span class="linenum"> 100</span></a>  <span class="comment"> * the question yet.</span>
<a name="l101"><span class="linenum"> 101</span></a>  <span class="comment"> *</span>
<a name="l102"><span class="linenum"> 102</span></a>  <span class="comment"> * USING THIS LIBRARY</span>
<a name="l103"><span class="linenum"> 103</span></a>  <span class="comment"> *</span>
<a name="l104"><span class="linenum"> 104</span></a>  <span class="comment"> * Integrating this library into an application is usually a</span>
<a name="l105"><span class="linenum"> 105</span></a>  <span class="comment"> * relatively straightforward process.  The process should basically</span>
<a name="l106"><span class="linenum"> 106</span></a>  <span class="comment"> * follow this plan:</span>
<a name="l107"><span class="linenum"> 107</span></a>  <span class="comment"> *</span>
<a name="l108"><span class="linenum"> 108</span></a>  <span class="comment"> * Add an OpenID login field somewhere on your site.  When an OpenID</span>
<a name="l109"><span class="linenum"> 109</span></a>  <span class="comment"> * is entered in that field and the form is submitted, it should make</span>
<a name="l110"><span class="linenum"> 110</span></a>  <span class="comment"> * a request to the your site which includes that OpenID URL.</span>
<a name="l111"><span class="linenum"> 111</span></a>  <span class="comment"> *</span>
<a name="l112"><span class="linenum"> 112</span></a>  <span class="comment"> * First, the application should instantiate the Auth_OpenID_Consumer</span>
<a name="l113"><span class="linenum"> 113</span></a>  <span class="comment"> * class using the store of choice (Auth_OpenID_FileStore or one of</span>
<a name="l114"><span class="linenum"> 114</span></a>  <span class="comment"> * the SQL-based stores).  If the application has a custom</span>
<a name="l115"><span class="linenum"> 115</span></a>  <span class="comment"> * session-management implementation, an object implementing the</span>
<a name="l116"><span class="linenum"> 116</span></a>  <span class="comment"> * {@link Auth_Yadis_PHPSession} interface should be passed as the</span>
<a name="l117"><span class="linenum"> 117</span></a>  <span class="comment"> * second parameter.  Otherwise, the default uses $_SESSION.</span>
<a name="l118"><span class="linenum"> 118</span></a>  <span class="comment"> *</span>
<a name="l119"><span class="linenum"> 119</span></a>  <span class="comment"> * Next, the application should call the Auth_OpenID_Consumer object's</span>
<a name="l120"><span class="linenum"> 120</span></a>  <span class="comment"> * 'begin' method.  This method takes the OpenID URL.  The 'begin'</span>
<a name="l121"><span class="linenum"> 121</span></a>  <span class="comment"> * method returns an Auth_OpenID_AuthRequest object.</span>
<a name="l122"><span class="linenum"> 122</span></a>  <span class="comment"> *</span>
<a name="l123"><span class="linenum"> 123</span></a>  <span class="comment"> * Next, the application should call the 'redirectURL' method of the</span>
<a name="l124"><span class="linenum"> 124</span></a>  <span class="comment"> * Auth_OpenID_AuthRequest object.  The 'return_to' URL parameter is</span>
<a name="l125"><span class="linenum"> 125</span></a>  <span class="comment"> * the URL that the OpenID server will send the user back to after</span>
<a name="l126"><span class="linenum"> 126</span></a>  <span class="comment"> * attempting to verify his or her identity.  The 'trust_root' is the</span>
<a name="l127"><span class="linenum"> 127</span></a>  <span class="comment"> * URL (or URL pattern) that identifies your web site to the user when</span>
<a name="l128"><span class="linenum"> 128</span></a>  <span class="comment"> * he or she is authorizing it.  Send a redirect to the resulting URL</span>
<a name="l129"><span class="linenum"> 129</span></a>  <span class="comment"> * to the user's browser.</span>
<a name="l130"><span class="linenum"> 130</span></a>  <span class="comment"> *</span>
<a name="l131"><span class="linenum"> 131</span></a>  <span class="comment"> * That's the first half of the authentication process.  The second</span>
<a name="l132"><span class="linenum"> 132</span></a>  <span class="comment"> * half of the process is done after the user's ID server sends the</span>
<a name="l133"><span class="linenum"> 133</span></a>  <span class="comment"> * user's browser a redirect back to your site to complete their</span>
<a name="l134"><span class="linenum"> 134</span></a>  <span class="comment"> * login.</span>
<a name="l135"><span class="linenum"> 135</span></a>  <span class="comment"> *</span>
<a name="l136"><span class="linenum"> 136</span></a>  <span class="comment"> * When that happens, the user will contact your site at the URL given</span>
<a name="l137"><span class="linenum"> 137</span></a>  <span class="comment"> * as the 'return_to' URL to the Auth_OpenID_AuthRequest::redirectURL</span>
<a name="l138"><span class="linenum"> 138</span></a>  <span class="comment"> * call made above.  The request will have several query parameters</span>
<a name="l139"><span class="linenum"> 139</span></a>  <span class="comment"> * added to the URL by the identity server as the information</span>
<a name="l140"><span class="linenum"> 140</span></a>  <span class="comment"> * necessary to finish the request.</span>
<a name="l141"><span class="linenum"> 141</span></a>  <span class="comment"> *</span>
<a name="l142"><span class="linenum"> 142</span></a>  <span class="comment"> * Lastly, instantiate an Auth_OpenID_Consumer instance as above and</span>
<a name="l143"><span class="linenum"> 143</span></a>  <span class="comment"> * call its 'complete' method, passing in all the received query</span>
<a name="l144"><span class="linenum"> 144</span></a>  <span class="comment"> * arguments.</span>
<a name="l145"><span class="linenum"> 145</span></a>  <span class="comment"> *</span>
<a name="l146"><span class="linenum"> 146</span></a>  <span class="comment"> * There are multiple possible return types possible from that</span>
<a name="l147"><span class="linenum"> 147</span></a>  <span class="comment"> * method. These indicate the whether or not the login was successful,</span>
<a name="l148"><span class="linenum"> 148</span></a>  <span class="comment"> * and include any additional information appropriate for their type.</span>
<a name="l149"><span class="linenum"> 149</span></a>  <span class="comment"> *</span>
<a name="l150"><span class="linenum"> 150</span></a>  <span class="comment"> * PHP versions 4 and 5</span>
<a name="l151"><span class="linenum"> 151</span></a>  <span class="comment"> *</span>
<a name="l152"><span class="linenum"> 152</span></a>  <span class="comment"> * LICENSE: See the COPYING file included in this distribution.</span>
<a name="l153"><span class="linenum"> 153</span></a>  <span class="comment"> *</span>
<a name="l154"><span class="linenum"> 154</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l155"><span class="linenum"> 155</span></a>  <span class="comment"> * @author JanRain, Inc. &lt;openid@janrain.com&gt;</span>
<a name="l156"><span class="linenum"> 156</span></a>  <span class="comment"> * @copyright 2005-2008 Janrain, Inc.</span>
<a name="l157"><span class="linenum"> 157</span></a>  <span class="comment"> * @license http://www.apache.org/licenses/LICENSE-2.0 Apache</span>
<a name="l158"><span class="linenum"> 158</span></a>  <span class="comment"> */</span>
<a name="l159"><span class="linenum"> 159</span></a>  
<a name="l160"><span class="linenum"> 160</span></a>  <span class="comment">/**</span>
<a name="l161"><span class="linenum"> 161</span></a>  <span class="comment"> * Require utility classes and functions for the consumer.</span>
<a name="l162"><span class="linenum"> 162</span></a>  <span class="comment"> */</span>
<a name="l163"><span class="linenum"> 163</span></a>  require_once &quot;Auth/OpenID.php&quot;;
<a name="l164"><span class="linenum"> 164</span></a>  require_once &quot;Auth/OpenID/Message.php&quot;;
<a name="l165"><span class="linenum"> 165</span></a>  require_once &quot;Auth/OpenID/HMAC.php&quot;;
<a name="l166"><span class="linenum"> 166</span></a>  require_once &quot;Auth/OpenID/Association.php&quot;;
<a name="l167"><span class="linenum"> 167</span></a>  require_once &quot;Auth/OpenID/CryptUtil.php&quot;;
<a name="l168"><span class="linenum"> 168</span></a>  require_once &quot;Auth/OpenID/DiffieHellman.php&quot;;
<a name="l169"><span class="linenum"> 169</span></a>  require_once &quot;Auth/OpenID/KVForm.php&quot;;
<a name="l170"><span class="linenum"> 170</span></a>  require_once &quot;Auth/OpenID/Nonce.php&quot;;
<a name="l171"><span class="linenum"> 171</span></a>  require_once &quot;Auth/OpenID/Discover.php&quot;;
<a name="l172"><span class="linenum"> 172</span></a>  require_once &quot;Auth/OpenID/URINorm.php&quot;;
<a name="l173"><span class="linenum"> 173</span></a>  require_once &quot;Auth/Yadis/Manager.php&quot;;
<a name="l174"><span class="linenum"> 174</span></a>  require_once &quot;Auth/Yadis/XRI.php&quot;;
<a name="l175"><span class="linenum"> 175</span></a>  
<a name="l176"><span class="linenum"> 176</span></a>  <span class="comment">/**</span>
<a name="l177"><span class="linenum"> 177</span></a>  <span class="comment"> * This is the status code returned when the complete method returns</span>
<a name="l178"><span class="linenum"> 178</span></a>  <span class="comment"> * successfully.</span>
<a name="l179"><span class="linenum"> 179</span></a>  <span class="comment"> */</span>
<a name="l180"><span class="linenum"> 180</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('Auth_OpenID_SUCCESS', 'success');
<a name="l181"><span class="linenum"> 181</span></a>  
<a name="l182"><span class="linenum"> 182</span></a>  <span class="comment">/**</span>
<a name="l183"><span class="linenum"> 183</span></a>  <span class="comment"> * Status to indicate cancellation of OpenID authentication.</span>
<a name="l184"><span class="linenum"> 184</span></a>  <span class="comment"> */</span>
<a name="l185"><span class="linenum"> 185</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('Auth_OpenID_CANCEL', 'cancel');
<a name="l186"><span class="linenum"> 186</span></a>  
<a name="l187"><span class="linenum"> 187</span></a>  <span class="comment">/**</span>
<a name="l188"><span class="linenum"> 188</span></a>  <span class="comment"> * This is the status code completeAuth returns when the value it</span>
<a name="l189"><span class="linenum"> 189</span></a>  <span class="comment"> * received indicated an invalid login.</span>
<a name="l190"><span class="linenum"> 190</span></a>  <span class="comment"> */</span>
<a name="l191"><span class="linenum"> 191</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('Auth_OpenID_FAILURE', 'failure');
<a name="l192"><span class="linenum"> 192</span></a>  
<a name="l193"><span class="linenum"> 193</span></a>  <span class="comment">/**</span>
<a name="l194"><span class="linenum"> 194</span></a>  <span class="comment"> * This is the status code completeAuth returns when the</span>
<a name="l195"><span class="linenum"> 195</span></a>  <span class="comment"> * {@link Auth_OpenID_Consumer} instance is in immediate mode, and the</span>
<a name="l196"><span class="linenum"> 196</span></a>  <span class="comment"> * identity server sends back a URL to send the user to to complete his</span>
<a name="l197"><span class="linenum"> 197</span></a>  <span class="comment"> * or her login.</span>
<a name="l198"><span class="linenum"> 198</span></a>  <span class="comment"> */</span>
<a name="l199"><span class="linenum"> 199</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('Auth_OpenID_SETUP_NEEDED', 'setup needed');
<a name="l200"><span class="linenum"> 200</span></a>  
<a name="l201"><span class="linenum"> 201</span></a>  <span class="comment">/**</span>
<a name="l202"><span class="linenum"> 202</span></a>  <span class="comment"> * This is the status code beginAuth returns when the page fetched</span>
<a name="l203"><span class="linenum"> 203</span></a>  <span class="comment"> * from the entered OpenID URL doesn't contain the necessary link tags</span>
<a name="l204"><span class="linenum"> 204</span></a>  <span class="comment"> * to function as an identity page.</span>
<a name="l205"><span class="linenum"> 205</span></a>  <span class="comment"> */</span>
<a name="l206"><span class="linenum"> 206</span></a>  <a class="phpfunction" onClick="logFunction('define')" href="../../../../_functions/define.html" onMouseOver="phpfuncPopup(event,'define')">define</a>('Auth_OpenID_PARSE_ERROR', 'parse error');
<a name="l207"><span class="linenum"> 207</span></a>  
<a name="l208"><span class="linenum"> 208</span></a>  <span class="comment">/**</span>
<a name="l209"><span class="linenum"> 209</span></a>  <span class="comment"> * An OpenID consumer implementation that performs discovery and does</span>
<a name="l210"><span class="linenum"> 210</span></a>  <span class="comment"> * session management.  See the Consumer.php file documentation for</span>
<a name="l211"><span class="linenum"> 211</span></a>  <span class="comment"> * more information.</span>
<a name="l212"><span class="linenum"> 212</span></a>  <span class="comment"> *</span>
<a name="l213"><span class="linenum"> 213</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l214"><span class="linenum"> 214</span></a>  <span class="comment"> */</span>
<a name="l215"><span class="linenum"> 215</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_Consumer')" href="../../../../_classes/auth_openid_consumer.html" onMouseOver="classPopup(event,'auth_openid_consumer')">Auth_OpenID_Consumer</a> {
<a name="l216"><span class="linenum"> 216</span></a>  
<a name="l217"><span class="linenum"> 217</span></a>      <span class="comment">/**</span>
<a name="l218"><span class="linenum"> 218</span></a>  <span class="comment">     * @access private</span>
<a name="l219"><span class="linenum"> 219</span></a>  <span class="comment">     */</span>
<a name="l220"><span class="linenum"> 220</span></a>      var <a class="var it786" onMouseOver="hilite(786)" onMouseOut="lolite()" onClick="logVariable('discoverMethod')" href="../../../../_variables/discoverMethod.html">$discoverMethod</a> = 'Auth_OpenID_discover';
<a name="l221"><span class="linenum"> 221</span></a>  
<a name="l222"><span class="linenum"> 222</span></a>      <span class="comment">/**</span>
<a name="l223"><span class="linenum"> 223</span></a>  <span class="comment">     * @access private</span>
<a name="l224"><span class="linenum"> 224</span></a>  <span class="comment">     */</span>
<a name="l225"><span class="linenum"> 225</span></a>      var <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('session_key_prefix')" href="../../../../_variables/session_key_prefix.html">$session_key_prefix</a> = &quot;_openid_consumer_&quot;;
<a name="l226"><span class="linenum"> 226</span></a>  
<a name="l227"><span class="linenum"> 227</span></a>      <span class="comment">/**</span>
<a name="l228"><span class="linenum"> 228</span></a>  <span class="comment">     * @access private</span>
<a name="l229"><span class="linenum"> 229</span></a>  <span class="comment">     */</span>
<a name="l230"><span class="linenum"> 230</span></a>      var <a class="var it788" onMouseOver="hilite(788)" onMouseOut="lolite()" onClick="logVariable('_token_suffix')" href="../../../../_variables/_token_suffix.html">$_token_suffix</a> = &quot;last_token&quot;;
<a name="l231"><span class="linenum"> 231</span></a>  
<a name="l232"><span class="linenum"> 232</span></a>      <span class="comment">/**</span>
<a name="l233"><span class="linenum"> 233</span></a>  <span class="comment">     * Initialize a Consumer instance.</span>
<a name="l234"><span class="linenum"> 234</span></a>  <span class="comment">     *</span>
<a name="l235"><span class="linenum"> 235</span></a>  <span class="comment">     * You should create a new instance of the Consumer object with</span>
<a name="l236"><span class="linenum"> 236</span></a>  <span class="comment">     * every HTTP request that handles OpenID transactions.</span>
<a name="l237"><span class="linenum"> 237</span></a>  <span class="comment">     *</span>
<a name="l238"><span class="linenum"> 238</span></a>  <span class="comment">     * @param Auth_OpenID_OpenIDStore $store This must be an object</span>
<a name="l239"><span class="linenum"> 239</span></a>  <span class="comment">     * that implements the interface in {@link</span>
<a name="l240"><span class="linenum"> 240</span></a>  <span class="comment">     * Auth_OpenID_OpenIDStore}.  Several concrete implementations are</span>
<a name="l241"><span class="linenum"> 241</span></a>  <span class="comment">     * provided, to cover most common use cases.  For stores backed by</span>
<a name="l242"><span class="linenum"> 242</span></a>  <span class="comment">     * MySQL, PostgreSQL, or SQLite, see the {@link</span>
<a name="l243"><span class="linenum"> 243</span></a>  <span class="comment">     * Auth_OpenID_SQLStore} class and its sublcasses.  For a</span>
<a name="l244"><span class="linenum"> 244</span></a>  <span class="comment">     * filesystem-backed store, see the {@link Auth_OpenID_FileStore}</span>
<a name="l245"><span class="linenum"> 245</span></a>  <span class="comment">     * module.  As a last resort, if it isn't possible for the server</span>
<a name="l246"><span class="linenum"> 246</span></a>  <span class="comment">     * to store state at all, an instance of {@link</span>
<a name="l247"><span class="linenum"> 247</span></a>  <span class="comment">     * Auth_OpenID_DumbStore} can be used.</span>
<a name="l248"><span class="linenum"> 248</span></a>  <span class="comment">     *</span>
<a name="l249"><span class="linenum"> 249</span></a>  <span class="comment">     * @param mixed $session An object which implements the interface</span>
<a name="l250"><span class="linenum"> 250</span></a>  <span class="comment">     * of the {@link Auth_Yadis_PHPSession} class.  Particularly, this</span>
<a name="l251"><span class="linenum"> 251</span></a>  <span class="comment">     * object is expected to have these methods: get($key), set($key),</span>
<a name="l252"><span class="linenum"> 252</span></a>  <span class="comment">     * $value), and del($key).  This defaults to a session object</span>
<a name="l253"><span class="linenum"> 253</span></a>  <span class="comment">     * which wraps PHP's native session machinery.  You should only</span>
<a name="l254"><span class="linenum"> 254</span></a>  <span class="comment">     * need to pass something here if you have your own sessioning</span>
<a name="l255"><span class="linenum"> 255</span></a>  <span class="comment">     * implementation.</span>
<a name="l256"><span class="linenum"> 256</span></a>  <span class="comment">     *</span>
<a name="l257"><span class="linenum"> 257</span></a>  <span class="comment">     * @param str $consumer_cls The name of the class to instantiate</span>
<a name="l258"><span class="linenum"> 258</span></a>  <span class="comment">     * when creating the internal consumer object.  This is used for</span>
<a name="l259"><span class="linenum"> 259</span></a>  <span class="comment">     * testing.</span>
<a name="l260"><span class="linenum"> 260</span></a>  <span class="comment">     */</span>
<a name="l261"><span class="linenum"> 261</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_Consumer')" href="../../../../_functions/auth_openid_consumer.html" onMouseOver="funcPopup(event,'auth_openid_consumer')">Auth_OpenID_Consumer</a>(&amp;<a class="var it789" onMouseOver="hilite(789)" onMouseOut="lolite()" onClick="logVariable('store')" href="../../../../_variables/store.html">$store</a>, <a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../../_variables/session.html">$session</a> = null,
<a name="l262"><span class="linenum"> 262</span></a>                                    <a class="var it790" onMouseOver="hilite(790)" onMouseOut="lolite()" onClick="logVariable('consumer_cls')" href="../../../../_variables/consumer_cls.html">$consumer_cls</a> = null)
<a name="l263"><span class="linenum"> 263</span></a>      {
<a name="l264"><span class="linenum"> 264</span></a>          if (<a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../../_variables/session.html">$session</a> === null) {
<a name="l265"><span class="linenum"> 265</span></a>              <a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../../_variables/session.html">$session</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_Yadis_PHPSession')" href="../../../../_classes/auth_yadis_phpsession.html" onMouseOver="classPopup(event,'auth_yadis_phpsession')">Auth_Yadis_PHPSession</a>();
<a name="l266"><span class="linenum"> 266</span></a>          }
<a name="l267"><span class="linenum"> 267</span></a>  
<a name="l268"><span class="linenum"> 268</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session.html">session</a> =&amp; <a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../../_variables/session.html">$session</a>;
<a name="l269"><span class="linenum"> 269</span></a>  
<a name="l270"><span class="linenum"> 270</span></a>          if (<a class="var it790" onMouseOver="hilite(790)" onMouseOut="lolite()" onClick="logVariable('consumer_cls')" href="../../../../_variables/consumer_cls.html">$consumer_cls</a> !== null) {
<a name="l271"><span class="linenum"> 271</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('consumer')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/consumer.html">consumer</a> =&amp; new <a class="var it790" onMouseOver="hilite(790)" onMouseOut="lolite()" onClick="logVariable('consumer_cls')" href="../../../../_variables/consumer_cls.html">$consumer_cls</a>(<a class="var it789" onMouseOver="hilite(789)" onMouseOut="lolite()" onClick="logVariable('store')" href="../../../../_variables/store.html">$store</a>);
<a name="l272"><span class="linenum"> 272</span></a>          } else {
<a name="l273"><span class="linenum"> 273</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('consumer')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/consumer.html">consumer</a> =&amp; <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_GenericConsumer')" href="../../../../_classes/auth_openid_genericconsumer.html" onMouseOver="classPopup(event,'auth_openid_genericconsumer')">Auth_OpenID_GenericConsumer</a>(<a class="var it789" onMouseOver="hilite(789)" onMouseOut="lolite()" onClick="logVariable('store')" href="../../../../_variables/store.html">$store</a>);
<a name="l274"><span class="linenum"> 274</span></a>          }
<a name="l275"><span class="linenum"> 275</span></a>  
<a name="l276"><span class="linenum"> 276</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_token_key')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_token_key.html">_token_key</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session_key_prefix')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session_key_prefix.html">session_key_prefix</a> . <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_token_suffix')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_token_suffix.html">_token_suffix</a>;
<a name="l277"><span class="linenum"> 277</span></a>      }
<a name="l278"><span class="linenum"> 278</span></a>  
<a name="l279"><span class="linenum"> 279</span></a>      <span class="comment">/**</span>
<a name="l280"><span class="linenum"> 280</span></a>  <span class="comment">     * Used in testing to define the discovery mechanism.</span>
<a name="l281"><span class="linenum"> 281</span></a>  <span class="comment">     *</span>
<a name="l282"><span class="linenum"> 282</span></a>  <span class="comment">     * @access private</span>
<a name="l283"><span class="linenum"> 283</span></a>  <span class="comment">     */</span>
<a name="l284"><span class="linenum"> 284</span></a>      function <a class="function" onClick="logFunction('getDiscoveryObject')" href="../../../../_functions/getdiscoveryobject.html" onMouseOver="funcPopup(event,'getdiscoveryobject')">getDiscoveryObject</a>(&amp;<a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../../_variables/session.html">$session</a>, <a class="var it793" onMouseOver="hilite(793)" onMouseOut="lolite()" onClick="logVariable('openid_url')" href="../../../../_variables/openid_url.html">$openid_url</a>,
<a name="l285"><span class="linenum"> 285</span></a>                                  <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('session_key_prefix')" href="../../../../_variables/session_key_prefix.html">$session_key_prefix</a>)
<a name="l286"><span class="linenum"> 286</span></a>      {
<a name="l287"><span class="linenum"> 287</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_Yadis_Discovery')" href="../../../../_classes/auth_yadis_discovery.html" onMouseOver="classPopup(event,'auth_yadis_discovery')">Auth_Yadis_Discovery</a>(<a class="var it595" onMouseOver="hilite(595)" onMouseOut="lolite()" onClick="logVariable('session')" href="../../../../_variables/session.html">$session</a>, <a class="var it793" onMouseOver="hilite(793)" onMouseOut="lolite()" onClick="logVariable('openid_url')" href="../../../../_variables/openid_url.html">$openid_url</a>,
<a name="l288"><span class="linenum"> 288</span></a>                                          <a class="var it787" onMouseOver="hilite(787)" onMouseOut="lolite()" onClick="logVariable('session_key_prefix')" href="../../../../_variables/session_key_prefix.html">$session_key_prefix</a>);
<a name="l289"><span class="linenum"> 289</span></a>      }
<a name="l290"><span class="linenum"> 290</span></a>  
<a name="l291"><span class="linenum"> 291</span></a>      <span class="comment">/**</span>
<a name="l292"><span class="linenum"> 292</span></a>  <span class="comment">     * Start the OpenID authentication process. See steps 1-2 in the</span>
<a name="l293"><span class="linenum"> 293</span></a>  <span class="comment">     * overview at the top of this file.</span>
<a name="l294"><span class="linenum"> 294</span></a>  <span class="comment">     *</span>
<a name="l295"><span class="linenum"> 295</span></a>  <span class="comment">     * @param string $user_url Identity URL given by the user. This</span>
<a name="l296"><span class="linenum"> 296</span></a>  <span class="comment">     * method performs a textual transformation of the URL to try and</span>
<a name="l297"><span class="linenum"> 297</span></a>  <span class="comment">     * make sure it is normalized. For example, a user_url of</span>
<a name="l298"><span class="linenum"> 298</span></a>  <span class="comment">     * example.com will be normalized to http://example.com/</span>
<a name="l299"><span class="linenum"> 299</span></a>  <span class="comment">     * normalizing and resolving any redirects the server might issue.</span>
<a name="l300"><span class="linenum"> 300</span></a>  <span class="comment">     *</span>
<a name="l301"><span class="linenum"> 301</span></a>  <span class="comment">     * @param bool $anonymous True if the OpenID request is to be sent</span>
<a name="l302"><span class="linenum"> 302</span></a>  <span class="comment">     * to the server without any identifier information.  Use this</span>
<a name="l303"><span class="linenum"> 303</span></a>  <span class="comment">     * when you want to transport data but don't want to do OpenID</span>
<a name="l304"><span class="linenum"> 304</span></a>  <span class="comment">     * authentication with identifiers.</span>
<a name="l305"><span class="linenum"> 305</span></a>  <span class="comment">     *</span>
<a name="l306"><span class="linenum"> 306</span></a>  <span class="comment">     * @return Auth_OpenID_AuthRequest $auth_request An object</span>
<a name="l307"><span class="linenum"> 307</span></a>  <span class="comment">     * containing the discovered information will be returned, with a</span>
<a name="l308"><span class="linenum"> 308</span></a>  <span class="comment">     * method for building a redirect URL to the server, as described</span>
<a name="l309"><span class="linenum"> 309</span></a>  <span class="comment">     * in step 3 of the overview. This object may also be used to add</span>
<a name="l310"><span class="linenum"> 310</span></a>  <span class="comment">     * extension arguments to the request, using its 'addExtensionArg'</span>
<a name="l311"><span class="linenum"> 311</span></a>  <span class="comment">     * method.</span>
<a name="l312"><span class="linenum"> 312</span></a>  <span class="comment">     */</span>
<a name="l313"><span class="linenum"> 313</span></a>      function <a class="function" onClick="logFunction('begin')" href="../../../../_functions/begin.html" onMouseOver="funcPopup(event,'begin')">begin</a>(<a class="var it794" onMouseOver="hilite(794)" onMouseOut="lolite()" onClick="logVariable('user_url')" href="../../../../_variables/user_url.html">$user_url</a>, <a class="var it795" onMouseOver="hilite(795)" onMouseOut="lolite()" onClick="logVariable('anonymous')" href="../../../../_variables/anonymous.html">$anonymous</a>=false)
<a name="l314"><span class="linenum"> 314</span></a>      {
<a name="l315"><span class="linenum"> 315</span></a>          <a class="var it793" onMouseOver="hilite(793)" onMouseOut="lolite()" onClick="logVariable('openid_url')" href="../../../../_variables/openid_url.html">$openid_url</a> = <a class="var it794" onMouseOver="hilite(794)" onMouseOut="lolite()" onClick="logVariable('user_url')" href="../../../../_variables/user_url.html">$user_url</a>;
<a name="l316"><span class="linenum"> 316</span></a>  
<a name="l317"><span class="linenum"> 317</span></a>          <a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDiscoveryObject')" href="../../../../_functions/getdiscoveryobject.html" onMouseOver="funcPopup(event,'getdiscoveryobject')">getDiscoveryObject</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session.html">session</a>,
<a name="l318"><span class="linenum"> 318</span></a>                                             <a class="var it793" onMouseOver="hilite(793)" onMouseOut="lolite()" onClick="logVariable('openid_url')" href="../../../../_variables/openid_url.html">$openid_url</a>,
<a name="l319"><span class="linenum"> 319</span></a>                                             <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session_key_prefix')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session_key_prefix.html">session_key_prefix</a>);
<a name="l320"><span class="linenum"> 320</span></a>  
<a name="l321"><span class="linenum"> 321</span></a>  <span class="comment">        // Set the 'stale' attribute of the manager.  If discovery</span>
<a name="l322"><span class="linenum"> 322</span></a>  <span class="comment">        // fails in a fatal way, the stale flag will cause the manager</span>
<a name="l323"><span class="linenum"> 323</span></a>  <span class="comment">        // to be cleaned up next time discovery is attempted.</span>
<a name="l324"><span class="linenum"> 324</span></a>  
<a name="l325"><span class="linenum"> 325</span></a>          <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../../../_variables/m.html">$m</a> = <a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a>-&gt;<a class="function" onClick="logFunction('getManager')" href="../../../../_functions/getmanager.html" onMouseOver="funcPopup(event,'getmanager')">getManager</a>();
<a name="l326"><span class="linenum"> 326</span></a>          <a class="var it797" onMouseOver="hilite(797)" onMouseOut="lolite()" onClick="logVariable('loader')" href="../../../../_variables/loader.html">$loader</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_Yadis_ManagerLoader')" href="../../../../_classes/auth_yadis_managerloader.html" onMouseOver="classPopup(event,'auth_yadis_managerloader')">Auth_Yadis_ManagerLoader</a>();
<a name="l327"><span class="linenum"> 327</span></a>  
<a name="l328"><span class="linenum"> 328</span></a>          if (<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../../../_variables/m.html">$m</a>) {
<a name="l329"><span class="linenum"> 329</span></a>              if (<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../../../_variables/m.html">$m</a>-&gt;<a onClick="logVariable('stale')" class="var it2304" onMouseOver="hilite(2304)" onMouseOut="lolite()" href="../../../../_variables/stale.html">stale</a>) {
<a name="l330"><span class="linenum"> 330</span></a>                  <a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a>-&gt;<a class="function" onClick="logFunction('destroyManager')" href="../../../../_functions/destroymanager.html" onMouseOver="funcPopup(event,'destroymanager')">destroyManager</a>();
<a name="l331"><span class="linenum"> 331</span></a>              } else {
<a name="l332"><span class="linenum"> 332</span></a>                  <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../../../_variables/m.html">$m</a>-&gt;<a onClick="logVariable('stale')" class="var it2304" onMouseOver="hilite(2304)" onMouseOut="lolite()" href="../../../../_variables/stale.html">stale</a> = true;
<a name="l333"><span class="linenum"> 333</span></a>                  <a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a>-&gt;<a onClick="logVariable('session')" class="var it2305" onMouseOver="hilite(2305)" onMouseOut="lolite()" href="../../../../_variables/session.html">session</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>(<a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a>-&gt;<a onClick="logVariable('session_key')" class="var it2305" onMouseOver="hilite(2305)" onMouseOut="lolite()" href="../../../../_variables/session_key.html">session_key</a>,
<a name="l334"><span class="linenum"> 334</span></a>                                       <a class="phpfunction" onClick="logFunction('serialize')" href="../../../../_functions/serialize.html" onMouseOver="phpfuncPopup(event,'serialize')">serialize</a>(<a class="var it797" onMouseOver="hilite(797)" onMouseOut="lolite()" onClick="logVariable('loader')" href="../../../../_variables/loader.html">$loader</a>-&gt;<a class="function" onClick="logFunction('toSession')" href="../../../../_functions/tosession.html" onMouseOver="funcPopup(event,'tosession')">toSession</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../../../_variables/m.html">$m</a>)));
<a name="l335"><span class="linenum"> 335</span></a>              }
<a name="l336"><span class="linenum"> 336</span></a>          }
<a name="l337"><span class="linenum"> 337</span></a>  
<a name="l338"><span class="linenum"> 338</span></a>          <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a> = <a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a>-&gt;<a class="function" onClick="logFunction('getNextService')" href="../../../../_functions/getnextservice.html" onMouseOver="funcPopup(event,'getnextservice')">getNextService</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('discoverMethod')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/discoverMethod.html">discoverMethod</a>,
<a name="l339"><span class="linenum"> 339</span></a>                                             <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('consumer')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/consumer.html">consumer</a>-&gt;fetcher);
<a name="l340"><span class="linenum"> 340</span></a>  
<a name="l341"><span class="linenum"> 341</span></a>  <span class="comment">        // Reset the 'stale' attribute of the manager.</span>
<a name="l342"><span class="linenum"> 342</span></a>          <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../../../_variables/m.html">$m</a> =&amp; <a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a>-&gt;<a class="function" onClick="logFunction('getManager')" href="../../../../_functions/getmanager.html" onMouseOver="funcPopup(event,'getmanager')">getManager</a>();
<a name="l343"><span class="linenum"> 343</span></a>          if (<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../../../_variables/m.html">$m</a>) {
<a name="l344"><span class="linenum"> 344</span></a>              <a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../../../_variables/m.html">$m</a>-&gt;<a onClick="logVariable('stale')" class="var it2304" onMouseOver="hilite(2304)" onMouseOut="lolite()" href="../../../../_variables/stale.html">stale</a> = false;
<a name="l345"><span class="linenum"> 345</span></a>              <a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a>-&gt;<a onClick="logVariable('session')" class="var it2305" onMouseOver="hilite(2305)" onMouseOut="lolite()" href="../../../../_variables/session.html">session</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>(<a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a>-&gt;<a onClick="logVariable('session_key')" class="var it2305" onMouseOver="hilite(2305)" onMouseOut="lolite()" href="../../../../_variables/session_key.html">session_key</a>,
<a name="l346"><span class="linenum"> 346</span></a>                                   <a class="phpfunction" onClick="logFunction('serialize')" href="../../../../_functions/serialize.html" onMouseOver="phpfuncPopup(event,'serialize')">serialize</a>(<a class="var it797" onMouseOver="hilite(797)" onMouseOut="lolite()" onClick="logVariable('loader')" href="../../../../_variables/loader.html">$loader</a>-&gt;<a class="function" onClick="logFunction('toSession')" href="../../../../_functions/tosession.html" onMouseOver="funcPopup(event,'tosession')">toSession</a>(<a class="var it276" onMouseOver="hilite(276)" onMouseOut="lolite()" onClick="logVariable('m')" href="../../../../_variables/m.html">$m</a>)));
<a name="l347"><span class="linenum"> 347</span></a>          }
<a name="l348"><span class="linenum"> 348</span></a>  
<a name="l349"><span class="linenum"> 349</span></a>          if (<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a> === null) {
<a name="l350"><span class="linenum"> 350</span></a>              return null;
<a name="l351"><span class="linenum"> 351</span></a>          } else {
<a name="l352"><span class="linenum"> 352</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('beginWithoutDiscovery')" href="../../../../_functions/beginwithoutdiscovery.html" onMouseOver="funcPopup(event,'beginwithoutdiscovery')">beginWithoutDiscovery</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l353"><span class="linenum"> 353</span></a>                                                  <a class="var it795" onMouseOver="hilite(795)" onMouseOut="lolite()" onClick="logVariable('anonymous')" href="../../../../_variables/anonymous.html">$anonymous</a>);
<a name="l354"><span class="linenum"> 354</span></a>          }
<a name="l355"><span class="linenum"> 355</span></a>      }
<a name="l356"><span class="linenum"> 356</span></a>  
<a name="l357"><span class="linenum"> 357</span></a>      <span class="comment">/**</span>
<a name="l358"><span class="linenum"> 358</span></a>  <span class="comment">     * Start OpenID verification without doing OpenID server</span>
<a name="l359"><span class="linenum"> 359</span></a>  <span class="comment">     * discovery. This method is used internally by Consumer.begin</span>
<a name="l360"><span class="linenum"> 360</span></a>  <span class="comment">     * after discovery is performed, and exists to provide an</span>
<a name="l361"><span class="linenum"> 361</span></a>  <span class="comment">     * interface for library users needing to perform their own</span>
<a name="l362"><span class="linenum"> 362</span></a>  <span class="comment">     * discovery.</span>
<a name="l363"><span class="linenum"> 363</span></a>  <span class="comment">     *</span>
<a name="l364"><span class="linenum"> 364</span></a>  <span class="comment">     * @param Auth_OpenID_ServiceEndpoint $endpoint an OpenID service</span>
<a name="l365"><span class="linenum"> 365</span></a>  <span class="comment">     * endpoint descriptor.</span>
<a name="l366"><span class="linenum"> 366</span></a>  <span class="comment">     *</span>
<a name="l367"><span class="linenum"> 367</span></a>  <span class="comment">     * @param bool anonymous Set to true if you want to perform OpenID</span>
<a name="l368"><span class="linenum"> 368</span></a>  <span class="comment">     * without identifiers.</span>
<a name="l369"><span class="linenum"> 369</span></a>  <span class="comment">     *</span>
<a name="l370"><span class="linenum"> 370</span></a>  <span class="comment">     * @return Auth_OpenID_AuthRequest $auth_request An OpenID</span>
<a name="l371"><span class="linenum"> 371</span></a>  <span class="comment">     * authentication request object.</span>
<a name="l372"><span class="linenum"> 372</span></a>  <span class="comment">     */</span>
<a name="l373"><span class="linenum"> 373</span></a>      function &amp;<a class="function" onClick="logFunction('beginWithoutDiscovery')" href="../../../../_functions/beginwithoutdiscovery.html" onMouseOver="funcPopup(event,'beginwithoutdiscovery')">beginWithoutDiscovery</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it795" onMouseOver="hilite(795)" onMouseOut="lolite()" onClick="logVariable('anonymous')" href="../../../../_variables/anonymous.html">$anonymous</a>=false)
<a name="l374"><span class="linenum"> 374</span></a>      {
<a name="l375"><span class="linenum"> 375</span></a>          <a class="var it797" onMouseOver="hilite(797)" onMouseOut="lolite()" onClick="logVariable('loader')" href="../../../../_variables/loader.html">$loader</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_ServiceEndpointLoader')" href="../../../../_classes/auth_openid_serviceendpointloader.html" onMouseOver="classPopup(event,'auth_openid_serviceendpointloader')">Auth_OpenID_ServiceEndpointLoader</a>();
<a name="l376"><span class="linenum"> 376</span></a>          <a class="var it801" onMouseOver="hilite(801)" onMouseOut="lolite()" onClick="logVariable('auth_req')" href="../../../../_variables/auth_req.html">$auth_req</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('consumer')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/consumer.html">consumer</a>-&gt;<a class="function" onClick="logFunction('begin')" href="../../../../_functions/begin.html" onMouseOver="funcPopup(event,'begin')">begin</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l377"><span class="linenum"> 377</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session.html">session</a>-&gt;<a class="function" onClick="logFunction('set')" href="../../../../_functions/set.html" onMouseOver="funcPopup(event,'set')">set</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_token_key')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_token_key.html">_token_key</a>,
<a name="l378"><span class="linenum"> 378</span></a>                <a class="var it797" onMouseOver="hilite(797)" onMouseOut="lolite()" onClick="logVariable('loader')" href="../../../../_variables/loader.html">$loader</a>-&gt;<a class="function" onClick="logFunction('toSession')" href="../../../../_functions/tosession.html" onMouseOver="funcPopup(event,'tosession')">toSession</a>(<a class="var it801" onMouseOver="hilite(801)" onMouseOut="lolite()" onClick="logVariable('auth_req')" href="../../../../_variables/auth_req.html">$auth_req</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2306" onMouseOver="hilite(2306)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a>));
<a name="l379"><span class="linenum"> 379</span></a>          if (!<a class="var it801" onMouseOver="hilite(801)" onMouseOut="lolite()" onClick="logVariable('auth_req')" href="../../../../_variables/auth_req.html">$auth_req</a>-&gt;<a class="function" onClick="logFunction('setAnonymous')" href="../../../../_functions/setanonymous.html" onMouseOver="funcPopup(event,'setanonymous')">setAnonymous</a>(<a class="var it795" onMouseOver="hilite(795)" onMouseOut="lolite()" onClick="logVariable('anonymous')" href="../../../../_variables/anonymous.html">$anonymous</a>)) {
<a name="l380"><span class="linenum"> 380</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l381"><span class="linenum"> 381</span></a>                &quot;OpenID 1 requests MUST include the identifier &quot; .
<a name="l382"><span class="linenum"> 382</span></a>                &quot;in the request.&quot;);
<a name="l383"><span class="linenum"> 383</span></a>          }
<a name="l384"><span class="linenum"> 384</span></a>          return <a class="var it801" onMouseOver="hilite(801)" onMouseOut="lolite()" onClick="logVariable('auth_req')" href="../../../../_variables/auth_req.html">$auth_req</a>;
<a name="l385"><span class="linenum"> 385</span></a>      }
<a name="l386"><span class="linenum"> 386</span></a>  
<a name="l387"><span class="linenum"> 387</span></a>      <span class="comment">/**</span>
<a name="l388"><span class="linenum"> 388</span></a>  <span class="comment">     * Called to interpret the server's response to an OpenID</span>
<a name="l389"><span class="linenum"> 389</span></a>  <span class="comment">     * request. It is called in step 4 of the flow described in the</span>
<a name="l390"><span class="linenum"> 390</span></a>  <span class="comment">     * consumer overview.</span>
<a name="l391"><span class="linenum"> 391</span></a>  <span class="comment">     *</span>
<a name="l392"><span class="linenum"> 392</span></a>  <span class="comment">     * @param string $current_url The URL used to invoke the application.</span>
<a name="l393"><span class="linenum"> 393</span></a>  <span class="comment">     * Extract the URL from your application's web</span>
<a name="l394"><span class="linenum"> 394</span></a>  <span class="comment">     * request framework and specify it here to have it checked</span>
<a name="l395"><span class="linenum"> 395</span></a>  <span class="comment">     * against the openid.current_url value in the response.  If</span>
<a name="l396"><span class="linenum"> 396</span></a>  <span class="comment">     * the current_url URL check fails, the status of the</span>
<a name="l397"><span class="linenum"> 397</span></a>  <span class="comment">     * completion will be FAILURE.</span>
<a name="l398"><span class="linenum"> 398</span></a>  <span class="comment">     *</span>
<a name="l399"><span class="linenum"> 399</span></a>  <span class="comment">     * @param array $query An array of the query parameters (key =&gt;</span>
<a name="l400"><span class="linenum"> 400</span></a>  <span class="comment">     * value pairs) for this HTTP request.  Defaults to null.  If</span>
<a name="l401"><span class="linenum"> 401</span></a>  <span class="comment">     * null, the GET or POST data are automatically gotten from the</span>
<a name="l402"><span class="linenum"> 402</span></a>  <span class="comment">     * PHP environment.  It is only useful to override $query for</span>
<a name="l403"><span class="linenum"> 403</span></a>  <span class="comment">     * testing.</span>
<a name="l404"><span class="linenum"> 404</span></a>  <span class="comment">     *</span>
<a name="l405"><span class="linenum"> 405</span></a>  <span class="comment">     * @return Auth_OpenID_ConsumerResponse $response A instance of an</span>
<a name="l406"><span class="linenum"> 406</span></a>  <span class="comment">     * Auth_OpenID_ConsumerResponse subclass. The type of response is</span>
<a name="l407"><span class="linenum"> 407</span></a>  <span class="comment">     * indicated by the status attribute, which will be one of</span>
<a name="l408"><span class="linenum"> 408</span></a>  <span class="comment">     * SUCCESS, CANCEL, FAILURE, or SETUP_NEEDED.</span>
<a name="l409"><span class="linenum"> 409</span></a>  <span class="comment">     */</span>
<a name="l410"><span class="linenum"> 410</span></a>      function <a class="function" onClick="logFunction('complete')" href="../../../../_functions/complete.html" onMouseOver="funcPopup(event,'complete')">complete</a>(<a class="var it802" onMouseOver="hilite(802)" onMouseOut="lolite()" onClick="logVariable('current_url')" href="../../../../_variables/current_url.html">$current_url</a>, <a class="var it465" onMouseOver="hilite(465)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../../_variables/query.html">$query</a>=null)
<a name="l411"><span class="linenum"> 411</span></a>      {
<a name="l412"><span class="linenum"> 412</span></a>          if (<a class="var it802" onMouseOver="hilite(802)" onMouseOut="lolite()" onClick="logVariable('current_url')" href="../../../../_variables/current_url.html">$current_url</a> &amp;&amp; !<a class="phpfunction" onClick="logFunction('is_string')" href="../../../../_functions/is_string.html" onMouseOver="phpfuncPopup(event,'is_string')">is_string</a>(<a class="var it802" onMouseOver="hilite(802)" onMouseOut="lolite()" onClick="logVariable('current_url')" href="../../../../_variables/current_url.html">$current_url</a>)) {
<a name="l413"><span class="linenum"> 413</span></a>  <span class="comment">            // This is ugly, but we need to complain loudly when</span>
<a name="l414"><span class="linenum"> 414</span></a>  <span class="comment">            // someone uses the API incorrectly.</span>
<a name="l415"><span class="linenum"> 415</span></a>              <a class="phpfunction" onClick="logFunction('trigger_error')" href="../../../../_functions/trigger_error.html" onMouseOver="phpfuncPopup(event,'trigger_error')">trigger_error</a>(&quot;current_url must be a string; see NEWS file &quot; .
<a name="l416"><span class="linenum"> 416</span></a>                            &quot;for upgrading notes.&quot;,
<a name="l417"><span class="linenum"> 417</span></a>                            E_USER_ERROR);
<a name="l418"><span class="linenum"> 418</span></a>          }
<a name="l419"><span class="linenum"> 419</span></a>  
<a name="l420"><span class="linenum"> 420</span></a>          if (<a class="var it465" onMouseOver="hilite(465)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../../_variables/query.html">$query</a> === null) {
<a name="l421"><span class="linenum"> 421</span></a>              <a class="var it465" onMouseOver="hilite(465)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../../_variables/query.html">$query</a> = <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('getQuery')" href="../../../../_functions/getquery.html" onMouseOver="funcPopup(event,'getquery')">getQuery</a>();
<a name="l422"><span class="linenum"> 422</span></a>          }
<a name="l423"><span class="linenum"> 423</span></a>  
<a name="l424"><span class="linenum"> 424</span></a>          <a class="var it797" onMouseOver="hilite(797)" onMouseOut="lolite()" onClick="logVariable('loader')" href="../../../../_variables/loader.html">$loader</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_ServiceEndpointLoader')" href="../../../../_classes/auth_openid_serviceendpointloader.html" onMouseOver="classPopup(event,'auth_openid_serviceendpointloader')">Auth_OpenID_ServiceEndpointLoader</a>();
<a name="l425"><span class="linenum"> 425</span></a>          <a class="var it803" onMouseOver="hilite(803)" onMouseOut="lolite()" onClick="logVariable('endpoint_data')" href="../../../../_variables/endpoint_data.html">$endpoint_data</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session.html">session</a>-&gt;<a class="function" onClick="logFunction('get')" href="../../../../_functions/get.html" onMouseOver="funcPopup(event,'get')">get</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_token_key')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_token_key.html">_token_key</a>);
<a name="l426"><span class="linenum"> 426</span></a>          <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a> =
<a name="l427"><span class="linenum"> 427</span></a>              <a class="var it797" onMouseOver="hilite(797)" onMouseOut="lolite()" onClick="logVariable('loader')" href="../../../../_variables/loader.html">$loader</a>-&gt;<a class="function" onClick="logFunction('fromSession')" href="../../../../_functions/fromsession.html" onMouseOver="funcPopup(event,'fromsession')">fromSession</a>(<a class="var it803" onMouseOver="hilite(803)" onMouseOut="lolite()" onClick="logVariable('endpoint_data')" href="../../../../_variables/endpoint_data.html">$endpoint_data</a>);
<a name="l428"><span class="linenum"> 428</span></a>  
<a name="l429"><span class="linenum"> 429</span></a>          <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a> = <a class="class" onClick="logClass('Auth_OpenID_Message')" href="../../../../_classes/auth_openid_message.html" onMouseOver="classPopup(event,'auth_openid_message')">Auth_OpenID_Message</a>::<a class="function" onClick="logFunction('fromPostArgs')" href="../../../../_functions/frompostargs.html" onMouseOver="funcPopup(event,'frompostargs')">fromPostArgs</a>(<a class="var it465" onMouseOver="hilite(465)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../../_variables/query.html">$query</a>);
<a name="l430"><span class="linenum"> 430</span></a>          <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('consumer')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/consumer.html">consumer</a>-&gt;<a class="function" onClick="logFunction('complete')" href="../../../../_functions/complete.html" onMouseOver="funcPopup(event,'complete')">complete</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, 
<a name="l431"><span class="linenum"> 431</span></a>                                                <a class="var it802" onMouseOver="hilite(802)" onMouseOut="lolite()" onClick="logVariable('current_url')" href="../../../../_variables/current_url.html">$current_url</a>);
<a name="l432"><span class="linenum"> 432</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session.html">session</a>-&gt;<a class="function" onClick="logFunction('del')" href="../../../../_functions/del.html" onMouseOver="funcPopup(event,'del')">del</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_token_key')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_token_key.html">_token_key</a>);
<a name="l433"><span class="linenum"> 433</span></a>  
<a name="l434"><span class="linenum"> 434</span></a>          if (<a class="phpfunction" onClick="logFunction('in_array')" href="../../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('status')" class="var it2285" onMouseOver="hilite(2285)" onMouseOut="lolite()" href="../../../../_variables/status.html">status</a>, array(Auth_OpenID_SUCCESS,
<a name="l435"><span class="linenum"> 435</span></a>                                                Auth_OpenID_CANCEL))) {
<a name="l436"><span class="linenum"> 436</span></a>              if (<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('identity_url')" class="var it2285" onMouseOver="hilite(2285)" onMouseOut="lolite()" href="../../../../_variables/identity_url.html">identity_url</a> !== null) {
<a name="l437"><span class="linenum"> 437</span></a>                  <a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getDiscoveryObject')" href="../../../../_functions/getdiscoveryobject.html" onMouseOver="funcPopup(event,'getdiscoveryobject')">getDiscoveryObject</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session.html">session</a>,
<a name="l438"><span class="linenum"> 438</span></a>                                                     <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('identity_url')" class="var it2285" onMouseOver="hilite(2285)" onMouseOut="lolite()" href="../../../../_variables/identity_url.html">identity_url</a>,
<a name="l439"><span class="linenum"> 439</span></a>                                                     <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session_key_prefix')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session_key_prefix.html">session_key_prefix</a>);
<a name="l440"><span class="linenum"> 440</span></a>                  <a class="var it796" onMouseOver="hilite(796)" onMouseOut="lolite()" onClick="logVariable('disco')" href="../../../../_variables/disco.html">$disco</a>-&gt;<a class="function" onClick="logFunction('cleanup')" href="../../../../_functions/cleanup.html" onMouseOver="funcPopup(event,'cleanup')">cleanup</a>(true);
<a name="l441"><span class="linenum"> 441</span></a>              }
<a name="l442"><span class="linenum"> 442</span></a>          }
<a name="l443"><span class="linenum"> 443</span></a>  
<a name="l444"><span class="linenum"> 444</span></a>          return <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>;
<a name="l445"><span class="linenum"> 445</span></a>      }
<a name="l446"><span class="linenum"> 446</span></a>  }
<a name="l447"><span class="linenum"> 447</span></a>  
<a name="l448"><span class="linenum"> 448</span></a>  <span class="comment">/**</span>
<a name="l449"><span class="linenum"> 449</span></a>  <span class="comment"> * A class implementing HMAC/DH-SHA1 consumer sessions.</span>
<a name="l450"><span class="linenum"> 450</span></a>  <span class="comment"> *</span>
<a name="l451"><span class="linenum"> 451</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l452"><span class="linenum"> 452</span></a>  <span class="comment"> */</span>
<a name="l453"><span class="linenum"> 453</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_DiffieHellmanSHA1ConsumerSession')" href="../../../../_classes/auth_openid_diffiehellmansha1consumersession.html" onMouseOver="classPopup(event,'auth_openid_diffiehellmansha1consumersession')">Auth_OpenID_DiffieHellmanSHA1ConsumerSession</a> {
<a name="l454"><span class="linenum"> 454</span></a>      var <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> = 'DH-SHA1';
<a name="l455"><span class="linenum"> 455</span></a>      var <a class="var it806" onMouseOver="hilite(806)" onMouseOut="lolite()" onClick="logVariable('hash_func')" href="../../../../_variables/hash_func.html">$hash_func</a> = 'Auth_OpenID_SHA1';
<a name="l456"><span class="linenum"> 456</span></a>      var <a class="var it807" onMouseOver="hilite(807)" onMouseOut="lolite()" onClick="logVariable('secret_size')" href="../../../../_variables/secret_size.html">$secret_size</a> = 20;
<a name="l457"><span class="linenum"> 457</span></a>      var <a class="var it808" onMouseOver="hilite(808)" onMouseOut="lolite()" onClick="logVariable('allowed_assoc_types')" href="../../../../_variables/allowed_assoc_types.html">$allowed_assoc_types</a> = array('HMAC-SHA1');
<a name="l458"><span class="linenum"> 458</span></a>  
<a name="l459"><span class="linenum"> 459</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_DiffieHellmanSHA1ConsumerSession')" href="../../../../_functions/auth_openid_diffiehellmansha1consumersession.html" onMouseOver="funcPopup(event,'auth_openid_diffiehellmansha1consumersession')">Auth_OpenID_DiffieHellmanSHA1ConsumerSession</a>(<a class="var it809" onMouseOver="hilite(809)" onMouseOut="lolite()" onClick="logVariable('dh')" href="../../../../_variables/dh.html">$dh</a> = null)
<a name="l460"><span class="linenum"> 460</span></a>      {
<a name="l461"><span class="linenum"> 461</span></a>          if (<a class="var it809" onMouseOver="hilite(809)" onMouseOut="lolite()" onClick="logVariable('dh')" href="../../../../_variables/dh.html">$dh</a> === null) {
<a name="l462"><span class="linenum"> 462</span></a>              <a class="var it809" onMouseOver="hilite(809)" onMouseOut="lolite()" onClick="logVariable('dh')" href="../../../../_variables/dh.html">$dh</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_DiffieHellman')" href="../../../../_classes/auth_openid_diffiehellman.html" onMouseOver="classPopup(event,'auth_openid_diffiehellman')">Auth_OpenID_DiffieHellman</a>();
<a name="l463"><span class="linenum"> 463</span></a>          }
<a name="l464"><span class="linenum"> 464</span></a>  
<a name="l465"><span class="linenum"> 465</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dh')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/dh.html">dh</a> = <a class="var it809" onMouseOver="hilite(809)" onMouseOut="lolite()" onClick="logVariable('dh')" href="../../../../_variables/dh.html">$dh</a>;
<a name="l466"><span class="linenum"> 466</span></a>      }
<a name="l467"><span class="linenum"> 467</span></a>  
<a name="l468"><span class="linenum"> 468</span></a>      function <a class="function" onClick="logFunction('getRequest')" href="../../../../_functions/getrequest.html" onMouseOver="funcPopup(event,'getrequest')">getRequest</a>()
<a name="l469"><span class="linenum"> 469</span></a>      {
<a name="l470"><span class="linenum"> 470</span></a>          <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('math')" href="../../../../_variables/math.html">$math</a> =&amp; <a class="function" onClick="logFunction('Auth_OpenID_getMathLib')" href="../../../../_functions/auth_openid_getmathlib.html" onMouseOver="funcPopup(event,'auth_openid_getmathlib')">Auth_OpenID_getMathLib</a>();
<a name="l471"><span class="linenum"> 471</span></a>  
<a name="l472"><span class="linenum"> 472</span></a>          <a class="var it811" onMouseOver="hilite(811)" onMouseOut="lolite()" onClick="logVariable('cpub')" href="../../../../_variables/cpub.html">$cpub</a> = <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('math')" href="../../../../_variables/math.html">$math</a>-&gt;<a class="function" onClick="logFunction('longToBase64')" href="../../../../_functions/longtobase64.html" onMouseOver="funcPopup(event,'longtobase64')">longToBase64</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dh')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/dh.html">dh</a>-&gt;public);
<a name="l473"><span class="linenum"> 473</span></a>  
<a name="l474"><span class="linenum"> 474</span></a>          <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a> = array('dh_consumer_public' =&gt; <a class="var it811" onMouseOver="hilite(811)" onMouseOut="lolite()" onClick="logVariable('cpub')" href="../../../../_variables/cpub.html">$cpub</a>);
<a name="l475"><span class="linenum"> 475</span></a>  
<a name="l476"><span class="linenum"> 476</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dh')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/dh.html">dh</a>-&gt;<a class="function" onClick="logFunction('usingDefaultValues')" href="../../../../_functions/usingdefaultvalues.html" onMouseOver="funcPopup(event,'usingdefaultvalues')">usingDefaultValues</a>()) {
<a name="l477"><span class="linenum"> 477</span></a>              <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a>, array(
<a name="l478"><span class="linenum"> 478</span></a>                  'dh_modulus' =&gt;
<a name="l479"><span class="linenum"> 479</span></a>                       <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('math')" href="../../../../_variables/math.html">$math</a>-&gt;<a class="function" onClick="logFunction('longToBase64')" href="../../../../_functions/longtobase64.html" onMouseOver="funcPopup(event,'longtobase64')">longToBase64</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dh')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/dh.html">dh</a>-&gt;mod),
<a name="l480"><span class="linenum"> 480</span></a>                  'dh_gen' =&gt;
<a name="l481"><span class="linenum"> 481</span></a>                       <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('math')" href="../../../../_variables/math.html">$math</a>-&gt;<a class="function" onClick="logFunction('longToBase64')" href="../../../../_functions/longtobase64.html" onMouseOver="funcPopup(event,'longtobase64')">longToBase64</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dh')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/dh.html">dh</a>-&gt;gen)));
<a name="l482"><span class="linenum"> 482</span></a>          }
<a name="l483"><span class="linenum"> 483</span></a>  
<a name="l484"><span class="linenum"> 484</span></a>          return <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a>;
<a name="l485"><span class="linenum"> 485</span></a>      }
<a name="l486"><span class="linenum"> 486</span></a>  
<a name="l487"><span class="linenum"> 487</span></a>      function <a class="function" onClick="logFunction('extractSecret')" href="../../../../_functions/extractsecret.html" onMouseOver="funcPopup(event,'extractsecret')">extractSecret</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>)
<a name="l488"><span class="linenum"> 488</span></a>      {
<a name="l489"><span class="linenum"> 489</span></a>          if (!<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a class="function" onClick="logFunction('hasKey')" href="../../../../_functions/haskey.html" onMouseOver="funcPopup(event,'haskey')">hasKey</a>(Auth_OpenID_OPENID_NS,
<a name="l490"><span class="linenum"> 490</span></a>                                 'dh_server_public')) {
<a name="l491"><span class="linenum"> 491</span></a>              return null;
<a name="l492"><span class="linenum"> 492</span></a>          }
<a name="l493"><span class="linenum"> 493</span></a>  
<a name="l494"><span class="linenum"> 494</span></a>          if (!<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a class="function" onClick="logFunction('hasKey')" href="../../../../_functions/haskey.html" onMouseOver="funcPopup(event,'haskey')">hasKey</a>(Auth_OpenID_OPENID_NS,
<a name="l495"><span class="linenum"> 495</span></a>                                 'enc_mac_key')) {
<a name="l496"><span class="linenum"> 496</span></a>              return null;
<a name="l497"><span class="linenum"> 497</span></a>          }
<a name="l498"><span class="linenum"> 498</span></a>  
<a name="l499"><span class="linenum"> 499</span></a>          <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('math')" href="../../../../_variables/math.html">$math</a> =&amp; <a class="function" onClick="logFunction('Auth_OpenID_getMathLib')" href="../../../../_functions/auth_openid_getmathlib.html" onMouseOver="funcPopup(event,'auth_openid_getmathlib')">Auth_OpenID_getMathLib</a>();
<a name="l500"><span class="linenum"> 500</span></a>  
<a name="l501"><span class="linenum"> 501</span></a>          <a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('spub')" href="../../../../_variables/spub.html">$spub</a> = <a class="var it810" onMouseOver="hilite(810)" onMouseOut="lolite()" onClick="logVariable('math')" href="../../../../_variables/math.html">$math</a>-&gt;<a class="function" onClick="logFunction('base64ToLong')" href="../../../../_functions/base64tolong.html" onMouseOver="funcPopup(event,'base64tolong')">base64ToLong</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS,
<a name="l502"><span class="linenum"> 502</span></a>                                                        'dh_server_public'));
<a name="l503"><span class="linenum"> 503</span></a>          <a class="var it813" onMouseOver="hilite(813)" onMouseOut="lolite()" onClick="logVariable('enc_mac_key')" href="../../../../_variables/enc_mac_key.html">$enc_mac_key</a> = <a class="phpfunction" onClick="logFunction('base64_decode')" href="../../../../_functions/base64_decode.html" onMouseOver="phpfuncPopup(event,'base64_decode')">base64_decode</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS,
<a name="l504"><span class="linenum"> 504</span></a>                                                         'enc_mac_key'));
<a name="l505"><span class="linenum"> 505</span></a>  
<a name="l506"><span class="linenum"> 506</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('dh')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/dh.html">dh</a>-&gt;<a class="function" onClick="logFunction('xorSecret')" href="../../../../_functions/xorsecret.html" onMouseOver="funcPopup(event,'xorsecret')">xorSecret</a>(<a class="var it812" onMouseOver="hilite(812)" onMouseOut="lolite()" onClick="logVariable('spub')" href="../../../../_variables/spub.html">$spub</a>, <a class="var it813" onMouseOver="hilite(813)" onMouseOut="lolite()" onClick="logVariable('enc_mac_key')" href="../../../../_variables/enc_mac_key.html">$enc_mac_key</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('hash_func')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/hash_func.html">hash_func</a>);
<a name="l507"><span class="linenum"> 507</span></a>      }
<a name="l508"><span class="linenum"> 508</span></a>  }
<a name="l509"><span class="linenum"> 509</span></a>  
<a name="l510"><span class="linenum"> 510</span></a>  <span class="comment">/**</span>
<a name="l511"><span class="linenum"> 511</span></a>  <span class="comment"> * A class implementing HMAC/DH-SHA256 consumer sessions.</span>
<a name="l512"><span class="linenum"> 512</span></a>  <span class="comment"> *</span>
<a name="l513"><span class="linenum"> 513</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l514"><span class="linenum"> 514</span></a>  <span class="comment"> */</span>
<a name="l515"><span class="linenum"> 515</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_DiffieHellmanSHA256ConsumerSession')" href="../../../../_classes/auth_openid_diffiehellmansha256consumersession.html" onMouseOver="classPopup(event,'auth_openid_diffiehellmansha256consumersession')">Auth_OpenID_DiffieHellmanSHA256ConsumerSession</a> extends
<a name="l516"><span class="linenum"> 516</span></a>        Auth_OpenID_DiffieHellmanSHA1ConsumerSession {
<a name="l517"><span class="linenum"> 517</span></a>      var <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> = 'DH-SHA256';
<a name="l518"><span class="linenum"> 518</span></a>      var <a class="var it806" onMouseOver="hilite(806)" onMouseOut="lolite()" onClick="logVariable('hash_func')" href="../../../../_variables/hash_func.html">$hash_func</a> = 'Auth_OpenID_SHA256';
<a name="l519"><span class="linenum"> 519</span></a>      var <a class="var it807" onMouseOver="hilite(807)" onMouseOut="lolite()" onClick="logVariable('secret_size')" href="../../../../_variables/secret_size.html">$secret_size</a> = 32;
<a name="l520"><span class="linenum"> 520</span></a>      var <a class="var it808" onMouseOver="hilite(808)" onMouseOut="lolite()" onClick="logVariable('allowed_assoc_types')" href="../../../../_variables/allowed_assoc_types.html">$allowed_assoc_types</a> = array('HMAC-SHA256');
<a name="l521"><span class="linenum"> 521</span></a>  }
<a name="l522"><span class="linenum"> 522</span></a>  
<a name="l523"><span class="linenum"> 523</span></a>  <span class="comment">/**</span>
<a name="l524"><span class="linenum"> 524</span></a>  <span class="comment"> * A class implementing plaintext consumer sessions.</span>
<a name="l525"><span class="linenum"> 525</span></a>  <span class="comment"> *</span>
<a name="l526"><span class="linenum"> 526</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l527"><span class="linenum"> 527</span></a>  <span class="comment"> */</span>
<a name="l528"><span class="linenum"> 528</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_PlainTextConsumerSession')" href="../../../../_classes/auth_openid_plaintextconsumersession.html" onMouseOver="classPopup(event,'auth_openid_plaintextconsumersession')">Auth_OpenID_PlainTextConsumerSession</a> {
<a name="l529"><span class="linenum"> 529</span></a>      var <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> = 'no-encryption';
<a name="l530"><span class="linenum"> 530</span></a>      var <a class="var it808" onMouseOver="hilite(808)" onMouseOut="lolite()" onClick="logVariable('allowed_assoc_types')" href="../../../../_variables/allowed_assoc_types.html">$allowed_assoc_types</a> =  array('HMAC-SHA1', 'HMAC-SHA256');
<a name="l531"><span class="linenum"> 531</span></a>  
<a name="l532"><span class="linenum"> 532</span></a>      function <a class="function" onClick="logFunction('getRequest')" href="../../../../_functions/getrequest.html" onMouseOver="funcPopup(event,'getrequest')">getRequest</a>()
<a name="l533"><span class="linenum"> 533</span></a>      {
<a name="l534"><span class="linenum"> 534</span></a>          return array();
<a name="l535"><span class="linenum"> 535</span></a>      }
<a name="l536"><span class="linenum"> 536</span></a>  
<a name="l537"><span class="linenum"> 537</span></a>      function <a class="function" onClick="logFunction('extractSecret')" href="../../../../_functions/extractsecret.html" onMouseOver="funcPopup(event,'extractsecret')">extractSecret</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>)
<a name="l538"><span class="linenum"> 538</span></a>      {
<a name="l539"><span class="linenum"> 539</span></a>          if (!<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a class="function" onClick="logFunction('hasKey')" href="../../../../_functions/haskey.html" onMouseOver="funcPopup(event,'haskey')">hasKey</a>(Auth_OpenID_OPENID_NS, 'mac_key')) {
<a name="l540"><span class="linenum"> 540</span></a>              return null;
<a name="l541"><span class="linenum"> 541</span></a>          }
<a name="l542"><span class="linenum"> 542</span></a>  
<a name="l543"><span class="linenum"> 543</span></a>          return <a class="phpfunction" onClick="logFunction('base64_decode')" href="../../../../_functions/base64_decode.html" onMouseOver="phpfuncPopup(event,'base64_decode')">base64_decode</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS,
<a name="l544"><span class="linenum"> 544</span></a>                                                 'mac_key'));
<a name="l545"><span class="linenum"> 545</span></a>      }
<a name="l546"><span class="linenum"> 546</span></a>  }
<a name="l547"><span class="linenum"> 547</span></a>  
<a name="l548"><span class="linenum"> 548</span></a>  <span class="comment">/**</span>
<a name="l549"><span class="linenum"> 549</span></a>  <span class="comment"> * Returns available session types.</span>
<a name="l550"><span class="linenum"> 550</span></a>  <span class="comment"> */</span>
<a name="l551"><span class="linenum"> 551</span></a>  function <a class="function" onClick="logFunction('Auth_OpenID_getAvailableSessionTypes')" href="../../../../_functions/auth_openid_getavailablesessiontypes.html" onMouseOver="funcPopup(event,'auth_openid_getavailablesessiontypes')">Auth_OpenID_getAvailableSessionTypes</a>()
<a name="l552"><span class="linenum"> 552</span></a>  {
<a name="l553"><span class="linenum"> 553</span></a>      <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('types')" href="../../../../_variables/types.html">$types</a> = array(
<a name="l554"><span class="linenum"> 554</span></a>        'no-encryption' =&gt; 'Auth_OpenID_PlainTextConsumerSession',
<a name="l555"><span class="linenum"> 555</span></a>        'DH-SHA1' =&gt; 'Auth_OpenID_DiffieHellmanSHA1ConsumerSession',
<a name="l556"><span class="linenum"> 556</span></a>        'DH-SHA256' =&gt; 'Auth_OpenID_DiffieHellmanSHA256ConsumerSession');
<a name="l557"><span class="linenum"> 557</span></a>  
<a name="l558"><span class="linenum"> 558</span></a>      return <a class="var it814" onMouseOver="hilite(814)" onMouseOut="lolite()" onClick="logVariable('types')" href="../../../../_variables/types.html">$types</a>;
<a name="l559"><span class="linenum"> 559</span></a>  }
<a name="l560"><span class="linenum"> 560</span></a>  
<a name="l561"><span class="linenum"> 561</span></a>  <span class="comment">/**</span>
<a name="l562"><span class="linenum"> 562</span></a>  <span class="comment"> * This class is the interface to the OpenID consumer logic.</span>
<a name="l563"><span class="linenum"> 563</span></a>  <span class="comment"> * Instances of it maintain no per-request state, so they can be</span>
<a name="l564"><span class="linenum"> 564</span></a>  <span class="comment"> * reused (or even used by multiple threads concurrently) as needed.</span>
<a name="l565"><span class="linenum"> 565</span></a>  <span class="comment"> *</span>
<a name="l566"><span class="linenum"> 566</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l567"><span class="linenum"> 567</span></a>  <span class="comment"> */</span>
<a name="l568"><span class="linenum"> 568</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_GenericConsumer')" href="../../../../_classes/auth_openid_genericconsumer.html" onMouseOver="classPopup(event,'auth_openid_genericconsumer')">Auth_OpenID_GenericConsumer</a> {
<a name="l569"><span class="linenum"> 569</span></a>      <span class="comment">/**</span>
<a name="l570"><span class="linenum"> 570</span></a>  <span class="comment">     * @access private</span>
<a name="l571"><span class="linenum"> 571</span></a>  <span class="comment">     */</span>
<a name="l572"><span class="linenum"> 572</span></a>      var <a class="var it786" onMouseOver="hilite(786)" onMouseOut="lolite()" onClick="logVariable('discoverMethod')" href="../../../../_variables/discoverMethod.html">$discoverMethod</a> = 'Auth_OpenID_discover';
<a name="l573"><span class="linenum"> 573</span></a>  
<a name="l574"><span class="linenum"> 574</span></a>      <span class="comment">/**</span>
<a name="l575"><span class="linenum"> 575</span></a>  <span class="comment">     * This consumer's store object.</span>
<a name="l576"><span class="linenum"> 576</span></a>  <span class="comment">     */</span>
<a name="l577"><span class="linenum"> 577</span></a>      var <a class="var it789" onMouseOver="hilite(789)" onMouseOut="lolite()" onClick="logVariable('store')" href="../../../../_variables/store.html">$store</a>;
<a name="l578"><span class="linenum"> 578</span></a>  
<a name="l579"><span class="linenum"> 579</span></a>      <span class="comment">/**</span>
<a name="l580"><span class="linenum"> 580</span></a>  <span class="comment">     * @access private</span>
<a name="l581"><span class="linenum"> 581</span></a>  <span class="comment">     */</span>
<a name="l582"><span class="linenum"> 582</span></a>      var <a class="var it815" onMouseOver="hilite(815)" onMouseOut="lolite()" onClick="logVariable('_use_assocs')" href="../../../../_variables/_use_assocs.html">$_use_assocs</a>;
<a name="l583"><span class="linenum"> 583</span></a>  
<a name="l584"><span class="linenum"> 584</span></a>      <span class="comment">/**</span>
<a name="l585"><span class="linenum"> 585</span></a>  <span class="comment">     * @access private</span>
<a name="l586"><span class="linenum"> 586</span></a>  <span class="comment">     */</span>
<a name="l587"><span class="linenum"> 587</span></a>      var <a class="var it816" onMouseOver="hilite(816)" onMouseOut="lolite()" onClick="logVariable('openid1_nonce_query_arg_name')" href="../../../../_variables/openid1_nonce_query_arg_name.html">$openid1_nonce_query_arg_name</a> = 'janrain_nonce';
<a name="l588"><span class="linenum"> 588</span></a>  
<a name="l589"><span class="linenum"> 589</span></a>      <span class="comment">/**</span>
<a name="l590"><span class="linenum"> 590</span></a>  <span class="comment">     * Another query parameter that gets added to the return_to for</span>
<a name="l591"><span class="linenum"> 591</span></a>  <span class="comment">     * OpenID 1; if the user's session state is lost, use this claimed</span>
<a name="l592"><span class="linenum"> 592</span></a>  <span class="comment">     * identifier to do discovery when verifying the response.</span>
<a name="l593"><span class="linenum"> 593</span></a>  <span class="comment">     */</span>
<a name="l594"><span class="linenum"> 594</span></a>      var <a class="var it817" onMouseOver="hilite(817)" onMouseOut="lolite()" onClick="logVariable('openid1_return_to_identifier_name')" href="../../../../_variables/openid1_return_to_identifier_name.html">$openid1_return_to_identifier_name</a> = 'openid1_claimed_id';
<a name="l595"><span class="linenum"> 595</span></a>  
<a name="l596"><span class="linenum"> 596</span></a>      <span class="comment">/**</span>
<a name="l597"><span class="linenum"> 597</span></a>  <span class="comment">     * This method initializes a new {@link Auth_OpenID_Consumer}</span>
<a name="l598"><span class="linenum"> 598</span></a>  <span class="comment">     * instance to access the library.</span>
<a name="l599"><span class="linenum"> 599</span></a>  <span class="comment">     *</span>
<a name="l600"><span class="linenum"> 600</span></a>  <span class="comment">     * @param Auth_OpenID_OpenIDStore $store This must be an object</span>
<a name="l601"><span class="linenum"> 601</span></a>  <span class="comment">     * that implements the interface in {@link Auth_OpenID_OpenIDStore}.</span>
<a name="l602"><span class="linenum"> 602</span></a>  <span class="comment">     * Several concrete implementations are provided, to cover most common use</span>
<a name="l603"><span class="linenum"> 603</span></a>  <span class="comment">     * cases.  For stores backed by MySQL, PostgreSQL, or SQLite, see</span>
<a name="l604"><span class="linenum"> 604</span></a>  <span class="comment">     * the {@link Auth_OpenID_SQLStore} class and its sublcasses.  For a</span>
<a name="l605"><span class="linenum"> 605</span></a>  <span class="comment">     * filesystem-backed store, see the {@link Auth_OpenID_FileStore} module.</span>
<a name="l606"><span class="linenum"> 606</span></a>  <span class="comment">     * As a last resort, if it isn't possible for the server to store</span>
<a name="l607"><span class="linenum"> 607</span></a>  <span class="comment">     * state at all, an instance of {@link Auth_OpenID_DumbStore} can be used.</span>
<a name="l608"><span class="linenum"> 608</span></a>  <span class="comment">     *</span>
<a name="l609"><span class="linenum"> 609</span></a>  <span class="comment">     * @param bool $immediate This is an optional boolean value.  It</span>
<a name="l610"><span class="linenum"> 610</span></a>  <span class="comment">     * controls whether the library uses immediate mode, as explained</span>
<a name="l611"><span class="linenum"> 611</span></a>  <span class="comment">     * in the module description.  The default value is False, which</span>
<a name="l612"><span class="linenum"> 612</span></a>  <span class="comment">     * disables immediate mode.</span>
<a name="l613"><span class="linenum"> 613</span></a>  <span class="comment">     */</span>
<a name="l614"><span class="linenum"> 614</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_GenericConsumer')" href="../../../../_functions/auth_openid_genericconsumer.html" onMouseOver="funcPopup(event,'auth_openid_genericconsumer')">Auth_OpenID_GenericConsumer</a>(&amp;<a class="var it789" onMouseOver="hilite(789)" onMouseOut="lolite()" onClick="logVariable('store')" href="../../../../_variables/store.html">$store</a>)
<a name="l615"><span class="linenum"> 615</span></a>      {
<a name="l616"><span class="linenum"> 616</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('store')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/store.html">store</a> =&amp; <a class="var it789" onMouseOver="hilite(789)" onMouseOut="lolite()" onClick="logVariable('store')" href="../../../../_variables/store.html">$store</a>;
<a name="l617"><span class="linenum"> 617</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('negotiator')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/negotiator.html">negotiator</a> =&amp; <a class="function" onClick="logFunction('Auth_OpenID_getDefaultNegotiator')" href="../../../../_functions/auth_openid_getdefaultnegotiator.html" onMouseOver="funcPopup(event,'auth_openid_getdefaultnegotiator')">Auth_OpenID_getDefaultNegotiator</a>();
<a name="l618"><span class="linenum"> 618</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_use_assocs')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_use_assocs.html">_use_assocs</a> = (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('store')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/store.html">store</a> ? true : false);
<a name="l619"><span class="linenum"> 619</span></a>  
<a name="l620"><span class="linenum"> 620</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fetcher')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/fetcher.html">fetcher</a> = <a class="class" onClick="logClass('Auth_Yadis_Yadis')" href="../../../../_classes/auth_yadis_yadis.html" onMouseOver="classPopup(event,'auth_yadis_yadis')">Auth_Yadis_Yadis</a>::<a class="function" onClick="logFunction('getHTTPFetcher')" href="../../../../_functions/gethttpfetcher.html" onMouseOver="funcPopup(event,'gethttpfetcher')">getHTTPFetcher</a>();
<a name="l621"><span class="linenum"> 621</span></a>  
<a name="l622"><span class="linenum"> 622</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session_types')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session_types.html">session_types</a> = <a class="function" onClick="logFunction('Auth_OpenID_getAvailableSessionTypes')" href="../../../../_functions/auth_openid_getavailablesessiontypes.html" onMouseOver="funcPopup(event,'auth_openid_getavailablesessiontypes')">Auth_OpenID_getAvailableSessionTypes</a>();
<a name="l623"><span class="linenum"> 623</span></a>      }
<a name="l624"><span class="linenum"> 624</span></a>  
<a name="l625"><span class="linenum"> 625</span></a>      <span class="comment">/**</span>
<a name="l626"><span class="linenum"> 626</span></a>  <span class="comment">     * Called to begin OpenID authentication using the specified</span>
<a name="l627"><span class="linenum"> 627</span></a>  <span class="comment">     * {@link Auth_OpenID_ServiceEndpoint}.</span>
<a name="l628"><span class="linenum"> 628</span></a>  <span class="comment">     *</span>
<a name="l629"><span class="linenum"> 629</span></a>  <span class="comment">     * @access private</span>
<a name="l630"><span class="linenum"> 630</span></a>  <span class="comment">     */</span>
<a name="l631"><span class="linenum"> 631</span></a>      function <a class="function" onClick="logFunction('begin')" href="../../../../_functions/begin.html" onMouseOver="funcPopup(event,'begin')">begin</a>(<a class="var it820" onMouseOver="hilite(820)" onMouseOut="lolite()" onClick="logVariable('service_endpoint')" href="../../../../_variables/service_endpoint.html">$service_endpoint</a>)
<a name="l632"><span class="linenum"> 632</span></a>      {
<a name="l633"><span class="linenum"> 633</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_getAssociation')" href="../../../../_functions/_getassociation.html" onMouseOver="funcPopup(event,'_getassociation')">_getAssociation</a>(<a class="var it820" onMouseOver="hilite(820)" onMouseOut="lolite()" onClick="logVariable('service_endpoint')" href="../../../../_variables/service_endpoint.html">$service_endpoint</a>);
<a name="l634"><span class="linenum"> 634</span></a>          <a class="var it821" onMouseOver="hilite(821)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_AuthRequest')" href="../../../../_classes/auth_openid_authrequest.html" onMouseOver="classPopup(event,'auth_openid_authrequest')">Auth_OpenID_AuthRequest</a>(<a class="var it820" onMouseOver="hilite(820)" onMouseOut="lolite()" onClick="logVariable('service_endpoint')" href="../../../../_variables/service_endpoint.html">$service_endpoint</a>, <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>);
<a name="l635"><span class="linenum"> 635</span></a>          <a class="var it821" onMouseOver="hilite(821)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a>-&gt;<a onClick="logVariable('return_to_args')" class="var it2307" onMouseOver="hilite(2307)" onMouseOut="lolite()" href="../../../../_variables/return_to_args.html">return_to_args</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('openid1_nonce_query_arg_name')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/openid1_nonce_query_arg_name.html">openid1_nonce_query_arg_name</a>] =
<a name="l636"><span class="linenum"> 636</span></a>              <a class="function" onClick="logFunction('Auth_OpenID_mkNonce')" href="../../../../_functions/auth_openid_mknonce.html" onMouseOver="funcPopup(event,'auth_openid_mknonce')">Auth_OpenID_mkNonce</a>();
<a name="l637"><span class="linenum"> 637</span></a>  
<a name="l638"><span class="linenum"> 638</span></a>          if (<a class="var it821" onMouseOver="hilite(821)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a>-&gt;<a onClick="logVariable('message')" class="var it2307" onMouseOver="hilite(2307)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>()) {
<a name="l639"><span class="linenum"> 639</span></a>              <a class="var it821" onMouseOver="hilite(821)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a>-&gt;<a onClick="logVariable('return_to_args')" class="var it2307" onMouseOver="hilite(2307)" onMouseOut="lolite()" href="../../../../_variables/return_to_args.html">return_to_args</a>[<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('openid1_return_to_identifier_name')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/openid1_return_to_identifier_name.html">openid1_return_to_identifier_name</a>] =
<a name="l640"><span class="linenum"> 640</span></a>                  <a class="var it821" onMouseOver="hilite(821)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2307" onMouseOver="hilite(2307)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a>-&gt;claimed_id;
<a name="l641"><span class="linenum"> 641</span></a>          }
<a name="l642"><span class="linenum"> 642</span></a>  
<a name="l643"><span class="linenum"> 643</span></a>          return <a class="var it821" onMouseOver="hilite(821)" onMouseOut="lolite()" onClick="logVariable('r')" href="../../../../_variables/r.html">$r</a>;
<a name="l644"><span class="linenum"> 644</span></a>      }
<a name="l645"><span class="linenum"> 645</span></a>  
<a name="l646"><span class="linenum"> 646</span></a>      <span class="comment">/**</span>
<a name="l647"><span class="linenum"> 647</span></a>  <span class="comment">     * Given an {@link Auth_OpenID_Message}, {@link</span>
<a name="l648"><span class="linenum"> 648</span></a>  <span class="comment">     * Auth_OpenID_ServiceEndpoint} and optional return_to URL,</span>
<a name="l649"><span class="linenum"> 649</span></a>  <span class="comment">     * complete OpenID authentication.</span>
<a name="l650"><span class="linenum"> 650</span></a>  <span class="comment">     *</span>
<a name="l651"><span class="linenum"> 651</span></a>  <span class="comment">     * @access private</span>
<a name="l652"><span class="linenum"> 652</span></a>  <span class="comment">     */</span>
<a name="l653"><span class="linenum"> 653</span></a>      function <a class="function" onClick="logFunction('complete')" href="../../../../_functions/complete.html" onMouseOver="funcPopup(event,'complete')">complete</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>)
<a name="l654"><span class="linenum"> 654</span></a>      {
<a name="l655"><span class="linenum"> 655</span></a>          <a class="var it824" onMouseOver="hilite(824)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'mode',
<a name="l656"><span class="linenum"> 656</span></a>                                   '&lt;no mode set&gt;');
<a name="l657"><span class="linenum"> 657</span></a>  
<a name="l658"><span class="linenum"> 658</span></a>          <a class="var it825" onMouseOver="hilite(825)" onMouseOut="lolite()" onClick="logVariable('mode_methods')" href="../../../../_variables/mode_methods.html">$mode_methods</a> = array(
<a name="l659"><span class="linenum"> 659</span></a>                                'cancel' =&gt; '_complete_cancel',
<a name="l660"><span class="linenum"> 660</span></a>                                'error' =&gt; '_complete_error',
<a name="l661"><span class="linenum"> 661</span></a>                                'setup_needed' =&gt; '_complete_setup_needed',
<a name="l662"><span class="linenum"> 662</span></a>                                'id_res' =&gt; '_complete_id_res',
<a name="l663"><span class="linenum"> 663</span></a>                                );
<a name="l664"><span class="linenum"> 664</span></a>  
<a name="l665"><span class="linenum"> 665</span></a>          <a class="var it271" onMouseOver="hilite(271)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../../../_variables/method.html">$method</a> = <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('arrayGet')" href="../../../../_functions/arrayget.html" onMouseOver="funcPopup(event,'arrayget')">arrayGet</a>(<a class="var it825" onMouseOver="hilite(825)" onMouseOut="lolite()" onClick="logVariable('mode_methods')" href="../../../../_variables/mode_methods.html">$mode_methods</a>, <a class="var it824" onMouseOver="hilite(824)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a>,
<a name="l666"><span class="linenum"> 666</span></a>                                          '_completeInvalid');
<a name="l667"><span class="linenum"> 667</span></a>  
<a name="l668"><span class="linenum"> 668</span></a>          return <a class="phpfunction" onClick="logFunction('call_user_func_array')" href="../../../../_functions/call_user_func_array.html" onMouseOver="phpfuncPopup(event,'call_user_func_array')">call_user_func_array</a>(array(&amp;<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>, <a class="var it271" onMouseOver="hilite(271)" onMouseOut="lolite()" onClick="logVariable('method')" href="../../../../_variables/method.html">$method</a>),
<a name="l669"><span class="linenum"> 669</span></a>                                      array(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>));
<a name="l670"><span class="linenum"> 670</span></a>      }
<a name="l671"><span class="linenum"> 671</span></a>  
<a name="l672"><span class="linenum"> 672</span></a>      <span class="comment">/**</span>
<a name="l673"><span class="linenum"> 673</span></a>  <span class="comment">     * @access private</span>
<a name="l674"><span class="linenum"> 674</span></a>  <span class="comment">     */</span>
<a name="l675"><span class="linenum"> 675</span></a>      function <a class="function" onClick="logFunction('_completeInvalid')" href="../../../../_functions/_completeinvalid.html" onMouseOver="funcPopup(event,'_completeinvalid')">_completeInvalid</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, &amp;<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it720" onMouseOver="hilite(720)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../../../_variables/unused.html">$unused</a>)
<a name="l676"><span class="linenum"> 676</span></a>      {
<a name="l677"><span class="linenum"> 677</span></a>          <a class="var it824" onMouseOver="hilite(824)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'mode',
<a name="l678"><span class="linenum"> 678</span></a>                                   '&lt;No mode set&gt;');
<a name="l679"><span class="linenum"> 679</span></a>  
<a name="l680"><span class="linenum"> 680</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l681"><span class="linenum"> 681</span></a>                      sprintf(&quot;Invalid openid.mode '%s'&quot;, <a class="var it824" onMouseOver="hilite(824)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a>));
<a name="l682"><span class="linenum"> 682</span></a>      }
<a name="l683"><span class="linenum"> 683</span></a>  
<a name="l684"><span class="linenum"> 684</span></a>      <span class="comment">/**</span>
<a name="l685"><span class="linenum"> 685</span></a>  <span class="comment">     * @access private</span>
<a name="l686"><span class="linenum"> 686</span></a>  <span class="comment">     */</span>
<a name="l687"><span class="linenum"> 687</span></a>      function <a class="function" onClick="logFunction('_complete_cancel')" href="../../../../_functions/_complete_cancel.html" onMouseOver="funcPopup(event,'_complete_cancel')">_complete_cancel</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, &amp;<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it720" onMouseOver="hilite(720)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../../../_variables/unused.html">$unused</a>)
<a name="l688"><span class="linenum"> 688</span></a>      {
<a name="l689"><span class="linenum"> 689</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_CancelResponse')" href="../../../../_classes/auth_openid_cancelresponse.html" onMouseOver="classPopup(event,'auth_openid_cancelresponse')">Auth_OpenID_CancelResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l690"><span class="linenum"> 690</span></a>      }
<a name="l691"><span class="linenum"> 691</span></a>  
<a name="l692"><span class="linenum"> 692</span></a>      <span class="comment">/**</span>
<a name="l693"><span class="linenum"> 693</span></a>  <span class="comment">     * @access private</span>
<a name="l694"><span class="linenum"> 694</span></a>  <span class="comment">     */</span>
<a name="l695"><span class="linenum"> 695</span></a>      function <a class="function" onClick="logFunction('_complete_error')" href="../../../../_functions/_complete_error.html" onMouseOver="funcPopup(event,'_complete_error')">_complete_error</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, &amp;<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it720" onMouseOver="hilite(720)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../../../_variables/unused.html">$unused</a>)
<a name="l696"><span class="linenum"> 696</span></a>      {
<a name="l697"><span class="linenum"> 697</span></a>          <a class="var it740" onMouseOver="hilite(740)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../../_variables/error.html">$error</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'error');
<a name="l698"><span class="linenum"> 698</span></a>          <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../../../../_variables/contact.html">$contact</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'contact');
<a name="l699"><span class="linenum"> 699</span></a>          <a class="var it827" onMouseOver="hilite(827)" onMouseOut="lolite()" onClick="logVariable('reference')" href="../../../../_variables/reference.html">$reference</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'reference');
<a name="l700"><span class="linenum"> 700</span></a>  
<a name="l701"><span class="linenum"> 701</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it740" onMouseOver="hilite(740)" onMouseOut="lolite()" onClick="logVariable('error')" href="../../../../_variables/error.html">$error</a>,
<a name="l702"><span class="linenum"> 702</span></a>                                                 <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../../../../_variables/contact.html">$contact</a>, <a class="var it827" onMouseOver="hilite(827)" onMouseOut="lolite()" onClick="logVariable('reference')" href="../../../../_variables/reference.html">$reference</a>);
<a name="l703"><span class="linenum"> 703</span></a>      }
<a name="l704"><span class="linenum"> 704</span></a>  
<a name="l705"><span class="linenum"> 705</span></a>      <span class="comment">/**</span>
<a name="l706"><span class="linenum"> 706</span></a>  <span class="comment">     * @access private</span>
<a name="l707"><span class="linenum"> 707</span></a>  <span class="comment">     */</span>
<a name="l708"><span class="linenum"> 708</span></a>      function <a class="function" onClick="logFunction('_complete_setup_needed')" href="../../../../_functions/_complete_setup_needed.html" onMouseOver="funcPopup(event,'_complete_setup_needed')">_complete_setup_needed</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, &amp;<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it720" onMouseOver="hilite(720)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../../../_variables/unused.html">$unused</a>)
<a name="l709"><span class="linenum"> 709</span></a>      {
<a name="l710"><span class="linenum"> 710</span></a>          if (!<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('isOpenID2')" href="../../../../_functions/isopenid2.html" onMouseOver="funcPopup(event,'isopenid2')">isOpenID2</a>()) {
<a name="l711"><span class="linenum"> 711</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_completeInvalid')" href="../../../../_functions/_completeinvalid.html" onMouseOver="funcPopup(event,'_completeinvalid')">_completeInvalid</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l712"><span class="linenum"> 712</span></a>          }
<a name="l713"><span class="linenum"> 713</span></a>  
<a name="l714"><span class="linenum"> 714</span></a>          <a class="var it828" onMouseOver="hilite(828)" onMouseOut="lolite()" onClick="logVariable('user_setup_url')" href="../../../../_variables/user_setup_url.html">$user_setup_url</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID2_NS,
<a name="l715"><span class="linenum"> 715</span></a>                                             'user_setup_url');
<a name="l716"><span class="linenum"> 716</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_SetupNeededResponse')" href="../../../../_classes/auth_openid_setupneededresponse.html" onMouseOver="classPopup(event,'auth_openid_setupneededresponse')">Auth_OpenID_SetupNeededResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it828" onMouseOver="hilite(828)" onMouseOut="lolite()" onClick="logVariable('user_setup_url')" href="../../../../_variables/user_setup_url.html">$user_setup_url</a>);
<a name="l717"><span class="linenum"> 717</span></a>      }
<a name="l718"><span class="linenum"> 718</span></a>  
<a name="l719"><span class="linenum"> 719</span></a>      <span class="comment">/**</span>
<a name="l720"><span class="linenum"> 720</span></a>  <span class="comment">     * @access private</span>
<a name="l721"><span class="linenum"> 721</span></a>  <span class="comment">     */</span>
<a name="l722"><span class="linenum"> 722</span></a>      function <a class="function" onClick="logFunction('_complete_id_res')" href="../../../../_functions/_complete_id_res.html" onMouseOver="funcPopup(event,'_complete_id_res')">_complete_id_res</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, &amp;<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>)
<a name="l723"><span class="linenum"> 723</span></a>      {
<a name="l724"><span class="linenum"> 724</span></a>          <a class="var it828" onMouseOver="hilite(828)" onMouseOut="lolite()" onClick="logVariable('user_setup_url')" href="../../../../_variables/user_setup_url.html">$user_setup_url</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID1_NS,
<a name="l725"><span class="linenum"> 725</span></a>                                             'user_setup_url');
<a name="l726"><span class="linenum"> 726</span></a>  
<a name="l727"><span class="linenum"> 727</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_checkSetupNeeded')" href="../../../../_functions/_checksetupneeded.html" onMouseOver="funcPopup(event,'_checksetupneeded')">_checkSetupNeeded</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>)) {
<a name="l728"><span class="linenum"> 728</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_SetupNeededResponse')" href="../../../../_classes/auth_openid_setupneededresponse.html" onMouseOver="classPopup(event,'auth_openid_setupneededresponse')">Auth_OpenID_SetupNeededResponse</a>(
<a name="l729"><span class="linenum"> 729</span></a>                  <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it828" onMouseOver="hilite(828)" onMouseOut="lolite()" onClick="logVariable('user_setup_url')" href="../../../../_variables/user_setup_url.html">$user_setup_url</a>);
<a name="l730"><span class="linenum"> 730</span></a>          } else {
<a name="l731"><span class="linenum"> 731</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_doIdRes')" href="../../../../_functions/_doidres.html" onMouseOver="funcPopup(event,'_doidres')">_doIdRes</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>);
<a name="l732"><span class="linenum"> 732</span></a>          }
<a name="l733"><span class="linenum"> 733</span></a>      }
<a name="l734"><span class="linenum"> 734</span></a>  
<a name="l735"><span class="linenum"> 735</span></a>      <span class="comment">/**</span>
<a name="l736"><span class="linenum"> 736</span></a>  <span class="comment">     * @access private</span>
<a name="l737"><span class="linenum"> 737</span></a>  <span class="comment">     */</span>
<a name="l738"><span class="linenum"> 738</span></a>      function <a class="function" onClick="logFunction('_checkSetupNeeded')" href="../../../../_functions/_checksetupneeded.html" onMouseOver="funcPopup(event,'_checksetupneeded')">_checkSetupNeeded</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>)
<a name="l739"><span class="linenum"> 739</span></a>      {
<a name="l740"><span class="linenum"> 740</span></a>  <span class="comment">        // In OpenID 1, we check to see if this is a cancel from</span>
<a name="l741"><span class="linenum"> 741</span></a>  <span class="comment">        // immediate mode by the presence of the user_setup_url</span>
<a name="l742"><span class="linenum"> 742</span></a>  <span class="comment">        // parameter.</span>
<a name="l743"><span class="linenum"> 743</span></a>          if (<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>()) {
<a name="l744"><span class="linenum"> 744</span></a>              <a class="var it828" onMouseOver="hilite(828)" onMouseOut="lolite()" onClick="logVariable('user_setup_url')" href="../../../../_variables/user_setup_url.html">$user_setup_url</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID1_NS,
<a name="l745"><span class="linenum"> 745</span></a>                                                 'user_setup_url');
<a name="l746"><span class="linenum"> 746</span></a>              if (<a class="var it828" onMouseOver="hilite(828)" onMouseOut="lolite()" onClick="logVariable('user_setup_url')" href="../../../../_variables/user_setup_url.html">$user_setup_url</a> !== null) {
<a name="l747"><span class="linenum"> 747</span></a>                  return true;
<a name="l748"><span class="linenum"> 748</span></a>              }
<a name="l749"><span class="linenum"> 749</span></a>          }
<a name="l750"><span class="linenum"> 750</span></a>  
<a name="l751"><span class="linenum"> 751</span></a>          return false;
<a name="l752"><span class="linenum"> 752</span></a>      }
<a name="l753"><span class="linenum"> 753</span></a>  
<a name="l754"><span class="linenum"> 754</span></a>      <span class="comment">/**</span>
<a name="l755"><span class="linenum"> 755</span></a>  <span class="comment">     * @access private</span>
<a name="l756"><span class="linenum"> 756</span></a>  <span class="comment">     */</span>
<a name="l757"><span class="linenum"> 757</span></a>      function <a class="function" onClick="logFunction('_doIdRes')" href="../../../../_functions/_doidres.html" onMouseOver="funcPopup(event,'_doidres')">_doIdRes</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>)
<a name="l758"><span class="linenum"> 758</span></a>      {
<a name="l759"><span class="linenum"> 759</span></a>  <span class="comment">        // Checks for presence of appropriate fields (and checks</span>
<a name="l760"><span class="linenum"> 760</span></a>  <span class="comment">        // signed list fields)</span>
<a name="l761"><span class="linenum"> 761</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_idResCheckForFields')" href="../../../../_functions/_idrescheckforfields.html" onMouseOver="funcPopup(event,'_idrescheckforfields')">_idResCheckForFields</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>);
<a name="l762"><span class="linenum"> 762</span></a>  
<a name="l763"><span class="linenum"> 763</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>)) {
<a name="l764"><span class="linenum"> 764</span></a>              return <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>;
<a name="l765"><span class="linenum"> 765</span></a>          }
<a name="l766"><span class="linenum"> 766</span></a>  
<a name="l767"><span class="linenum"> 767</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_checkReturnTo')" href="../../../../_functions/_checkreturnto.html" onMouseOver="funcPopup(event,'_checkreturnto')">_checkReturnTo</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>)) {
<a name="l768"><span class="linenum"> 768</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l769"><span class="linenum"> 769</span></a>              sprintf(&quot;return_to does not match return URL. Expected %s, got %s&quot;,
<a name="l770"><span class="linenum"> 770</span></a>                      <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>,
<a name="l771"><span class="linenum"> 771</span></a>                      <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'return_to')));
<a name="l772"><span class="linenum"> 772</span></a>          }
<a name="l773"><span class="linenum"> 773</span></a>  
<a name="l774"><span class="linenum"> 774</span></a>  <span class="comment">        // Verify discovery information:</span>
<a name="l775"><span class="linenum"> 775</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_verifyDiscoveryResults')" href="../../../../_functions/_verifydiscoveryresults.html" onMouseOver="funcPopup(event,'_verifydiscoveryresults')">_verifyDiscoveryResults</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l776"><span class="linenum"> 776</span></a>  
<a name="l777"><span class="linenum"> 777</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>)) {
<a name="l778"><span class="linenum"> 778</span></a>              return <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>;
<a name="l779"><span class="linenum"> 779</span></a>          }
<a name="l780"><span class="linenum"> 780</span></a>  
<a name="l781"><span class="linenum"> 781</span></a>          <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a> = <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>;
<a name="l782"><span class="linenum"> 782</span></a>  
<a name="l783"><span class="linenum"> 783</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_idResCheckSignature')" href="../../../../_functions/_idreschecksignature.html" onMouseOver="funcPopup(event,'_idreschecksignature')">_idResCheckSignature</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>,
<a name="l784"><span class="linenum"> 784</span></a>                                                <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('server_url')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a>);
<a name="l785"><span class="linenum"> 785</span></a>  
<a name="l786"><span class="linenum"> 786</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>)) {
<a name="l787"><span class="linenum"> 787</span></a>              return <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>;
<a name="l788"><span class="linenum"> 788</span></a>          }
<a name="l789"><span class="linenum"> 789</span></a>  
<a name="l790"><span class="linenum"> 790</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_idResCheckNonce')" href="../../../../_functions/_idreschecknonce.html" onMouseOver="funcPopup(event,'_idreschecknonce')">_idResCheckNonce</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l791"><span class="linenum"> 791</span></a>  
<a name="l792"><span class="linenum"> 792</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>)) {
<a name="l793"><span class="linenum"> 793</span></a>              return <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>;
<a name="l794"><span class="linenum"> 794</span></a>          }
<a name="l795"><span class="linenum"> 795</span></a>  
<a name="l796"><span class="linenum"> 796</span></a>          <a class="var it829" onMouseOver="hilite(829)" onMouseOut="lolite()" onClick="logVariable('signed_list_str')" href="../../../../_variables/signed_list_str.html">$signed_list_str</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'signed',
<a name="l797"><span class="linenum"> 797</span></a>                                              Auth_OpenID_NO_DEFAULT);
<a name="l798"><span class="linenum"> 798</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it829" onMouseOver="hilite(829)" onMouseOut="lolite()" onClick="logVariable('signed_list_str')" href="../../../../_variables/signed_list_str.html">$signed_list_str</a>)) {
<a name="l799"><span class="linenum"> 799</span></a>              return <a class="var it829" onMouseOver="hilite(829)" onMouseOut="lolite()" onClick="logVariable('signed_list_str')" href="../../../../_variables/signed_list_str.html">$signed_list_str</a>;
<a name="l800"><span class="linenum"> 800</span></a>          }
<a name="l801"><span class="linenum"> 801</span></a>          <a class="var it830" onMouseOver="hilite(830)" onMouseOut="lolite()" onClick="logVariable('signed_list')" href="../../../../_variables/signed_list.html">$signed_list</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it829" onMouseOver="hilite(829)" onMouseOut="lolite()" onClick="logVariable('signed_list_str')" href="../../../../_variables/signed_list_str.html">$signed_list_str</a>);
<a name="l802"><span class="linenum"> 802</span></a>  
<a name="l803"><span class="linenum"> 803</span></a>          <a class="var it831" onMouseOver="hilite(831)" onMouseOut="lolite()" onClick="logVariable('signed_fields')" href="../../../../_variables/signed_fields.html">$signed_fields</a> = <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('addPrefix')" href="../../../../_functions/addprefix.html" onMouseOver="funcPopup(event,'addprefix')">addPrefix</a>(<a class="var it830" onMouseOver="hilite(830)" onMouseOut="lolite()" onClick="logVariable('signed_list')" href="../../../../_variables/signed_list.html">$signed_list</a>, &quot;openid.&quot;);
<a name="l804"><span class="linenum"> 804</span></a>  
<a name="l805"><span class="linenum"> 805</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_SuccessResponse')" href="../../../../_classes/auth_openid_successresponse.html" onMouseOver="classPopup(event,'auth_openid_successresponse')">Auth_OpenID_SuccessResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>,
<a name="l806"><span class="linenum"> 806</span></a>                                                 <a class="var it831" onMouseOver="hilite(831)" onMouseOut="lolite()" onClick="logVariable('signed_fields')" href="../../../../_variables/signed_fields.html">$signed_fields</a>);
<a name="l807"><span class="linenum"> 807</span></a>  
<a name="l808"><span class="linenum"> 808</span></a>      }
<a name="l809"><span class="linenum"> 809</span></a>  
<a name="l810"><span class="linenum"> 810</span></a>      <span class="comment">/**</span>
<a name="l811"><span class="linenum"> 811</span></a>  <span class="comment">     * @access private</span>
<a name="l812"><span class="linenum"> 812</span></a>  <span class="comment">     */</span>
<a name="l813"><span class="linenum"> 813</span></a>      function <a class="function" onClick="logFunction('_checkReturnTo')" href="../../../../_functions/_checkreturnto.html" onMouseOver="funcPopup(event,'_checkreturnto')">_checkReturnTo</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>)
<a name="l814"><span class="linenum"> 814</span></a>      {
<a name="l815"><span class="linenum"> 815</span></a>  <span class="comment">        // Check an OpenID message and its openid.return_to value</span>
<a name="l816"><span class="linenum"> 816</span></a>  <span class="comment">        // against a return_to URL from an application.  Return True</span>
<a name="l817"><span class="linenum"> 817</span></a>  <span class="comment">        // on success, False on failure.</span>
<a name="l818"><span class="linenum"> 818</span></a>  
<a name="l819"><span class="linenum"> 819</span></a>  <span class="comment">        // Check the openid.return_to args against args in the</span>
<a name="l820"><span class="linenum"> 820</span></a>  <span class="comment">        // original message.</span>
<a name="l821"><span class="linenum"> 821</span></a>          <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = <a class="class" onClick="logClass('Auth_OpenID_GenericConsumer')" href="../../../../_classes/auth_openid_genericconsumer.html" onMouseOver="classPopup(event,'auth_openid_genericconsumer')">Auth_OpenID_GenericConsumer</a>::<a class="function" onClick="logFunction('_verifyReturnToArgs')" href="../../../../_functions/_verifyreturntoargs.html" onMouseOver="funcPopup(event,'_verifyreturntoargs')">_verifyReturnToArgs</a>(
<a name="l822"><span class="linenum"> 822</span></a>                                             <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('toPostArgs')" href="../../../../_functions/topostargs.html" onMouseOver="funcPopup(event,'topostargs')">toPostArgs</a>());
<a name="l823"><span class="linenum"> 823</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>)) {
<a name="l824"><span class="linenum"> 824</span></a>              return false;
<a name="l825"><span class="linenum"> 825</span></a>          }
<a name="l826"><span class="linenum"> 826</span></a>  
<a name="l827"><span class="linenum"> 827</span></a>  <span class="comment">        // Check the return_to base URL against the one in the</span>
<a name="l828"><span class="linenum"> 828</span></a>  <span class="comment">        // message.</span>
<a name="l829"><span class="linenum"> 829</span></a>          <a class="var it832" onMouseOver="hilite(832)" onMouseOut="lolite()" onClick="logVariable('msg_return_to')" href="../../../../_variables/msg_return_to.html">$msg_return_to</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS,
<a name="l830"><span class="linenum"> 830</span></a>                                            'return_to');
<a name="l831"><span class="linenum"> 831</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>)) {
<a name="l832"><span class="linenum"> 832</span></a>  <span class="comment">            // XXX log me</span>
<a name="l833"><span class="linenum"> 833</span></a>              return false;
<a name="l834"><span class="linenum"> 834</span></a>          }
<a name="l835"><span class="linenum"> 835</span></a>  
<a name="l836"><span class="linenum"> 836</span></a>          <a class="var it833" onMouseOver="hilite(833)" onMouseOut="lolite()" onClick="logVariable('return_to_parts')" href="../../../../_variables/return_to_parts.html">$return_to_parts</a> = <a class="phpfunction" onClick="logFunction('parse_url')" href="../../../../_functions/parse_url.html" onMouseOver="phpfuncPopup(event,'parse_url')">parse_url</a>(<a class="function" onClick="logFunction('Auth_OpenID_urinorm')" href="../../../../_functions/auth_openid_urinorm.html" onMouseOver="funcPopup(event,'auth_openid_urinorm')">Auth_OpenID_urinorm</a>(<a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>));
<a name="l837"><span class="linenum"> 837</span></a>          <a class="var it834" onMouseOver="hilite(834)" onMouseOut="lolite()" onClick="logVariable('msg_return_to_parts')" href="../../../../_variables/msg_return_to_parts.html">$msg_return_to_parts</a> = <a class="phpfunction" onClick="logFunction('parse_url')" href="../../../../_functions/parse_url.html" onMouseOver="phpfuncPopup(event,'parse_url')">parse_url</a>(<a class="function" onClick="logFunction('Auth_OpenID_urinorm')" href="../../../../_functions/auth_openid_urinorm.html" onMouseOver="funcPopup(event,'auth_openid_urinorm')">Auth_OpenID_urinorm</a>(<a class="var it832" onMouseOver="hilite(832)" onMouseOut="lolite()" onClick="logVariable('msg_return_to')" href="../../../../_variables/msg_return_to.html">$msg_return_to</a>));
<a name="l838"><span class="linenum"> 838</span></a>  
<a name="l839"><span class="linenum"> 839</span></a>  <span class="comment">        // If port is absent from both, add it so it's equal in the</span>
<a name="l840"><span class="linenum"> 840</span></a>  <span class="comment">        // check below.</span>
<a name="l841"><span class="linenum"> 841</span></a>          if ((!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>('port', <a class="var it833" onMouseOver="hilite(833)" onMouseOut="lolite()" onClick="logVariable('return_to_parts')" href="../../../../_variables/return_to_parts.html">$return_to_parts</a>)) &amp;&amp;
<a name="l842"><span class="linenum"> 842</span></a>              (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>('port', <a class="var it834" onMouseOver="hilite(834)" onMouseOut="lolite()" onClick="logVariable('msg_return_to_parts')" href="../../../../_variables/msg_return_to_parts.html">$msg_return_to_parts</a>))) {
<a name="l843"><span class="linenum"> 843</span></a>              <a class="var it833" onMouseOver="hilite(833)" onMouseOut="lolite()" onClick="logVariable('return_to_parts')" href="../../../../_variables/return_to_parts.html">$return_to_parts</a>['port'] = null;
<a name="l844"><span class="linenum"> 844</span></a>              <a class="var it834" onMouseOver="hilite(834)" onMouseOut="lolite()" onClick="logVariable('msg_return_to_parts')" href="../../../../_variables/msg_return_to_parts.html">$msg_return_to_parts</a>['port'] = null;
<a name="l845"><span class="linenum"> 845</span></a>          }
<a name="l846"><span class="linenum"> 846</span></a>  
<a name="l847"><span class="linenum"> 847</span></a>  <span class="comment">        // If path is absent from both, add it so it's equal in the</span>
<a name="l848"><span class="linenum"> 848</span></a>  <span class="comment">        // check below.</span>
<a name="l849"><span class="linenum"> 849</span></a>          if ((!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>('path', <a class="var it833" onMouseOver="hilite(833)" onMouseOut="lolite()" onClick="logVariable('return_to_parts')" href="../../../../_variables/return_to_parts.html">$return_to_parts</a>)) &amp;&amp;
<a name="l850"><span class="linenum"> 850</span></a>              (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>('path', <a class="var it834" onMouseOver="hilite(834)" onMouseOut="lolite()" onClick="logVariable('msg_return_to_parts')" href="../../../../_variables/msg_return_to_parts.html">$msg_return_to_parts</a>))) {
<a name="l851"><span class="linenum"> 851</span></a>              <a class="var it833" onMouseOver="hilite(833)" onMouseOut="lolite()" onClick="logVariable('return_to_parts')" href="../../../../_variables/return_to_parts.html">$return_to_parts</a>['path'] = null;
<a name="l852"><span class="linenum"> 852</span></a>              <a class="var it834" onMouseOver="hilite(834)" onMouseOut="lolite()" onClick="logVariable('msg_return_to_parts')" href="../../../../_variables/msg_return_to_parts.html">$msg_return_to_parts</a>['path'] = null;
<a name="l853"><span class="linenum"> 853</span></a>          }
<a name="l854"><span class="linenum"> 854</span></a>  
<a name="l855"><span class="linenum"> 855</span></a>  <span class="comment">        // The URL scheme, authority, and path MUST be the same</span>
<a name="l856"><span class="linenum"> 856</span></a>  <span class="comment">        // between the two URLs.</span>
<a name="l857"><span class="linenum"> 857</span></a>          foreach (array('scheme', 'host', 'port', 'path') as <a class="var it835" onMouseOver="hilite(835)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../../../_variables/component.html">$component</a>) {
<a name="l858"><span class="linenum"> 858</span></a>  <span class="comment">            // If the url component is absent in either URL, fail.</span>
<a name="l859"><span class="linenum"> 859</span></a>  <span class="comment">            // There should always be a scheme, host, port, and path.</span>
<a name="l860"><span class="linenum"> 860</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it835" onMouseOver="hilite(835)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../../../_variables/component.html">$component</a>, <a class="var it833" onMouseOver="hilite(833)" onMouseOut="lolite()" onClick="logVariable('return_to_parts')" href="../../../../_variables/return_to_parts.html">$return_to_parts</a>)) {
<a name="l861"><span class="linenum"> 861</span></a>                  return false;
<a name="l862"><span class="linenum"> 862</span></a>              }
<a name="l863"><span class="linenum"> 863</span></a>  
<a name="l864"><span class="linenum"> 864</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it835" onMouseOver="hilite(835)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../../../_variables/component.html">$component</a>, <a class="var it834" onMouseOver="hilite(834)" onMouseOut="lolite()" onClick="logVariable('msg_return_to_parts')" href="../../../../_variables/msg_return_to_parts.html">$msg_return_to_parts</a>)) {
<a name="l865"><span class="linenum"> 865</span></a>                  return false;
<a name="l866"><span class="linenum"> 866</span></a>              }
<a name="l867"><span class="linenum"> 867</span></a>  
<a name="l868"><span class="linenum"> 868</span></a>              if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('arrayGet')" href="../../../../_functions/arrayget.html" onMouseOver="funcPopup(event,'arrayget')">arrayGet</a>(<a class="var it833" onMouseOver="hilite(833)" onMouseOut="lolite()" onClick="logVariable('return_to_parts')" href="../../../../_variables/return_to_parts.html">$return_to_parts</a>, <a class="var it835" onMouseOver="hilite(835)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../../../_variables/component.html">$component</a>) !==
<a name="l869"><span class="linenum"> 869</span></a>                  <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('arrayGet')" href="../../../../_functions/arrayget.html" onMouseOver="funcPopup(event,'arrayget')">arrayGet</a>(<a class="var it834" onMouseOver="hilite(834)" onMouseOut="lolite()" onClick="logVariable('msg_return_to_parts')" href="../../../../_variables/msg_return_to_parts.html">$msg_return_to_parts</a>, <a class="var it835" onMouseOver="hilite(835)" onMouseOut="lolite()" onClick="logVariable('component')" href="../../../../_variables/component.html">$component</a>)) {
<a name="l870"><span class="linenum"> 870</span></a>                  return false;
<a name="l871"><span class="linenum"> 871</span></a>              }
<a name="l872"><span class="linenum"> 872</span></a>          }
<a name="l873"><span class="linenum"> 873</span></a>  
<a name="l874"><span class="linenum"> 874</span></a>          return true;
<a name="l875"><span class="linenum"> 875</span></a>      }
<a name="l876"><span class="linenum"> 876</span></a>  
<a name="l877"><span class="linenum"> 877</span></a>      <span class="comment">/**</span>
<a name="l878"><span class="linenum"> 878</span></a>  <span class="comment">     * @access private</span>
<a name="l879"><span class="linenum"> 879</span></a>  <span class="comment">     */</span>
<a name="l880"><span class="linenum"> 880</span></a>      function <a class="function" onClick="logFunction('_verifyReturnToArgs')" href="../../../../_functions/_verifyreturntoargs.html" onMouseOver="funcPopup(event,'_verifyreturntoargs')">_verifyReturnToArgs</a>(<a class="var it465" onMouseOver="hilite(465)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../../_variables/query.html">$query</a>)
<a name="l881"><span class="linenum"> 881</span></a>      {
<a name="l882"><span class="linenum"> 882</span></a>  <span class="comment">        // Verify that the arguments in the return_to URL are present in this</span>
<a name="l883"><span class="linenum"> 883</span></a>  <span class="comment">        // response.</span>
<a name="l884"><span class="linenum"> 884</span></a>  
<a name="l885"><span class="linenum"> 885</span></a>          <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a> = <a class="class" onClick="logClass('Auth_OpenID_Message')" href="../../../../_classes/auth_openid_message.html" onMouseOver="classPopup(event,'auth_openid_message')">Auth_OpenID_Message</a>::<a class="function" onClick="logFunction('fromPostArgs')" href="../../../../_functions/frompostargs.html" onMouseOver="funcPopup(event,'frompostargs')">fromPostArgs</a>(<a class="var it465" onMouseOver="hilite(465)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../../_variables/query.html">$query</a>);
<a name="l886"><span class="linenum"> 886</span></a>          <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'return_to');
<a name="l887"><span class="linenum"> 887</span></a>  
<a name="l888"><span class="linenum"> 888</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>)) {
<a name="l889"><span class="linenum"> 889</span></a>              return <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>;
<a name="l890"><span class="linenum"> 890</span></a>          }
<a name="l891"><span class="linenum"> 891</span></a>  <span class="comment">        // XXX: this should be checked by _idResCheckForFields</span>
<a name="l892"><span class="linenum"> 892</span></a>          if (!<a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>) {
<a name="l893"><span class="linenum"> 893</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l894"><span class="linenum"> 894</span></a>                             &quot;Response has no return_to&quot;);
<a name="l895"><span class="linenum"> 895</span></a>          }
<a name="l896"><span class="linenum"> 896</span></a>  
<a name="l897"><span class="linenum"> 897</span></a>          <a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('parsed_url')" href="../../../../_variables/parsed_url.html">$parsed_url</a> = <a class="phpfunction" onClick="logFunction('parse_url')" href="../../../../_functions/parse_url.html" onMouseOver="phpfuncPopup(event,'parse_url')">parse_url</a>(<a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>);
<a name="l898"><span class="linenum"> 898</span></a>  
<a name="l899"><span class="linenum"> 899</span></a>          <a class="var it837" onMouseOver="hilite(837)" onMouseOut="lolite()" onClick="logVariable('q')" href="../../../../_variables/q.html">$q</a> = array();
<a name="l900"><span class="linenum"> 900</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>('query', <a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('parsed_url')" href="../../../../_variables/parsed_url.html">$parsed_url</a>)) {
<a name="l901"><span class="linenum"> 901</span></a>              <a class="var it838" onMouseOver="hilite(838)" onMouseOut="lolite()" onClick="logVariable('rt_query')" href="../../../../_variables/rt_query.html">$rt_query</a> = <a class="var it836" onMouseOver="hilite(836)" onMouseOut="lolite()" onClick="logVariable('parsed_url')" href="../../../../_variables/parsed_url.html">$parsed_url</a>['query'];
<a name="l902"><span class="linenum"> 902</span></a>              <a class="var it837" onMouseOver="hilite(837)" onMouseOut="lolite()" onClick="logVariable('q')" href="../../../../_variables/q.html">$q</a> = <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="phpfunction" onClick="logFunction('parse_str')" href="../../../../_functions/parse_str.html" onMouseOver="phpfuncPopup(event,'parse_str')">parse_str</a>(<a class="var it838" onMouseOver="hilite(838)" onMouseOut="lolite()" onClick="logVariable('rt_query')" href="../../../../_variables/rt_query.html">$rt_query</a>);
<a name="l903"><span class="linenum"> 903</span></a>          }
<a name="l904"><span class="linenum"> 904</span></a>  
<a name="l905"><span class="linenum"> 905</span></a>          foreach (<a class="var it837" onMouseOver="hilite(837)" onMouseOut="lolite()" onClick="logVariable('q')" href="../../../../_variables/q.html">$q</a> as <a class="var it839" onMouseOver="hilite(839)" onMouseOut="lolite()" onClick="logVariable('rt_key')" href="../../../../_variables/rt_key.html">$rt_key</a> =&gt; <a class="var it840" onMouseOver="hilite(840)" onMouseOut="lolite()" onClick="logVariable('rt_value')" href="../../../../_variables/rt_value.html">$rt_value</a>) {
<a name="l906"><span class="linenum"> 906</span></a>              if (!<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it839" onMouseOver="hilite(839)" onMouseOut="lolite()" onClick="logVariable('rt_key')" href="../../../../_variables/rt_key.html">$rt_key</a>, <a class="var it465" onMouseOver="hilite(465)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../../_variables/query.html">$query</a>)) {
<a name="l907"><span class="linenum"> 907</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l908"><span class="linenum"> 908</span></a>                    sprintf(&quot;return_to parameter %s absent from query&quot;, <a class="var it839" onMouseOver="hilite(839)" onMouseOut="lolite()" onClick="logVariable('rt_key')" href="../../../../_variables/rt_key.html">$rt_key</a>));
<a name="l909"><span class="linenum"> 909</span></a>              } else {
<a name="l910"><span class="linenum"> 910</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a> = <a class="var it465" onMouseOver="hilite(465)" onMouseOut="lolite()" onClick="logVariable('query')" href="../../../../_variables/query.html">$query</a>[<a class="var it839" onMouseOver="hilite(839)" onMouseOut="lolite()" onClick="logVariable('rt_key')" href="../../../../_variables/rt_key.html">$rt_key</a>];
<a name="l911"><span class="linenum"> 911</span></a>                  if (<a class="var it840" onMouseOver="hilite(840)" onMouseOut="lolite()" onClick="logVariable('rt_value')" href="../../../../_variables/rt_value.html">$rt_value</a> != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>) {
<a name="l912"><span class="linenum"> 912</span></a>                      return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l913"><span class="linenum"> 913</span></a>                        sprintf(&quot;parameter %s value %s does not match &quot; .
<a name="l914"><span class="linenum"> 914</span></a>                                &quot;return_to value %s&quot;, <a class="var it839" onMouseOver="hilite(839)" onMouseOut="lolite()" onClick="logVariable('rt_key')" href="../../../../_variables/rt_key.html">$rt_key</a>,
<a name="l915"><span class="linenum"> 915</span></a>                                <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>, <a class="var it840" onMouseOver="hilite(840)" onMouseOut="lolite()" onClick="logVariable('rt_value')" href="../../../../_variables/rt_value.html">$rt_value</a>));
<a name="l916"><span class="linenum"> 916</span></a>                  }
<a name="l917"><span class="linenum"> 917</span></a>              }
<a name="l918"><span class="linenum"> 918</span></a>          }
<a name="l919"><span class="linenum"> 919</span></a>  
<a name="l920"><span class="linenum"> 920</span></a>  <span class="comment">        // Make sure all non-OpenID arguments in the response are also</span>
<a name="l921"><span class="linenum"> 921</span></a>  <span class="comment">        // in the signed return_to.</span>
<a name="l922"><span class="linenum"> 922</span></a>          <a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('bare_args')" href="../../../../_variables/bare_args.html">$bare_args</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArgs')" href="../../../../_functions/getargs.html" onMouseOver="funcPopup(event,'getargs')">getArgs</a>(Auth_OpenID_BARE_NS);
<a name="l923"><span class="linenum"> 923</span></a>          foreach (<a class="var it841" onMouseOver="hilite(841)" onMouseOut="lolite()" onClick="logVariable('bare_args')" href="../../../../_variables/bare_args.html">$bare_args</a> as <a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a> =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>) {
<a name="l924"><span class="linenum"> 924</span></a>              if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('arrayGet')" href="../../../../_functions/arrayget.html" onMouseOver="funcPopup(event,'arrayget')">arrayGet</a>(<a class="var it837" onMouseOver="hilite(837)" onMouseOut="lolite()" onClick="logVariable('q')" href="../../../../_variables/q.html">$q</a>, <a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>) != <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>) {
<a name="l925"><span class="linenum"> 925</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l926"><span class="linenum"> 926</span></a>                    sprintf(&quot;Parameter %s = %s not in return_to URL&quot;,
<a name="l927"><span class="linenum"> 927</span></a>                            <a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>));
<a name="l928"><span class="linenum"> 928</span></a>              }
<a name="l929"><span class="linenum"> 929</span></a>          }
<a name="l930"><span class="linenum"> 930</span></a>  
<a name="l931"><span class="linenum"> 931</span></a>          return true;
<a name="l932"><span class="linenum"> 932</span></a>      }
<a name="l933"><span class="linenum"> 933</span></a>  
<a name="l934"><span class="linenum"> 934</span></a>      <span class="comment">/**</span>
<a name="l935"><span class="linenum"> 935</span></a>  <span class="comment">     * @access private</span>
<a name="l936"><span class="linenum"> 936</span></a>  <span class="comment">     */</span>
<a name="l937"><span class="linenum"> 937</span></a>      function <a class="function" onClick="logFunction('_idResCheckSignature')" href="../../../../_functions/_idreschecksignature.html" onMouseOver="funcPopup(event,'_idreschecksignature')">_idResCheckSignature</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>)
<a name="l938"><span class="linenum"> 938</span></a>      {
<a name="l939"><span class="linenum"> 939</span></a>          <a class="var it842" onMouseOver="hilite(842)" onMouseOut="lolite()" onClick="logVariable('assoc_handle')" href="../../../../_variables/assoc_handle.html">$assoc_handle</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS,
<a name="l940"><span class="linenum"> 940</span></a>                                           'assoc_handle');
<a name="l941"><span class="linenum"> 941</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it842" onMouseOver="hilite(842)" onMouseOut="lolite()" onClick="logVariable('assoc_handle')" href="../../../../_variables/assoc_handle.html">$assoc_handle</a>)) {
<a name="l942"><span class="linenum"> 942</span></a>              return <a class="var it842" onMouseOver="hilite(842)" onMouseOut="lolite()" onClick="logVariable('assoc_handle')" href="../../../../_variables/assoc_handle.html">$assoc_handle</a>;
<a name="l943"><span class="linenum"> 943</span></a>          }
<a name="l944"><span class="linenum"> 944</span></a>  
<a name="l945"><span class="linenum"> 945</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('store')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/store.html">store</a>-&gt;<a class="function" onClick="logFunction('getAssociation')" href="../../../../_functions/getassociation.html" onMouseOver="funcPopup(event,'getassociation')">getAssociation</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it842" onMouseOver="hilite(842)" onMouseOut="lolite()" onClick="logVariable('assoc_handle')" href="../../../../_variables/assoc_handle.html">$assoc_handle</a>);
<a name="l946"><span class="linenum"> 946</span></a>  
<a name="l947"><span class="linenum"> 947</span></a>          if (<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>) {
<a name="l948"><span class="linenum"> 948</span></a>              if (<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>-&gt;<a class="function" onClick="logFunction('getExpiresIn')" href="../../../../_functions/getexpiresin.html" onMouseOver="funcPopup(event,'getexpiresin')">getExpiresIn</a>() &lt;= 0) {
<a name="l949"><span class="linenum"> 949</span></a>  <span class="comment">                // XXX: It might be a good idea sometimes to re-start</span>
<a name="l950"><span class="linenum"> 950</span></a>  <span class="comment">                // the authentication with a new association. Doing it</span>
<a name="l951"><span class="linenum"> 951</span></a>  <span class="comment">                // automatically opens the possibility for</span>
<a name="l952"><span class="linenum"> 952</span></a>  <span class="comment">                // denial-of-service by a server that just returns</span>
<a name="l953"><span class="linenum"> 953</span></a>  <span class="comment">                // expired associations (or really short-lived</span>
<a name="l954"><span class="linenum"> 954</span></a>  <span class="comment">                // associations)</span>
<a name="l955"><span class="linenum"> 955</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l956"><span class="linenum"> 956</span></a>                               'Association with ' . <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a> . ' expired');
<a name="l957"><span class="linenum"> 957</span></a>              }
<a name="l958"><span class="linenum"> 958</span></a>  
<a name="l959"><span class="linenum"> 959</span></a>              if (!<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>-&gt;<a class="function" onClick="logFunction('checkMessageSignature')" href="../../../../_functions/checkmessagesignature.html" onMouseOver="funcPopup(event,'checkmessagesignature')">checkMessageSignature</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>)) {
<a name="l960"><span class="linenum"> 960</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l961"><span class="linenum"> 961</span></a>                                                         &quot;Bad signature&quot;);
<a name="l962"><span class="linenum"> 962</span></a>              }
<a name="l963"><span class="linenum"> 963</span></a>          } else {
<a name="l964"><span class="linenum"> 964</span></a>  <span class="comment">            // It's not an association we know about.  Stateless mode</span>
<a name="l965"><span class="linenum"> 965</span></a>  <span class="comment">            // is our only possible path for recovery.  XXX - async</span>
<a name="l966"><span class="linenum"> 966</span></a>  <span class="comment">            // framework will not want to block on this call to</span>
<a name="l967"><span class="linenum"> 967</span></a>  <span class="comment">            // _checkAuth.</span>
<a name="l968"><span class="linenum"> 968</span></a>              if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_checkAuth')" href="../../../../_functions/_checkauth.html" onMouseOver="funcPopup(event,'_checkauth')">_checkAuth</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>)) {
<a name="l969"><span class="linenum"> 969</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l970"><span class="linenum"> 970</span></a>                               &quot;Server denied check_authentication&quot;);
<a name="l971"><span class="linenum"> 971</span></a>              }
<a name="l972"><span class="linenum"> 972</span></a>          }
<a name="l973"><span class="linenum"> 973</span></a>  
<a name="l974"><span class="linenum"> 974</span></a>          return null;
<a name="l975"><span class="linenum"> 975</span></a>      }
<a name="l976"><span class="linenum"> 976</span></a>  
<a name="l977"><span class="linenum"> 977</span></a>      <span class="comment">/**</span>
<a name="l978"><span class="linenum"> 978</span></a>  <span class="comment">     * @access private</span>
<a name="l979"><span class="linenum"> 979</span></a>  <span class="comment">     */</span>
<a name="l980"><span class="linenum"> 980</span></a>      function <a class="function" onClick="logFunction('_verifyDiscoveryResults')" href="../../../../_functions/_verifydiscoveryresults.html" onMouseOver="funcPopup(event,'_verifydiscoveryresults')">_verifyDiscoveryResults</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>=null)
<a name="l981"><span class="linenum"> 981</span></a>      {
<a name="l982"><span class="linenum"> 982</span></a>          if (<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getOpenIDNamespace')" href="../../../../_functions/getopenidnamespace.html" onMouseOver="funcPopup(event,'getopenidnamespace')">getOpenIDNamespace</a>() == Auth_OpenID_OPENID2_NS) {
<a name="l983"><span class="linenum"> 983</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_verifyDiscoveryResultsOpenID2')" href="../../../../_functions/_verifydiscoveryresultsopenid2.html" onMouseOver="funcPopup(event,'_verifydiscoveryresultsopenid2')">_verifyDiscoveryResultsOpenID2</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>,
<a name="l984"><span class="linenum"> 984</span></a>                                                           <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l985"><span class="linenum"> 985</span></a>          } else {
<a name="l986"><span class="linenum"> 986</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_verifyDiscoveryResultsOpenID1')" href="../../../../_functions/_verifydiscoveryresultsopenid1.html" onMouseOver="funcPopup(event,'_verifydiscoveryresultsopenid1')">_verifyDiscoveryResultsOpenID1</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>,
<a name="l987"><span class="linenum"> 987</span></a>                                                           <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l988"><span class="linenum"> 988</span></a>          }
<a name="l989"><span class="linenum"> 989</span></a>      }
<a name="l990"><span class="linenum"> 990</span></a>  
<a name="l991"><span class="linenum"> 991</span></a>      <span class="comment">/**</span>
<a name="l992"><span class="linenum"> 992</span></a>  <span class="comment">     * @access private</span>
<a name="l993"><span class="linenum"> 993</span></a>  <span class="comment">     */</span>
<a name="l994"><span class="linenum"> 994</span></a>      function <a class="function" onClick="logFunction('_verifyDiscoveryResultsOpenID1')" href="../../../../_functions/_verifydiscoveryresultsopenid1.html" onMouseOver="funcPopup(event,'_verifydiscoveryresultsopenid1')">_verifyDiscoveryResultsOpenID1</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>)
<a name="l995"><span class="linenum"> 995</span></a>      {
<a name="l996"><span class="linenum"> 996</span></a>          <a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_BARE_NS,
<a name="l997"><span class="linenum"> 997</span></a>                                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('openid1_return_to_identifier_name')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/openid1_return_to_identifier_name.html">openid1_return_to_identifier_name</a>);
<a name="l998"><span class="linenum"> 998</span></a>  
<a name="l999"><span class="linenum"> 999</span></a>          if ((<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a> === null) &amp;&amp; (<a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a> === null)) {
<a name="l1000"><span class="linenum">1000</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1001"><span class="linenum">1001</span></a>                'When using OpenID 1, the claimed ID must be supplied, ' .
<a name="l1002"><span class="linenum">1002</span></a>                'either by passing it through as a return_to parameter ' .
<a name="l1003"><span class="linenum">1003</span></a>                'or by using a session, and supplied to the GenericConsumer ' .
<a name="l1004"><span class="linenum">1004</span></a>                'as the argument to <a class="function" onClick="logFunction('complete')" href="../../../../_functions/complete.html" onMouseOver="funcPopup(event,'complete')">complete</a>()');
<a name="l1005"><span class="linenum">1005</span></a>          } else if ((<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a> !== null) &amp;&amp; (<a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a> === null)) {
<a name="l1006"><span class="linenum">1006</span></a>              <a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a> = <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>;
<a name="l1007"><span class="linenum">1007</span></a>          }
<a name="l1008"><span class="linenum">1008</span></a>  
<a name="l1009"><span class="linenum">1009</span></a>          <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_ServiceEndpoint')" href="../../../../_classes/auth_openid_serviceendpoint.html" onMouseOver="classPopup(event,'auth_openid_serviceendpoint')">Auth_OpenID_ServiceEndpoint</a>();
<a name="l1010"><span class="linenum">1010</span></a>          <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('type_uris')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/type_uris.html">type_uris</a> = array(Auth_OpenID_TYPE_1_1);
<a name="l1011"><span class="linenum">1011</span></a>          <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('local_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/local_id.html">local_id</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID1_NS,
<a name="l1012"><span class="linenum">1012</span></a>                                                 'identity');
<a name="l1013"><span class="linenum">1013</span></a>  
<a name="l1014"><span class="linenum">1014</span></a>  <span class="comment">        // Restore delegate information from the initiation phase</span>
<a name="l1015"><span class="linenum">1015</span></a>          <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a> = <a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a>;
<a name="l1016"><span class="linenum">1016</span></a>  
<a name="l1017"><span class="linenum">1017</span></a>          if (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('local_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/local_id.html">local_id</a> === null) {
<a name="l1018"><span class="linenum">1018</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1019"><span class="linenum">1019</span></a>                           &quot;Missing required field openid.identity&quot;);
<a name="l1020"><span class="linenum">1020</span></a>          }
<a name="l1021"><span class="linenum">1021</span></a>  
<a name="l1022"><span class="linenum">1022</span></a>          <a class="var it846" onMouseOver="hilite(846)" onMouseOut="lolite()" onClick="logVariable('to_match_1_0')" href="../../../../_variables/to_match_1_0.html">$to_match_1_0</a> = <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a class="phpfunction" onClick="logFunction('copy')" href="../../../../_functions/copy.html" onMouseOver="phpfuncPopup(event,'copy')">copy</a>();
<a name="l1023"><span class="linenum">1023</span></a>          <a class="var it846" onMouseOver="hilite(846)" onMouseOut="lolite()" onClick="logVariable('to_match_1_0')" href="../../../../_variables/to_match_1_0.html">$to_match_1_0</a>-&gt;<a onClick="logVariable('type_uris')" class="var it2310" onMouseOver="hilite(2310)" onMouseOut="lolite()" href="../../../../_variables/type_uris.html">type_uris</a> = array(Auth_OpenID_TYPE_1_0);
<a name="l1024"><span class="linenum">1024</span></a>  
<a name="l1025"><span class="linenum">1025</span></a>          if (<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a> !== null) {
<a name="l1026"><span class="linenum">1026</span></a>              <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_verifyDiscoverySingle')" href="../../../../_functions/_verifydiscoverysingle.html" onMouseOver="funcPopup(event,'_verifydiscoverysingle')">_verifyDiscoverySingle</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>);
<a name="l1027"><span class="linenum">1027</span></a>  
<a name="l1028"><span class="linenum">1028</span></a>              if (<a class="phpfunction" onClick="logFunction('is_a')" href="../../../../_functions/is_a.html" onMouseOver="phpfuncPopup(event,'is_a')">is_a</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>, 'Auth_OpenID_TypeURIMismatch')) {
<a name="l1029"><span class="linenum">1029</span></a>                  <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_verifyDiscoverySingle')" href="../../../../_functions/_verifydiscoverysingle.html" onMouseOver="funcPopup(event,'_verifydiscoverysingle')">_verifyDiscoverySingle</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1030"><span class="linenum">1030</span></a>                                                          <a class="var it846" onMouseOver="hilite(846)" onMouseOut="lolite()" onClick="logVariable('to_match_1_0')" href="../../../../_variables/to_match_1_0.html">$to_match_1_0</a>);
<a name="l1031"><span class="linenum">1031</span></a>              }
<a name="l1032"><span class="linenum">1032</span></a>  
<a name="l1033"><span class="linenum">1033</span></a>              if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>)) {
<a name="l1034"><span class="linenum">1034</span></a>  <span class="comment">                // oidutil.log(&quot;Error attempting to use stored</span>
<a name="l1035"><span class="linenum">1035</span></a>  <span class="comment">                //             discovery information: &quot; + str(e))</span>
<a name="l1036"><span class="linenum">1036</span></a>  <span class="comment">                //             oidutil.log(&quot;Attempting discovery to</span>
<a name="l1037"><span class="linenum">1037</span></a>  <span class="comment">                //             verify endpoint&quot;)</span>
<a name="l1038"><span class="linenum">1038</span></a>              } else {
<a name="l1039"><span class="linenum">1039</span></a>                  return <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>;
<a name="l1040"><span class="linenum">1040</span></a>              }
<a name="l1041"><span class="linenum">1041</span></a>          }
<a name="l1042"><span class="linenum">1042</span></a>  
<a name="l1043"><span class="linenum">1043</span></a>  <span class="comment">        // Endpoint is either bad (failed verification) or None</span>
<a name="l1044"><span class="linenum">1044</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_discoverAndVerify')" href="../../../../_functions/_discoverandverify.html" onMouseOver="funcPopup(event,'_discoverandverify')">_discoverAndVerify</a>(<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>,
<a name="l1045"><span class="linenum">1045</span></a>                                           array(<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>, <a class="var it846" onMouseOver="hilite(846)" onMouseOut="lolite()" onClick="logVariable('to_match_1_0')" href="../../../../_variables/to_match_1_0.html">$to_match_1_0</a>));
<a name="l1046"><span class="linenum">1046</span></a>      }
<a name="l1047"><span class="linenum">1047</span></a>  
<a name="l1048"><span class="linenum">1048</span></a>      <span class="comment">/**</span>
<a name="l1049"><span class="linenum">1049</span></a>  <span class="comment">     * @access private</span>
<a name="l1050"><span class="linenum">1050</span></a>  <span class="comment">     */</span>
<a name="l1051"><span class="linenum">1051</span></a>      function <a class="function" onClick="logFunction('_verifyDiscoverySingle')" href="../../../../_functions/_verifydiscoverysingle.html" onMouseOver="funcPopup(event,'_verifydiscoverysingle')">_verifyDiscoverySingle</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>)
<a name="l1052"><span class="linenum">1052</span></a>      {
<a name="l1053"><span class="linenum">1053</span></a>  <span class="comment">        // Every type URI that's in the to_match endpoint has to be</span>
<a name="l1054"><span class="linenum">1054</span></a>  <span class="comment">        // present in the discovered endpoint.</span>
<a name="l1055"><span class="linenum">1055</span></a>          foreach (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('type_uris')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/type_uris.html">type_uris</a> as <a class="var it847" onMouseOver="hilite(847)" onMouseOut="lolite()" onClick="logVariable('type_uri')" href="../../../../_variables/type_uri.html">$type_uri</a>) {
<a name="l1056"><span class="linenum">1056</span></a>              if (!<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a class="function" onClick="logFunction('usesExtension')" href="../../../../_functions/usesextension.html" onMouseOver="funcPopup(event,'usesextension')">usesExtension</a>(<a class="var it847" onMouseOver="hilite(847)" onMouseOut="lolite()" onClick="logVariable('type_uri')" href="../../../../_variables/type_uri.html">$type_uri</a>)) {
<a name="l1057"><span class="linenum">1057</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_TypeURIMismatch')" href="../../../../_classes/auth_openid_typeurimismatch.html" onMouseOver="classPopup(event,'auth_openid_typeurimismatch')">Auth_OpenID_TypeURIMismatch</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1058"><span class="linenum">1058</span></a>                               &quot;Required type &quot;.<a class="var it847" onMouseOver="hilite(847)" onMouseOut="lolite()" onClick="logVariable('type_uri')" href="../../../../_variables/type_uri.html">$type_uri</a>.&quot; not present&quot;);
<a name="l1059"><span class="linenum">1059</span></a>              }
<a name="l1060"><span class="linenum">1060</span></a>          }
<a name="l1061"><span class="linenum">1061</span></a>  
<a name="l1062"><span class="linenum">1062</span></a>  <span class="comment">        // Fragments do not influence discovery, so we can't compare a</span>
<a name="l1063"><span class="linenum">1063</span></a>  <span class="comment">        // claimed identifier with a fragment to discovered</span>
<a name="l1064"><span class="linenum">1064</span></a>  <span class="comment">        // information.</span>
<a name="l1065"><span class="linenum">1065</span></a>          list(<a class="var it848" onMouseOver="hilite(848)" onMouseOut="lolite()" onClick="logVariable('defragged_claimed_id')" href="../../../../_variables/defragged_claimed_id.html">$defragged_claimed_id</a>, <a class="var it849" onMouseOver="hilite(849)" onMouseOut="lolite()" onClick="logVariable('_')" href="../../../../_variables/_.html">$_</a>) =
<a name="l1066"><span class="linenum">1066</span></a>              <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('urldefrag')" href="../../../../_functions/urldefrag.html" onMouseOver="funcPopup(event,'urldefrag')">urldefrag</a>(<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>);
<a name="l1067"><span class="linenum">1067</span></a>  
<a name="l1068"><span class="linenum">1068</span></a>          if (<a class="var it848" onMouseOver="hilite(848)" onMouseOut="lolite()" onClick="logVariable('defragged_claimed_id')" href="../../../../_variables/defragged_claimed_id.html">$defragged_claimed_id</a> != <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>) {
<a name="l1069"><span class="linenum">1069</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1070"><span class="linenum">1070</span></a>                sprintf('Claimed ID does not <a class="function" onClick="logFunction('match')" href="../../../../_functions/match.html" onMouseOver="funcPopup(event,'match')">match</a> (different subjects!), ' .
<a name="l1071"><span class="linenum">1071</span></a>                        'Expected %s, got %s', <a class="var it848" onMouseOver="hilite(848)" onMouseOut="lolite()" onClick="logVariable('defragged_claimed_id')" href="../../../../_variables/defragged_claimed_id.html">$defragged_claimed_id</a>,
<a name="l1072"><span class="linenum">1072</span></a>                        <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>));
<a name="l1073"><span class="linenum">1073</span></a>          }
<a name="l1074"><span class="linenum">1074</span></a>  
<a name="l1075"><span class="linenum">1075</span></a>          if (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a class="function" onClick="logFunction('getLocalID')" href="../../../../_functions/getlocalid.html" onMouseOver="funcPopup(event,'getlocalid')">getLocalID</a>() != <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a class="function" onClick="logFunction('getLocalID')" href="../../../../_functions/getlocalid.html" onMouseOver="funcPopup(event,'getlocalid')">getLocalID</a>()) {
<a name="l1076"><span class="linenum">1076</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1077"><span class="linenum">1077</span></a>                sprintf('local_id mismatch. Expected %s, got %s',
<a name="l1078"><span class="linenum">1078</span></a>                        <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a class="function" onClick="logFunction('getLocalID')" href="../../../../_functions/getlocalid.html" onMouseOver="funcPopup(event,'getlocalid')">getLocalID</a>(), <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a class="function" onClick="logFunction('getLocalID')" href="../../../../_functions/getlocalid.html" onMouseOver="funcPopup(event,'getlocalid')">getLocalID</a>()));
<a name="l1079"><span class="linenum">1079</span></a>          }
<a name="l1080"><span class="linenum">1080</span></a>  
<a name="l1081"><span class="linenum">1081</span></a>  <span class="comment">        // If the server URL is None, this must be an OpenID 1</span>
<a name="l1082"><span class="linenum">1082</span></a>  <span class="comment">        // response, because op_endpoint is a required parameter in</span>
<a name="l1083"><span class="linenum">1083</span></a>  <span class="comment">        // OpenID 2. In that case, we don't actually care what the</span>
<a name="l1084"><span class="linenum">1084</span></a>  <span class="comment">        // discovered server_url is, because signature checking or</span>
<a name="l1085"><span class="linenum">1085</span></a>  <span class="comment">        // check_auth should take care of that check for us.</span>
<a name="l1086"><span class="linenum">1086</span></a>          if (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('server_url')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a> === null) {
<a name="l1087"><span class="linenum">1087</span></a>              if (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a class="function" onClick="logFunction('preferredNamespace')" href="../../../../_functions/preferrednamespace.html" onMouseOver="funcPopup(event,'preferrednamespace')">preferredNamespace</a>() != Auth_OpenID_OPENID1_NS) {
<a name="l1088"><span class="linenum">1088</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1089"><span class="linenum">1089</span></a>                               &quot;Preferred namespace mismatch (bug)&quot;);
<a name="l1090"><span class="linenum">1090</span></a>              }
<a name="l1091"><span class="linenum">1091</span></a>          } else if (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('server_url')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a> != <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('server_url')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a>) {
<a name="l1092"><span class="linenum">1092</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1093"><span class="linenum">1093</span></a>                sprintf('OP Endpoint mismatch. Expected %s, got %s',
<a name="l1094"><span class="linenum">1094</span></a>                        <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('server_url')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('server_url')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a>));
<a name="l1095"><span class="linenum">1095</span></a>          }
<a name="l1096"><span class="linenum">1096</span></a>  
<a name="l1097"><span class="linenum">1097</span></a>          return null;
<a name="l1098"><span class="linenum">1098</span></a>      }
<a name="l1099"><span class="linenum">1099</span></a>  
<a name="l1100"><span class="linenum">1100</span></a>      <span class="comment">/**</span>
<a name="l1101"><span class="linenum">1101</span></a>  <span class="comment">     * @access private</span>
<a name="l1102"><span class="linenum">1102</span></a>  <span class="comment">     */</span>
<a name="l1103"><span class="linenum">1103</span></a>      function <a class="function" onClick="logFunction('_verifyDiscoveryResultsOpenID2')" href="../../../../_functions/_verifydiscoveryresultsopenid2.html" onMouseOver="funcPopup(event,'_verifydiscoveryresultsopenid2')">_verifyDiscoveryResultsOpenID2</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>)
<a name="l1104"><span class="linenum">1104</span></a>      {
<a name="l1105"><span class="linenum">1105</span></a>          <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_ServiceEndpoint')" href="../../../../_classes/auth_openid_serviceendpoint.html" onMouseOver="classPopup(event,'auth_openid_serviceendpoint')">Auth_OpenID_ServiceEndpoint</a>();
<a name="l1106"><span class="linenum">1106</span></a>          <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('type_uris')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/type_uris.html">type_uris</a> = array(Auth_OpenID_TYPE_2_0);
<a name="l1107"><span class="linenum">1107</span></a>          <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID2_NS,
<a name="l1108"><span class="linenum">1108</span></a>                                                   'claimed_id');
<a name="l1109"><span class="linenum">1109</span></a>  
<a name="l1110"><span class="linenum">1110</span></a>          <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('local_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/local_id.html">local_id</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID2_NS,
<a name="l1111"><span class="linenum">1111</span></a>                                                  'identity');
<a name="l1112"><span class="linenum">1112</span></a>  
<a name="l1113"><span class="linenum">1113</span></a>          <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('server_url')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID2_NS,
<a name="l1114"><span class="linenum">1114</span></a>                                                   'op_endpoint');
<a name="l1115"><span class="linenum">1115</span></a>  
<a name="l1116"><span class="linenum">1116</span></a>          if (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('server_url')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a> === null) {
<a name="l1117"><span class="linenum">1117</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1118"><span class="linenum">1118</span></a>                           &quot;OP Endpoint URL missing&quot;);
<a name="l1119"><span class="linenum">1119</span></a>          }
<a name="l1120"><span class="linenum">1120</span></a>  
<a name="l1121"><span class="linenum">1121</span></a>  <span class="comment">        // claimed_id and identifier must both be present or both be</span>
<a name="l1122"><span class="linenum">1122</span></a>  <span class="comment">        // absent</span>
<a name="l1123"><span class="linenum">1123</span></a>          if ((<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a> === null) &amp;&amp;
<a name="l1124"><span class="linenum">1124</span></a>              (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('local_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/local_id.html">local_id</a> !== null)) {
<a name="l1125"><span class="linenum">1125</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1126"><span class="linenum">1126</span></a>                'openid.identity is present without openid.claimed_id');
<a name="l1127"><span class="linenum">1127</span></a>          }
<a name="l1128"><span class="linenum">1128</span></a>  
<a name="l1129"><span class="linenum">1129</span></a>          if ((<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a> !== null) &amp;&amp;
<a name="l1130"><span class="linenum">1130</span></a>              (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('local_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/local_id.html">local_id</a> === null)) {
<a name="l1131"><span class="linenum">1131</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1132"><span class="linenum">1132</span></a>                'openid.claimed_id is present without openid.identity');
<a name="l1133"><span class="linenum">1133</span></a>          }
<a name="l1134"><span class="linenum">1134</span></a>  
<a name="l1135"><span class="linenum">1135</span></a>          if (<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a> === null) {
<a name="l1136"><span class="linenum">1136</span></a>  <span class="comment">            // This is a response without identifiers, so there's</span>
<a name="l1137"><span class="linenum">1137</span></a>  <span class="comment">            // really no checking that we can do, so return an</span>
<a name="l1138"><span class="linenum">1138</span></a>  <span class="comment">            // endpoint that's for the specified `openid.op_endpoint'</span>
<a name="l1139"><span class="linenum">1139</span></a>              return <a class="class" onClick="logClass('Auth_OpenID_ServiceEndpoint')" href="../../../../_classes/auth_openid_serviceendpoint.html" onMouseOver="classPopup(event,'auth_openid_serviceendpoint')">Auth_OpenID_ServiceEndpoint</a>::<a class="function" onClick="logFunction('fromOPEndpointURL')" href="../../../../_functions/fromopendpointurl.html" onMouseOver="funcPopup(event,'fromopendpointurl')">fromOPEndpointURL</a>(
<a name="l1140"><span class="linenum">1140</span></a>                                                  <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('server_url')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a>);
<a name="l1141"><span class="linenum">1141</span></a>          }
<a name="l1142"><span class="linenum">1142</span></a>  
<a name="l1143"><span class="linenum">1143</span></a>          if (!<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>) {
<a name="l1144"><span class="linenum">1144</span></a>  <span class="comment">            // The claimed ID doesn't match, so we have to do</span>
<a name="l1145"><span class="linenum">1145</span></a>  <span class="comment">            // discovery again. This covers not using sessions, OP</span>
<a name="l1146"><span class="linenum">1146</span></a>  <span class="comment">            // identifier endpoints and responses that didn't match</span>
<a name="l1147"><span class="linenum">1147</span></a>  <span class="comment">            // the original request.</span>
<a name="l1148"><span class="linenum">1148</span></a>  <span class="comment">            // oidutil.log('No pre-discovered information supplied.')</span>
<a name="l1149"><span class="linenum">1149</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_discoverAndVerify')" href="../../../../_functions/_discoverandverify.html" onMouseOver="funcPopup(event,'_discoverandverify')">_discoverAndVerify</a>(<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>,
<a name="l1150"><span class="linenum">1150</span></a>                                               array(<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>));
<a name="l1151"><span class="linenum">1151</span></a>          } else {
<a name="l1152"><span class="linenum">1152</span></a>  
<a name="l1153"><span class="linenum">1153</span></a>  <span class="comment">            // The claimed ID matches, so we use the endpoint that we</span>
<a name="l1154"><span class="linenum">1154</span></a>  <span class="comment">            // discovered in initiation. This should be the most</span>
<a name="l1155"><span class="linenum">1155</span></a>  <span class="comment">            // common case.</span>
<a name="l1156"><span class="linenum">1156</span></a>              <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_verifyDiscoverySingle')" href="../../../../_functions/_verifydiscoverysingle.html" onMouseOver="funcPopup(event,'_verifydiscoverysingle')">_verifyDiscoverySingle</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>);
<a name="l1157"><span class="linenum">1157</span></a>  
<a name="l1158"><span class="linenum">1158</span></a>              if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>)) {
<a name="l1159"><span class="linenum">1159</span></a>                  <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_discoverAndVerify')" href="../../../../_functions/_discoverandverify.html" onMouseOver="funcPopup(event,'_discoverandverify')">_discoverAndVerify</a>(<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>,
<a name="l1160"><span class="linenum">1160</span></a>                                                        array(<a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>));
<a name="l1161"><span class="linenum">1161</span></a>                  if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>)) {
<a name="l1162"><span class="linenum">1162</span></a>                      return <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>;
<a name="l1163"><span class="linenum">1163</span></a>                  }
<a name="l1164"><span class="linenum">1164</span></a>              }
<a name="l1165"><span class="linenum">1165</span></a>          }
<a name="l1166"><span class="linenum">1166</span></a>  
<a name="l1167"><span class="linenum">1167</span></a>  <span class="comment">        // The endpoint we return should have the claimed ID from the</span>
<a name="l1168"><span class="linenum">1168</span></a>  <span class="comment">        // message we just verified, fragment and all.</span>
<a name="l1169"><span class="linenum">1169</span></a>          if (<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a> != <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>) {
<a name="l1170"><span class="linenum">1170</span></a>              <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a> = <a class="var it844" onMouseOver="hilite(844)" onMouseOut="lolite()" onClick="logVariable('to_match')" href="../../../../_variables/to_match.html">$to_match</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2309" onMouseOver="hilite(2309)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>;
<a name="l1171"><span class="linenum">1171</span></a>          }
<a name="l1172"><span class="linenum">1172</span></a>  
<a name="l1173"><span class="linenum">1173</span></a>          return <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>;
<a name="l1174"><span class="linenum">1174</span></a>      }
<a name="l1175"><span class="linenum">1175</span></a>  
<a name="l1176"><span class="linenum">1176</span></a>      <span class="comment">/**</span>
<a name="l1177"><span class="linenum">1177</span></a>  <span class="comment">     * @access private</span>
<a name="l1178"><span class="linenum">1178</span></a>  <span class="comment">     */</span>
<a name="l1179"><span class="linenum">1179</span></a>      function <a class="function" onClick="logFunction('_discoverAndVerify')" href="../../../../_functions/_discoverandverify.html" onMouseOver="funcPopup(event,'_discoverandverify')">_discoverAndVerify</a>(<a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a>, <a class="var it850" onMouseOver="hilite(850)" onMouseOut="lolite()" onClick="logVariable('to_match_endpoints')" href="../../../../_variables/to_match_endpoints.html">$to_match_endpoints</a>)
<a name="l1180"><span class="linenum">1180</span></a>      {
<a name="l1181"><span class="linenum">1181</span></a>  <span class="comment">        // oidutil.log('Performing discovery on %s' % (claimed_id,))</span>
<a name="l1182"><span class="linenum">1182</span></a>          list(<a class="var it720" onMouseOver="hilite(720)" onMouseOut="lolite()" onClick="logVariable('unused')" href="../../../../_variables/unused.html">$unused</a>, <a class="var it630" onMouseOver="hilite(630)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../../../_variables/services.html">$services</a>) = <a class="phpfunction" onClick="logFunction('call_user_func')" href="../../../../_functions/call_user_func.html" onMouseOver="phpfuncPopup(event,'call_user_func')">call_user_func</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('discoverMethod')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/discoverMethod.html">discoverMethod</a>,
<a name="l1183"><span class="linenum">1183</span></a>                                                    <a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a>,
<a name="l1184"><span class="linenum">1184</span></a>                                                    <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fetcher')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/fetcher.html">fetcher</a>);
<a name="l1185"><span class="linenum">1185</span></a>  
<a name="l1186"><span class="linenum">1186</span></a>          if (!<a class="var it630" onMouseOver="hilite(630)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../../../_variables/services.html">$services</a>) {
<a name="l1187"><span class="linenum">1187</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l1188"><span class="linenum">1188</span></a>                sprintf(&quot;No OpenID information found at %s&quot;,
<a name="l1189"><span class="linenum">1189</span></a>                        <a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a>));
<a name="l1190"><span class="linenum">1190</span></a>          }
<a name="l1191"><span class="linenum">1191</span></a>  
<a name="l1192"><span class="linenum">1192</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_verifyDiscoveryServices')" href="../../../../_functions/_verifydiscoveryservices.html" onMouseOver="funcPopup(event,'_verifydiscoveryservices')">_verifyDiscoveryServices</a>(<a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a>, <a class="var it630" onMouseOver="hilite(630)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../../../_variables/services.html">$services</a>,
<a name="l1193"><span class="linenum">1193</span></a>                                                 <a class="var it850" onMouseOver="hilite(850)" onMouseOut="lolite()" onClick="logVariable('to_match_endpoints')" href="../../../../_variables/to_match_endpoints.html">$to_match_endpoints</a>);
<a name="l1194"><span class="linenum">1194</span></a>      }
<a name="l1195"><span class="linenum">1195</span></a>  
<a name="l1196"><span class="linenum">1196</span></a>      <span class="comment">/**</span>
<a name="l1197"><span class="linenum">1197</span></a>  <span class="comment">     * @access private</span>
<a name="l1198"><span class="linenum">1198</span></a>  <span class="comment">     */</span>
<a name="l1199"><span class="linenum">1199</span></a>      function <a class="function" onClick="logFunction('_verifyDiscoveryServices')" href="../../../../_functions/_verifydiscoveryservices.html" onMouseOver="funcPopup(event,'_verifydiscoveryservices')">_verifyDiscoveryServices</a>(<a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a>, 
<a name="l1200"><span class="linenum">1200</span></a>                                        &amp;<a class="var it630" onMouseOver="hilite(630)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../../../_variables/services.html">$services</a>, &amp;<a class="var it850" onMouseOver="hilite(850)" onMouseOut="lolite()" onClick="logVariable('to_match_endpoints')" href="../../../../_variables/to_match_endpoints.html">$to_match_endpoints</a>)
<a name="l1201"><span class="linenum">1201</span></a>      {
<a name="l1202"><span class="linenum">1202</span></a>  <span class="comment">        // Search the services resulting from discovery to find one</span>
<a name="l1203"><span class="linenum">1203</span></a>  <span class="comment">        // that matches the information from the assertion</span>
<a name="l1204"><span class="linenum">1204</span></a>  
<a name="l1205"><span class="linenum">1205</span></a>          foreach (<a class="var it630" onMouseOver="hilite(630)" onMouseOut="lolite()" onClick="logVariable('services')" href="../../../../_variables/services.html">$services</a> as <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>) {
<a name="l1206"><span class="linenum">1206</span></a>              foreach (<a class="var it850" onMouseOver="hilite(850)" onMouseOut="lolite()" onClick="logVariable('to_match_endpoints')" href="../../../../_variables/to_match_endpoints.html">$to_match_endpoints</a> as <a class="var it851" onMouseOver="hilite(851)" onMouseOut="lolite()" onClick="logVariable('to_match_endpoint')" href="../../../../_variables/to_match_endpoint.html">$to_match_endpoint</a>) {
<a name="l1207"><span class="linenum">1207</span></a>                  <a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_verifyDiscoverySingle')" href="../../../../_functions/_verifydiscoverysingle.html" onMouseOver="funcPopup(event,'_verifydiscoverysingle')">_verifyDiscoverySingle</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, 
<a name="l1208"><span class="linenum">1208</span></a>                                                          <a class="var it851" onMouseOver="hilite(851)" onMouseOut="lolite()" onClick="logVariable('to_match_endpoint')" href="../../../../_variables/to_match_endpoint.html">$to_match_endpoint</a>);
<a name="l1209"><span class="linenum">1209</span></a>  
<a name="l1210"><span class="linenum">1210</span></a>                  if (!<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it40" onMouseOver="hilite(40)" onMouseOut="lolite()" onClick="logVariable('result')" href="../../../../_variables/result.html">$result</a>)) {
<a name="l1211"><span class="linenum">1211</span></a>  <span class="comment">                    // It matches, so discover verification has</span>
<a name="l1212"><span class="linenum">1212</span></a>  <span class="comment">                    // succeeded. Return this endpoint.</span>
<a name="l1213"><span class="linenum">1213</span></a>                      return <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>;
<a name="l1214"><span class="linenum">1214</span></a>                  }
<a name="l1215"><span class="linenum">1215</span></a>              }
<a name="l1216"><span class="linenum">1216</span></a>          }
<a name="l1217"><span class="linenum">1217</span></a>  
<a name="l1218"><span class="linenum">1218</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l1219"><span class="linenum">1219</span></a>            sprintf('No matching endpoint found after discovering %s',
<a name="l1220"><span class="linenum">1220</span></a>                    <a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a>));
<a name="l1221"><span class="linenum">1221</span></a>      }
<a name="l1222"><span class="linenum">1222</span></a>  
<a name="l1223"><span class="linenum">1223</span></a>      <span class="comment">/**</span>
<a name="l1224"><span class="linenum">1224</span></a>  <span class="comment">     * Extract the nonce from an OpenID 1 response.  Return the nonce</span>
<a name="l1225"><span class="linenum">1225</span></a>  <span class="comment">     * from the BARE_NS since we independently check the return_to</span>
<a name="l1226"><span class="linenum">1226</span></a>  <span class="comment">     * arguments are the same as those in the response message.</span>
<a name="l1227"><span class="linenum">1227</span></a>  <span class="comment">     *</span>
<a name="l1228"><span class="linenum">1228</span></a>  <span class="comment">     * See the openid1_nonce_query_arg_name class variable</span>
<a name="l1229"><span class="linenum">1229</span></a>  <span class="comment">     *</span>
<a name="l1230"><span class="linenum">1230</span></a>  <span class="comment">     * @returns $nonce The nonce as a string or null</span>
<a name="l1231"><span class="linenum">1231</span></a>  <span class="comment">     *</span>
<a name="l1232"><span class="linenum">1232</span></a>  <span class="comment">     * @access private</span>
<a name="l1233"><span class="linenum">1233</span></a>  <span class="comment">     */</span>
<a name="l1234"><span class="linenum">1234</span></a>      function <a class="function" onClick="logFunction('_idResGetNonceOpenID1')" href="../../../../_functions/_idresgetnonceopenid1.html" onMouseOver="funcPopup(event,'_idresgetnonceopenid1')">_idResGetNonceOpenID1</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>)
<a name="l1235"><span class="linenum">1235</span></a>      {
<a name="l1236"><span class="linenum">1236</span></a>          return <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_BARE_NS,
<a name="l1237"><span class="linenum">1237</span></a>                                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('openid1_nonce_query_arg_name')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/openid1_nonce_query_arg_name.html">openid1_nonce_query_arg_name</a>);
<a name="l1238"><span class="linenum">1238</span></a>      }
<a name="l1239"><span class="linenum">1239</span></a>  
<a name="l1240"><span class="linenum">1240</span></a>      <span class="comment">/**</span>
<a name="l1241"><span class="linenum">1241</span></a>  <span class="comment">     * @access private</span>
<a name="l1242"><span class="linenum">1242</span></a>  <span class="comment">     */</span>
<a name="l1243"><span class="linenum">1243</span></a>      function <a class="function" onClick="logFunction('_idResCheckNonce')" href="../../../../_functions/_idreschecknonce.html" onMouseOver="funcPopup(event,'_idreschecknonce')">_idResCheckNonce</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>)
<a name="l1244"><span class="linenum">1244</span></a>      {
<a name="l1245"><span class="linenum">1245</span></a>          if (<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>()) {
<a name="l1246"><span class="linenum">1246</span></a>  <span class="comment">            // This indicates that the nonce was generated by the consumer</span>
<a name="l1247"><span class="linenum">1247</span></a>              <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../../../../_variables/nonce.html">$nonce</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_idResGetNonceOpenID1')" href="../../../../_functions/_idresgetnonceopenid1.html" onMouseOver="funcPopup(event,'_idresgetnonceopenid1')">_idResGetNonceOpenID1</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l1248"><span class="linenum">1248</span></a>              <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a> = '';
<a name="l1249"><span class="linenum">1249</span></a>          } else {
<a name="l1250"><span class="linenum">1250</span></a>              <a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../../../../_variables/nonce.html">$nonce</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID2_NS,
<a name="l1251"><span class="linenum">1251</span></a>                                        'response_nonce');
<a name="l1252"><span class="linenum">1252</span></a>  
<a name="l1253"><span class="linenum">1253</span></a>              <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a> = <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('server_url')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a>;
<a name="l1254"><span class="linenum">1254</span></a>          }
<a name="l1255"><span class="linenum">1255</span></a>  
<a name="l1256"><span class="linenum">1256</span></a>          if (<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../../../../_variables/nonce.html">$nonce</a> === null) {
<a name="l1257"><span class="linenum">1257</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1258"><span class="linenum">1258</span></a>                                       &quot;Nonce missing from response&quot;);
<a name="l1259"><span class="linenum">1259</span></a>          }
<a name="l1260"><span class="linenum">1260</span></a>  
<a name="l1261"><span class="linenum">1261</span></a>          <a class="var it37" onMouseOver="hilite(37)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../../../_variables/parts.html">$parts</a> = <a class="function" onClick="logFunction('Auth_OpenID_splitNonce')" href="../../../../_functions/auth_openid_splitnonce.html" onMouseOver="funcPopup(event,'auth_openid_splitnonce')">Auth_OpenID_splitNonce</a>(<a class="var it208" onMouseOver="hilite(208)" onMouseOut="lolite()" onClick="logVariable('nonce')" href="../../../../_variables/nonce.html">$nonce</a>);
<a name="l1262"><span class="linenum">1262</span></a>  
<a name="l1263"><span class="linenum">1263</span></a>          if (<a class="var it37" onMouseOver="hilite(37)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../../../_variables/parts.html">$parts</a> === null) {
<a name="l1264"><span class="linenum">1264</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1265"><span class="linenum">1265</span></a>                                       &quot;Malformed nonce in response&quot;);
<a name="l1266"><span class="linenum">1266</span></a>          }
<a name="l1267"><span class="linenum">1267</span></a>  
<a name="l1268"><span class="linenum">1268</span></a>          list(<a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../../../_variables/timestamp.html">$timestamp</a>, <a class="var it203" onMouseOver="hilite(203)" onMouseOut="lolite()" onClick="logVariable('salt')" href="../../../../_variables/salt.html">$salt</a>) = <a class="var it37" onMouseOver="hilite(37)" onMouseOut="lolite()" onClick="logVariable('parts')" href="../../../../_variables/parts.html">$parts</a>;
<a name="l1269"><span class="linenum">1269</span></a>  
<a name="l1270"><span class="linenum">1270</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('store')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/store.html">store</a>-&gt;<a class="function" onClick="logFunction('useNonce')" href="../../../../_functions/usenonce.html" onMouseOver="funcPopup(event,'usenonce')">useNonce</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it180" onMouseOver="hilite(180)" onMouseOut="lolite()" onClick="logVariable('timestamp')" href="../../../../_variables/timestamp.html">$timestamp</a>, <a class="var it203" onMouseOver="hilite(203)" onMouseOut="lolite()" onClick="logVariable('salt')" href="../../../../_variables/salt.html">$salt</a>)) {
<a name="l1271"><span class="linenum">1271</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1272"><span class="linenum">1272</span></a>                           &quot;Nonce already used or out of range&quot;);
<a name="l1273"><span class="linenum">1273</span></a>          }
<a name="l1274"><span class="linenum">1274</span></a>  
<a name="l1275"><span class="linenum">1275</span></a>          return null;
<a name="l1276"><span class="linenum">1276</span></a>      }
<a name="l1277"><span class="linenum">1277</span></a>  
<a name="l1278"><span class="linenum">1278</span></a>      <span class="comment">/**</span>
<a name="l1279"><span class="linenum">1279</span></a>  <span class="comment">     * @access private</span>
<a name="l1280"><span class="linenum">1280</span></a>  <span class="comment">     */</span>
<a name="l1281"><span class="linenum">1281</span></a>      function <a class="function" onClick="logFunction('_idResCheckForFields')" href="../../../../_functions/_idrescheckforfields.html" onMouseOver="funcPopup(event,'_idrescheckforfields')">_idResCheckForFields</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>)
<a name="l1282"><span class="linenum">1282</span></a>      {
<a name="l1283"><span class="linenum">1283</span></a>          <a class="var it852" onMouseOver="hilite(852)" onMouseOut="lolite()" onClick="logVariable('basic_fields')" href="../../../../_variables/basic_fields.html">$basic_fields</a> = array('return_to', 'assoc_handle', 'sig', 'signed');
<a name="l1284"><span class="linenum">1284</span></a>          <a class="var it853" onMouseOver="hilite(853)" onMouseOut="lolite()" onClick="logVariable('basic_sig_fields')" href="../../../../_variables/basic_sig_fields.html">$basic_sig_fields</a> = array('return_to', 'identity');
<a name="l1285"><span class="linenum">1285</span></a>  
<a name="l1286"><span class="linenum">1286</span></a>          <a class="var it854" onMouseOver="hilite(854)" onMouseOut="lolite()" onClick="logVariable('require_fields')" href="../../../../_variables/require_fields.html">$require_fields</a> = array(
<a name="l1287"><span class="linenum">1287</span></a>              Auth_OpenID_OPENID2_NS =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it852" onMouseOver="hilite(852)" onMouseOut="lolite()" onClick="logVariable('basic_fields')" href="../../../../_variables/basic_fields.html">$basic_fields</a>,
<a name="l1288"><span class="linenum">1288</span></a>                                                    array('op_endpoint')),
<a name="l1289"><span class="linenum">1289</span></a>  
<a name="l1290"><span class="linenum">1290</span></a>              Auth_OpenID_OPENID1_NS =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it852" onMouseOver="hilite(852)" onMouseOut="lolite()" onClick="logVariable('basic_fields')" href="../../../../_variables/basic_fields.html">$basic_fields</a>,
<a name="l1291"><span class="linenum">1291</span></a>                                                    array('identity'))
<a name="l1292"><span class="linenum">1292</span></a>              );
<a name="l1293"><span class="linenum">1293</span></a>  
<a name="l1294"><span class="linenum">1294</span></a>          <a class="var it855" onMouseOver="hilite(855)" onMouseOut="lolite()" onClick="logVariable('require_sigs')" href="../../../../_variables/require_sigs.html">$require_sigs</a> = array(
<a name="l1295"><span class="linenum">1295</span></a>              Auth_OpenID_OPENID2_NS =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it853" onMouseOver="hilite(853)" onMouseOut="lolite()" onClick="logVariable('basic_sig_fields')" href="../../../../_variables/basic_sig_fields.html">$basic_sig_fields</a>,
<a name="l1296"><span class="linenum">1296</span></a>                                                    array('response_nonce',
<a name="l1297"><span class="linenum">1297</span></a>                                                          'claimed_id',
<a name="l1298"><span class="linenum">1298</span></a>                                                          'assoc_handle')),
<a name="l1299"><span class="linenum">1299</span></a>              Auth_OpenID_OPENID1_NS =&gt; <a class="phpfunction" onClick="logFunction('array_merge')" href="../../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it853" onMouseOver="hilite(853)" onMouseOut="lolite()" onClick="logVariable('basic_sig_fields')" href="../../../../_variables/basic_sig_fields.html">$basic_sig_fields</a>,
<a name="l1300"><span class="linenum">1300</span></a>                                                    array('nonce'))
<a name="l1301"><span class="linenum">1301</span></a>              );
<a name="l1302"><span class="linenum">1302</span></a>  
<a name="l1303"><span class="linenum">1303</span></a>          foreach (<a class="var it854" onMouseOver="hilite(854)" onMouseOut="lolite()" onClick="logVariable('require_fields')" href="../../../../_variables/require_fields.html">$require_fields</a>[<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getOpenIDNamespace')" href="../../../../_functions/getopenidnamespace.html" onMouseOver="funcPopup(event,'getopenidnamespace')">getOpenIDNamespace</a>()] as <a class="var it856" onMouseOver="hilite(856)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../../../_variables/field.html">$field</a>) {
<a name="l1304"><span class="linenum">1304</span></a>              if (!<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('hasKey')" href="../../../../_functions/haskey.html" onMouseOver="funcPopup(event,'haskey')">hasKey</a>(Auth_OpenID_OPENID_NS, <a class="var it856" onMouseOver="hilite(856)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../../../_variables/field.html">$field</a>)) {
<a name="l1305"><span class="linenum">1305</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l1306"><span class="linenum">1306</span></a>                               &quot;Missing required field '&quot;.<a class="var it856" onMouseOver="hilite(856)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../../../_variables/field.html">$field</a>.&quot;'&quot;);
<a name="l1307"><span class="linenum">1307</span></a>              }
<a name="l1308"><span class="linenum">1308</span></a>          }
<a name="l1309"><span class="linenum">1309</span></a>  
<a name="l1310"><span class="linenum">1310</span></a>          <a class="var it829" onMouseOver="hilite(829)" onMouseOut="lolite()" onClick="logVariable('signed_list_str')" href="../../../../_variables/signed_list_str.html">$signed_list_str</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS,
<a name="l1311"><span class="linenum">1311</span></a>                                              'signed',
<a name="l1312"><span class="linenum">1312</span></a>                                              Auth_OpenID_NO_DEFAULT);
<a name="l1313"><span class="linenum">1313</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it829" onMouseOver="hilite(829)" onMouseOut="lolite()" onClick="logVariable('signed_list_str')" href="../../../../_variables/signed_list_str.html">$signed_list_str</a>)) {
<a name="l1314"><span class="linenum">1314</span></a>              return <a class="var it829" onMouseOver="hilite(829)" onMouseOut="lolite()" onClick="logVariable('signed_list_str')" href="../../../../_variables/signed_list_str.html">$signed_list_str</a>;
<a name="l1315"><span class="linenum">1315</span></a>          }
<a name="l1316"><span class="linenum">1316</span></a>          <a class="var it830" onMouseOver="hilite(830)" onMouseOut="lolite()" onClick="logVariable('signed_list')" href="../../../../_variables/signed_list.html">$signed_list</a> = <a class="phpfunction" onClick="logFunction('explode')" href="../../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it829" onMouseOver="hilite(829)" onMouseOut="lolite()" onClick="logVariable('signed_list_str')" href="../../../../_variables/signed_list_str.html">$signed_list_str</a>);
<a name="l1317"><span class="linenum">1317</span></a>  
<a name="l1318"><span class="linenum">1318</span></a>          foreach (<a class="var it855" onMouseOver="hilite(855)" onMouseOut="lolite()" onClick="logVariable('require_sigs')" href="../../../../_variables/require_sigs.html">$require_sigs</a>[<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getOpenIDNamespace')" href="../../../../_functions/getopenidnamespace.html" onMouseOver="funcPopup(event,'getopenidnamespace')">getOpenIDNamespace</a>()] as <a class="var it856" onMouseOver="hilite(856)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../../../_variables/field.html">$field</a>) {
<a name="l1319"><span class="linenum">1319</span></a>  <span class="comment">            // Field is present and not in signed list</span>
<a name="l1320"><span class="linenum">1320</span></a>              if (<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('hasKey')" href="../../../../_functions/haskey.html" onMouseOver="funcPopup(event,'haskey')">hasKey</a>(Auth_OpenID_OPENID_NS, <a class="var it856" onMouseOver="hilite(856)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../../../_variables/field.html">$field</a>) &amp;&amp;
<a name="l1321"><span class="linenum">1321</span></a>                  (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it856" onMouseOver="hilite(856)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../../../_variables/field.html">$field</a>, <a class="var it830" onMouseOver="hilite(830)" onMouseOut="lolite()" onClick="logVariable('signed_list')" href="../../../../_variables/signed_list.html">$signed_list</a>))) {
<a name="l1322"><span class="linenum">1322</span></a>                  return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l1323"><span class="linenum">1323</span></a>                               &quot;'&quot;.<a class="var it856" onMouseOver="hilite(856)" onMouseOut="lolite()" onClick="logVariable('field')" href="../../../../_variables/field.html">$field</a>.&quot;' not signed&quot;);
<a name="l1324"><span class="linenum">1324</span></a>              }
<a name="l1325"><span class="linenum">1325</span></a>          }
<a name="l1326"><span class="linenum">1326</span></a>  
<a name="l1327"><span class="linenum">1327</span></a>          return null;
<a name="l1328"><span class="linenum">1328</span></a>      }
<a name="l1329"><span class="linenum">1329</span></a>  
<a name="l1330"><span class="linenum">1330</span></a>      <span class="comment">/**</span>
<a name="l1331"><span class="linenum">1331</span></a>  <span class="comment">     * @access private</span>
<a name="l1332"><span class="linenum">1332</span></a>  <span class="comment">     */</span>
<a name="l1333"><span class="linenum">1333</span></a>      function <a class="function" onClick="logFunction('_checkAuth')" href="../../../../_functions/_checkauth.html" onMouseOver="funcPopup(event,'_checkauth')">_checkAuth</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>)
<a name="l1334"><span class="linenum">1334</span></a>      {
<a name="l1335"><span class="linenum">1335</span></a>          <a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../_variables/request.html">$request</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_createCheckAuthRequest')" href="../../../../_functions/_createcheckauthrequest.html" onMouseOver="funcPopup(event,'_createcheckauthrequest')">_createCheckAuthRequest</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>);
<a name="l1336"><span class="linenum">1336</span></a>          if (<a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../_variables/request.html">$request</a> === null) {
<a name="l1337"><span class="linenum">1337</span></a>              return false;
<a name="l1338"><span class="linenum">1338</span></a>          }
<a name="l1339"><span class="linenum">1339</span></a>  
<a name="l1340"><span class="linenum">1340</span></a>          <a class="var it857" onMouseOver="hilite(857)" onMouseOut="lolite()" onClick="logVariable('resp_message')" href="../../../../_variables/resp_message.html">$resp_message</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_makeKVPost')" href="../../../../_functions/_makekvpost.html" onMouseOver="funcPopup(event,'_makekvpost')">_makeKVPost</a>(<a class="var it278" onMouseOver="hilite(278)" onMouseOut="lolite()" onClick="logVariable('request')" href="../../../../_variables/request.html">$request</a>, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>);
<a name="l1341"><span class="linenum">1341</span></a>          if ((<a class="var it857" onMouseOver="hilite(857)" onMouseOut="lolite()" onClick="logVariable('resp_message')" href="../../../../_variables/resp_message.html">$resp_message</a> === null) ||
<a name="l1342"><span class="linenum">1342</span></a>              (<a class="phpfunction" onClick="logFunction('is_a')" href="../../../../_functions/is_a.html" onMouseOver="phpfuncPopup(event,'is_a')">is_a</a>(<a class="var it857" onMouseOver="hilite(857)" onMouseOut="lolite()" onClick="logVariable('resp_message')" href="../../../../_variables/resp_message.html">$resp_message</a>, 'Auth_OpenID_ServerErrorContainer'))) {
<a name="l1343"><span class="linenum">1343</span></a>              return false;
<a name="l1344"><span class="linenum">1344</span></a>          }
<a name="l1345"><span class="linenum">1345</span></a>  
<a name="l1346"><span class="linenum">1346</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_processCheckAuthResponse')" href="../../../../_functions/_processcheckauthresponse.html" onMouseOver="funcPopup(event,'_processcheckauthresponse')">_processCheckAuthResponse</a>(<a class="var it857" onMouseOver="hilite(857)" onMouseOut="lolite()" onClick="logVariable('resp_message')" href="../../../../_variables/resp_message.html">$resp_message</a>, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>);
<a name="l1347"><span class="linenum">1347</span></a>      }
<a name="l1348"><span class="linenum">1348</span></a>  
<a name="l1349"><span class="linenum">1349</span></a>      <span class="comment">/**</span>
<a name="l1350"><span class="linenum">1350</span></a>  <span class="comment">     * @access private</span>
<a name="l1351"><span class="linenum">1351</span></a>  <span class="comment">     */</span>
<a name="l1352"><span class="linenum">1352</span></a>      function <a class="function" onClick="logFunction('_createCheckAuthRequest')" href="../../../../_functions/_createcheckauthrequest.html" onMouseOver="funcPopup(event,'_createcheckauthrequest')">_createCheckAuthRequest</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>)
<a name="l1353"><span class="linenum">1353</span></a>      {
<a name="l1354"><span class="linenum">1354</span></a>          <a class="var it858" onMouseOver="hilite(858)" onMouseOut="lolite()" onClick="logVariable('signed')" href="../../../../_variables/signed.html">$signed</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'signed');
<a name="l1355"><span class="linenum">1355</span></a>          if (<a class="var it858" onMouseOver="hilite(858)" onMouseOut="lolite()" onClick="logVariable('signed')" href="../../../../_variables/signed.html">$signed</a>) {
<a name="l1356"><span class="linenum">1356</span></a>              foreach (<a class="phpfunction" onClick="logFunction('explode')" href="../../../../_functions/explode.html" onMouseOver="phpfuncPopup(event,'explode')">explode</a>(',', <a class="var it858" onMouseOver="hilite(858)" onMouseOut="lolite()" onClick="logVariable('signed')" href="../../../../_variables/signed.html">$signed</a>) as <a class="var it265" onMouseOver="hilite(265)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../../../_variables/k.html">$k</a>) {
<a name="l1357"><span class="linenum">1357</span></a>                  <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getAliasedArg')" href="../../../../_functions/getaliasedarg.html" onMouseOver="funcPopup(event,'getaliasedarg')">getAliasedArg</a>(<a class="var it265" onMouseOver="hilite(265)" onMouseOut="lolite()" onClick="logVariable('k')" href="../../../../_variables/k.html">$k</a>);
<a name="l1358"><span class="linenum">1358</span></a>                  if (<a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a> === null) {
<a name="l1359"><span class="linenum">1359</span></a>                      return null;
<a name="l1360"><span class="linenum">1360</span></a>                  }
<a name="l1361"><span class="linenum">1361</span></a>              }
<a name="l1362"><span class="linenum">1362</span></a>          }
<a name="l1363"><span class="linenum">1363</span></a>          <a class="var it859" onMouseOver="hilite(859)" onMouseOut="lolite()" onClick="logVariable('ca_message')" href="../../../../_variables/ca_message.html">$ca_message</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="phpfunction" onClick="logFunction('copy')" href="../../../../_functions/copy.html" onMouseOver="phpfuncPopup(event,'copy')">copy</a>();
<a name="l1364"><span class="linenum">1364</span></a>          <a class="var it859" onMouseOver="hilite(859)" onMouseOut="lolite()" onClick="logVariable('ca_message')" href="../../../../_variables/ca_message.html">$ca_message</a>-&gt;<a class="function" onClick="logFunction('setArg')" href="../../../../_functions/setarg.html" onMouseOver="funcPopup(event,'setarg')">setArg</a>(Auth_OpenID_OPENID_NS, 'mode', 
<a name="l1365"><span class="linenum">1365</span></a>                              'check_authentication');
<a name="l1366"><span class="linenum">1366</span></a>          return <a class="var it859" onMouseOver="hilite(859)" onMouseOut="lolite()" onClick="logVariable('ca_message')" href="../../../../_variables/ca_message.html">$ca_message</a>;
<a name="l1367"><span class="linenum">1367</span></a>      }
<a name="l1368"><span class="linenum">1368</span></a>  
<a name="l1369"><span class="linenum">1369</span></a>      <span class="comment">/**</span>
<a name="l1370"><span class="linenum">1370</span></a>  <span class="comment">     * @access private</span>
<a name="l1371"><span class="linenum">1371</span></a>  <span class="comment">     */</span>
<a name="l1372"><span class="linenum">1372</span></a>      function <a class="function" onClick="logFunction('_processCheckAuthResponse')" href="../../../../_functions/_processcheckauthresponse.html" onMouseOver="funcPopup(event,'_processcheckauthresponse')">_processCheckAuthResponse</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>)
<a name="l1373"><span class="linenum">1373</span></a>      {
<a name="l1374"><span class="linenum">1374</span></a>          <a class="var it860" onMouseOver="hilite(860)" onMouseOut="lolite()" onClick="logVariable('is_valid')" href="../../../../_variables/is_valid.html">$is_valid</a> = <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'is_valid',
<a name="l1375"><span class="linenum">1375</span></a>                                        'false');
<a name="l1376"><span class="linenum">1376</span></a>  
<a name="l1377"><span class="linenum">1377</span></a>          <a class="var it861" onMouseOver="hilite(861)" onMouseOut="lolite()" onClick="logVariable('invalidate_handle')" href="../../../../_variables/invalidate_handle.html">$invalidate_handle</a> = <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS,
<a name="l1378"><span class="linenum">1378</span></a>                                                 'invalidate_handle');
<a name="l1379"><span class="linenum">1379</span></a>  
<a name="l1380"><span class="linenum">1380</span></a>          if (<a class="var it861" onMouseOver="hilite(861)" onMouseOut="lolite()" onClick="logVariable('invalidate_handle')" href="../../../../_variables/invalidate_handle.html">$invalidate_handle</a> !== null) {
<a name="l1381"><span class="linenum">1381</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('store')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/store.html">store</a>-&gt;<a class="function" onClick="logFunction('removeAssociation')" href="../../../../_functions/removeassociation.html" onMouseOver="funcPopup(event,'removeassociation')">removeAssociation</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>,
<a name="l1382"><span class="linenum">1382</span></a>                                              <a class="var it861" onMouseOver="hilite(861)" onMouseOut="lolite()" onClick="logVariable('invalidate_handle')" href="../../../../_variables/invalidate_handle.html">$invalidate_handle</a>);
<a name="l1383"><span class="linenum">1383</span></a>          }
<a name="l1384"><span class="linenum">1384</span></a>  
<a name="l1385"><span class="linenum">1385</span></a>          if (<a class="var it860" onMouseOver="hilite(860)" onMouseOut="lolite()" onClick="logVariable('is_valid')" href="../../../../_variables/is_valid.html">$is_valid</a> == 'true') {
<a name="l1386"><span class="linenum">1386</span></a>              return true;
<a name="l1387"><span class="linenum">1387</span></a>          }
<a name="l1388"><span class="linenum">1388</span></a>  
<a name="l1389"><span class="linenum">1389</span></a>          return false;
<a name="l1390"><span class="linenum">1390</span></a>      }
<a name="l1391"><span class="linenum">1391</span></a>  
<a name="l1392"><span class="linenum">1392</span></a>      <span class="comment">/**</span>
<a name="l1393"><span class="linenum">1393</span></a>  <span class="comment">     * Adapt a POST response to a Message.</span>
<a name="l1394"><span class="linenum">1394</span></a>  <span class="comment">     *</span>
<a name="l1395"><span class="linenum">1395</span></a>  <span class="comment">     * @param $response Result of a POST to an OpenID endpoint.</span>
<a name="l1396"><span class="linenum">1396</span></a>  <span class="comment">     *</span>
<a name="l1397"><span class="linenum">1397</span></a>  <span class="comment">     * @access private</span>
<a name="l1398"><span class="linenum">1398</span></a>  <span class="comment">     */</span>
<a name="l1399"><span class="linenum">1399</span></a>      function <a class="function" onClick="logFunction('_httpResponseToMessage')" href="../../../../_functions/_httpresponsetomessage.html" onMouseOver="funcPopup(event,'_httpresponsetomessage')">_httpResponseToMessage</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>)
<a name="l1400"><span class="linenum">1400</span></a>      {
<a name="l1401"><span class="linenum">1401</span></a>  <span class="comment">        // Should this function be named Message.fromHTTPResponse instead?</span>
<a name="l1402"><span class="linenum">1402</span></a>          <a class="var it862" onMouseOver="hilite(862)" onMouseOut="lolite()" onClick="logVariable('response_message')" href="../../../../_variables/response_message.html">$response_message</a> = <a class="class" onClick="logClass('Auth_OpenID_Message')" href="../../../../_classes/auth_openid_message.html" onMouseOver="classPopup(event,'auth_openid_message')">Auth_OpenID_Message</a>::<a class="function" onClick="logFunction('fromKVForm')" href="../../../../_functions/fromkvform.html" onMouseOver="funcPopup(event,'fromkvform')">fromKVForm</a>(<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('body')" class="var it2285" onMouseOver="hilite(2285)" onMouseOut="lolite()" href="../../../../_variables/body.html">body</a>);
<a name="l1403"><span class="linenum">1403</span></a>  
<a name="l1404"><span class="linenum">1404</span></a>          if (<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('status')" class="var it2285" onMouseOver="hilite(2285)" onMouseOut="lolite()" href="../../../../_variables/status.html">status</a> == 400) {
<a name="l1405"><span class="linenum">1405</span></a>              return <a class="class" onClick="logClass('Auth_OpenID_ServerErrorContainer')" href="../../../../_classes/auth_openid_servererrorcontainer.html" onMouseOver="classPopup(event,'auth_openid_servererrorcontainer')">Auth_OpenID_ServerErrorContainer</a>::<a class="function" onClick="logFunction('fromMessage')" href="../../../../_functions/frommessage.html" onMouseOver="funcPopup(event,'frommessage')">fromMessage</a>(
<a name="l1406"><span class="linenum">1406</span></a>                          <a class="var it862" onMouseOver="hilite(862)" onMouseOut="lolite()" onClick="logVariable('response_message')" href="../../../../_variables/response_message.html">$response_message</a>);
<a name="l1407"><span class="linenum">1407</span></a>          } else if (<a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('status')" class="var it2285" onMouseOver="hilite(2285)" onMouseOut="lolite()" href="../../../../_variables/status.html">status</a> != 200 and <a class="var it42" onMouseOver="hilite(42)" onMouseOut="lolite()" onClick="logVariable('response')" href="../../../../_variables/response.html">$response</a>-&gt;<a onClick="logVariable('status')" class="var it2285" onMouseOver="hilite(2285)" onMouseOut="lolite()" href="../../../../_variables/status.html">status</a> != 206) {
<a name="l1408"><span class="linenum">1408</span></a>              return null;
<a name="l1409"><span class="linenum">1409</span></a>          }
<a name="l1410"><span class="linenum">1410</span></a>  
<a name="l1411"><span class="linenum">1411</span></a>          return <a class="var it862" onMouseOver="hilite(862)" onMouseOut="lolite()" onClick="logVariable('response_message')" href="../../../../_variables/response_message.html">$response_message</a>;
<a name="l1412"><span class="linenum">1412</span></a>      }
<a name="l1413"><span class="linenum">1413</span></a>  
<a name="l1414"><span class="linenum">1414</span></a>      <span class="comment">/**</span>
<a name="l1415"><span class="linenum">1415</span></a>  <span class="comment">     * @access private</span>
<a name="l1416"><span class="linenum">1416</span></a>  <span class="comment">     */</span>
<a name="l1417"><span class="linenum">1417</span></a>      function <a class="function" onClick="logFunction('_makeKVPost')" href="../../../../_functions/_makekvpost.html" onMouseOver="funcPopup(event,'_makekvpost')">_makeKVPost</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>)
<a name="l1418"><span class="linenum">1418</span></a>      {
<a name="l1419"><span class="linenum">1419</span></a>          <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('body')" href="../../../../_variables/body.html">$body</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('toURLEncoded')" href="../../../../_functions/tourlencoded.html" onMouseOver="funcPopup(event,'tourlencoded')">toURLEncoded</a>();
<a name="l1420"><span class="linenum">1420</span></a>          <a class="var it863" onMouseOver="hilite(863)" onMouseOut="lolite()" onClick="logVariable('resp')" href="../../../../_variables/resp.html">$resp</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('fetcher')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/fetcher.html">fetcher</a>-&gt;<a class="function" onClick="logFunction('post')" href="../../../../_functions/post.html" onMouseOver="funcPopup(event,'post')">post</a>(<a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>, <a class="var it47" onMouseOver="hilite(47)" onMouseOut="lolite()" onClick="logVariable('body')" href="../../../../_variables/body.html">$body</a>);
<a name="l1421"><span class="linenum">1421</span></a>  
<a name="l1422"><span class="linenum">1422</span></a>          if (<a class="var it863" onMouseOver="hilite(863)" onMouseOut="lolite()" onClick="logVariable('resp')" href="../../../../_variables/resp.html">$resp</a> === null) {
<a name="l1423"><span class="linenum">1423</span></a>              return null;
<a name="l1424"><span class="linenum">1424</span></a>          }
<a name="l1425"><span class="linenum">1425</span></a>  
<a name="l1426"><span class="linenum">1426</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_httpResponseToMessage')" href="../../../../_functions/_httpresponsetomessage.html" onMouseOver="funcPopup(event,'_httpresponsetomessage')">_httpResponseToMessage</a>(<a class="var it863" onMouseOver="hilite(863)" onMouseOut="lolite()" onClick="logVariable('resp')" href="../../../../_variables/resp.html">$resp</a>, <a class="var it181" onMouseOver="hilite(181)" onMouseOut="lolite()" onClick="logVariable('server_url')" href="../../../../_variables/server_url.html">$server_url</a>);
<a name="l1427"><span class="linenum">1427</span></a>      }
<a name="l1428"><span class="linenum">1428</span></a>  
<a name="l1429"><span class="linenum">1429</span></a>      <span class="comment">/**</span>
<a name="l1430"><span class="linenum">1430</span></a>  <span class="comment">     * @access private</span>
<a name="l1431"><span class="linenum">1431</span></a>  <span class="comment">     */</span>
<a name="l1432"><span class="linenum">1432</span></a>      function <a class="function" onClick="logFunction('_getAssociation')" href="../../../../_functions/_getassociation.html" onMouseOver="funcPopup(event,'_getassociation')">_getAssociation</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>)
<a name="l1433"><span class="linenum">1433</span></a>      {
<a name="l1434"><span class="linenum">1434</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_use_assocs')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_use_assocs.html">_use_assocs</a>) {
<a name="l1435"><span class="linenum">1435</span></a>              return null;
<a name="l1436"><span class="linenum">1436</span></a>          }
<a name="l1437"><span class="linenum">1437</span></a>  
<a name="l1438"><span class="linenum">1438</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('store')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/store.html">store</a>-&gt;<a class="function" onClick="logFunction('getAssociation')" href="../../../../_functions/getassociation.html" onMouseOver="funcPopup(event,'getassociation')">getAssociation</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('server_url')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a>);
<a name="l1439"><span class="linenum">1439</span></a>  
<a name="l1440"><span class="linenum">1440</span></a>          if ((<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> === null) ||
<a name="l1441"><span class="linenum">1441</span></a>              (<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>-&gt;<a class="function" onClick="logFunction('getExpiresIn')" href="../../../../_functions/getexpiresin.html" onMouseOver="funcPopup(event,'getexpiresin')">getExpiresIn</a>() &lt;= 0)) {
<a name="l1442"><span class="linenum">1442</span></a>  
<a name="l1443"><span class="linenum">1443</span></a>              <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_negotiateAssociation')" href="../../../../_functions/_negotiateassociation.html" onMouseOver="funcPopup(event,'_negotiateassociation')">_negotiateAssociation</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l1444"><span class="linenum">1444</span></a>  
<a name="l1445"><span class="linenum">1445</span></a>              if (<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> !== null) {
<a name="l1446"><span class="linenum">1446</span></a>                  <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('store')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/store.html">store</a>-&gt;<a class="function" onClick="logFunction('storeAssociation')" href="../../../../_functions/storeassociation.html" onMouseOver="funcPopup(event,'storeassociation')">storeAssociation</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('server_url')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a>,
<a name="l1447"><span class="linenum">1447</span></a>                                                 <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>);
<a name="l1448"><span class="linenum">1448</span></a>              }
<a name="l1449"><span class="linenum">1449</span></a>          }
<a name="l1450"><span class="linenum">1450</span></a>  
<a name="l1451"><span class="linenum">1451</span></a>          return <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>;
<a name="l1452"><span class="linenum">1452</span></a>      }
<a name="l1453"><span class="linenum">1453</span></a>  
<a name="l1454"><span class="linenum">1454</span></a>      <span class="comment">/**</span>
<a name="l1455"><span class="linenum">1455</span></a>  <span class="comment">     * Handle ServerErrors resulting from association requests.</span>
<a name="l1456"><span class="linenum">1456</span></a>  <span class="comment">     *</span>
<a name="l1457"><span class="linenum">1457</span></a>  <span class="comment">     * @return $result If server replied with an C{unsupported-type}</span>
<a name="l1458"><span class="linenum">1458</span></a>  <span class="comment">     * error, return a tuple of supported C{association_type},</span>
<a name="l1459"><span class="linenum">1459</span></a>  <span class="comment">     * C{session_type}.  Otherwise logs the error and returns null.</span>
<a name="l1460"><span class="linenum">1460</span></a>  <span class="comment">     *</span>
<a name="l1461"><span class="linenum">1461</span></a>  <span class="comment">     * @access private</span>
<a name="l1462"><span class="linenum">1462</span></a>  <span class="comment">     */</span>
<a name="l1463"><span class="linenum">1463</span></a>      function <a class="function" onClick="logFunction('_extractSupportedAssociationType')" href="../../../../_functions/_extractsupportedassociationtype.html" onMouseOver="funcPopup(event,'_extractsupportedassociationtype')">_extractSupportedAssociationType</a>(&amp;<a class="var it864" onMouseOver="hilite(864)" onMouseOut="lolite()" onClick="logVariable('server_error')" href="../../../../_variables/server_error.html">$server_error</a>, &amp;<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l1464"><span class="linenum">1464</span></a>                                                <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>)
<a name="l1465"><span class="linenum">1465</span></a>      {
<a name="l1466"><span class="linenum">1466</span></a>  <span class="comment">        // Any error message whose code is not 'unsupported-type'</span>
<a name="l1467"><span class="linenum">1467</span></a>  <span class="comment">        // should be considered a total failure.</span>
<a name="l1468"><span class="linenum">1468</span></a>          if ((<a class="var it864" onMouseOver="hilite(864)" onMouseOut="lolite()" onClick="logVariable('server_error')" href="../../../../_variables/server_error.html">$server_error</a>-&gt;<a onClick="logVariable('error_code')" class="var it2311" onMouseOver="hilite(2311)" onMouseOut="lolite()" href="../../../../_variables/error_code.html">error_code</a> != 'unsupported-type') ||
<a name="l1469"><span class="linenum">1469</span></a>              (<a class="var it864" onMouseOver="hilite(864)" onMouseOut="lolite()" onClick="logVariable('server_error')" href="../../../../_variables/server_error.html">$server_error</a>-&gt;<a onClick="logVariable('message')" class="var it2311" onMouseOver="hilite(2311)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>())) {
<a name="l1470"><span class="linenum">1470</span></a>              return null;
<a name="l1471"><span class="linenum">1471</span></a>          }
<a name="l1472"><span class="linenum">1472</span></a>  
<a name="l1473"><span class="linenum">1473</span></a>  <span class="comment">        // The server didn't like the association/session type that we</span>
<a name="l1474"><span class="linenum">1474</span></a>  <span class="comment">        // sent, and it sent us back a message that might tell us how</span>
<a name="l1475"><span class="linenum">1475</span></a>  <span class="comment">        // to handle it.</span>
<a name="l1476"><span class="linenum">1476</span></a>  
<a name="l1477"><span class="linenum">1477</span></a>  <span class="comment">        // Extract the session_type and assoc_type from the error</span>
<a name="l1478"><span class="linenum">1478</span></a>  <span class="comment">        // message</span>
<a name="l1479"><span class="linenum">1479</span></a>          <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a> = <a class="var it864" onMouseOver="hilite(864)" onMouseOut="lolite()" onClick="logVariable('server_error')" href="../../../../_variables/server_error.html">$server_error</a>-&gt;<a onClick="logVariable('message')" class="var it2311" onMouseOver="hilite(2311)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS,
<a name="l1480"><span class="linenum">1480</span></a>                                                       'assoc_type');
<a name="l1481"><span class="linenum">1481</span></a>  
<a name="l1482"><span class="linenum">1482</span></a>          <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> = <a class="var it864" onMouseOver="hilite(864)" onMouseOut="lolite()" onClick="logVariable('server_error')" href="../../../../_variables/server_error.html">$server_error</a>-&gt;<a onClick="logVariable('message')" class="var it2311" onMouseOver="hilite(2311)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS,
<a name="l1483"><span class="linenum">1483</span></a>                                                         'session_type');
<a name="l1484"><span class="linenum">1484</span></a>  
<a name="l1485"><span class="linenum">1485</span></a>          if ((<a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a> === null) || (<a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> === null)) {
<a name="l1486"><span class="linenum">1486</span></a>              return null;
<a name="l1487"><span class="linenum">1487</span></a>          } else if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('negotiator')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/negotiator.html">negotiator</a>-&gt;<a class="function" onClick="logFunction('isAllowed')" href="../../../../_functions/isallowed.html" onMouseOver="funcPopup(event,'isallowed')">isAllowed</a>(<a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>,
<a name="l1488"><span class="linenum">1488</span></a>                                                   <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>)) {
<a name="l1489"><span class="linenum">1489</span></a>              return null;
<a name="l1490"><span class="linenum">1490</span></a>          } else {
<a name="l1491"><span class="linenum">1491</span></a>            return array(<a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>, <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>);
<a name="l1492"><span class="linenum">1492</span></a>          }
<a name="l1493"><span class="linenum">1493</span></a>      }
<a name="l1494"><span class="linenum">1494</span></a>  
<a name="l1495"><span class="linenum">1495</span></a>      <span class="comment">/**</span>
<a name="l1496"><span class="linenum">1496</span></a>  <span class="comment">     * @access private</span>
<a name="l1497"><span class="linenum">1497</span></a>  <span class="comment">     */</span>
<a name="l1498"><span class="linenum">1498</span></a>      function <a class="function" onClick="logFunction('_negotiateAssociation')" href="../../../../_functions/_negotiateassociation.html" onMouseOver="funcPopup(event,'_negotiateassociation')">_negotiateAssociation</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>)
<a name="l1499"><span class="linenum">1499</span></a>      {
<a name="l1500"><span class="linenum">1500</span></a>  <span class="comment">        // Get our preferred session/association type from the negotiatior.</span>
<a name="l1501"><span class="linenum">1501</span></a>          list(<a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>, <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('negotiator')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/negotiator.html">negotiator</a>-&gt;<a class="function" onClick="logFunction('getAllowedType')" href="../../../../_functions/getallowedtype.html" onMouseOver="funcPopup(event,'getallowedtype')">getAllowedType</a>();
<a name="l1502"><span class="linenum">1502</span></a>  
<a name="l1503"><span class="linenum">1503</span></a>          <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_requestAssociation')" href="../../../../_functions/_requestassociation.html" onMouseOver="funcPopup(event,'_requestassociation')">_requestAssociation</a>(
<a name="l1504"><span class="linenum">1504</span></a>                             <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>, <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>);
<a name="l1505"><span class="linenum">1505</span></a>  
<a name="l1506"><span class="linenum">1506</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>)) {
<a name="l1507"><span class="linenum">1507</span></a>              return null;
<a name="l1508"><span class="linenum">1508</span></a>          }
<a name="l1509"><span class="linenum">1509</span></a>  
<a name="l1510"><span class="linenum">1510</span></a>          if (<a class="phpfunction" onClick="logFunction('is_a')" href="../../../../_functions/is_a.html" onMouseOver="phpfuncPopup(event,'is_a')">is_a</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>, 'Auth_OpenID_ServerErrorContainer')) {
<a name="l1511"><span class="linenum">1511</span></a>              <a class="var it867" onMouseOver="hilite(867)" onMouseOut="lolite()" onClick="logVariable('why')" href="../../../../_variables/why.html">$why</a> = <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>;
<a name="l1512"><span class="linenum">1512</span></a>  
<a name="l1513"><span class="linenum">1513</span></a>              <a class="var it868" onMouseOver="hilite(868)" onMouseOut="lolite()" onClick="logVariable('supportedTypes')" href="../../../../_variables/supportedTypes.html">$supportedTypes</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_extractSupportedAssociationType')" href="../../../../_functions/_extractsupportedassociationtype.html" onMouseOver="funcPopup(event,'_extractsupportedassociationtype')">_extractSupportedAssociationType</a>(
<a name="l1514"><span class="linenum">1514</span></a>                                       <a class="var it867" onMouseOver="hilite(867)" onMouseOut="lolite()" onClick="logVariable('why')" href="../../../../_variables/why.html">$why</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>);
<a name="l1515"><span class="linenum">1515</span></a>  
<a name="l1516"><span class="linenum">1516</span></a>              if (<a class="var it868" onMouseOver="hilite(868)" onMouseOut="lolite()" onClick="logVariable('supportedTypes')" href="../../../../_variables/supportedTypes.html">$supportedTypes</a> !== null) {
<a name="l1517"><span class="linenum">1517</span></a>                  list(<a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>, <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>) = <a class="var it868" onMouseOver="hilite(868)" onMouseOut="lolite()" onClick="logVariable('supportedTypes')" href="../../../../_variables/supportedTypes.html">$supportedTypes</a>;
<a name="l1518"><span class="linenum">1518</span></a>  
<a name="l1519"><span class="linenum">1519</span></a>  <span class="comment">                // Attempt to create an association from the assoc_type</span>
<a name="l1520"><span class="linenum">1520</span></a>  <span class="comment">                // and session_type that the server told us it</span>
<a name="l1521"><span class="linenum">1521</span></a>  <span class="comment">                // supported.</span>
<a name="l1522"><span class="linenum">1522</span></a>                  <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_requestAssociation')" href="../../../../_functions/_requestassociation.html" onMouseOver="funcPopup(event,'_requestassociation')">_requestAssociation</a>(
<a name="l1523"><span class="linenum">1523</span></a>                                     <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>, <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>);
<a name="l1524"><span class="linenum">1524</span></a>  
<a name="l1525"><span class="linenum">1525</span></a>                  if (<a class="phpfunction" onClick="logFunction('is_a')" href="../../../../_functions/is_a.html" onMouseOver="phpfuncPopup(event,'is_a')">is_a</a>(<a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>, 'Auth_OpenID_ServerErrorContainer')) {
<a name="l1526"><span class="linenum">1526</span></a>  <span class="comment">                    // Do not keep trying, since it rejected the</span>
<a name="l1527"><span class="linenum">1527</span></a>  <span class="comment">                    // association type that it told us to use.</span>
<a name="l1528"><span class="linenum">1528</span></a>  <span class="comment">                    // oidutil.log('Server %s refused its suggested association</span>
<a name="l1529"><span class="linenum">1529</span></a>  <span class="comment">                    //             'type: session_type=%s, assoc_type=%s'</span>
<a name="l1530"><span class="linenum">1530</span></a>  <span class="comment">                    //             % (endpoint.server_url, session_type,</span>
<a name="l1531"><span class="linenum">1531</span></a>  <span class="comment">                    //                assoc_type))</span>
<a name="l1532"><span class="linenum">1532</span></a>                      return null;
<a name="l1533"><span class="linenum">1533</span></a>                  } else {
<a name="l1534"><span class="linenum">1534</span></a>                      return <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>;
<a name="l1535"><span class="linenum">1535</span></a>                  }
<a name="l1536"><span class="linenum">1536</span></a>              } else {
<a name="l1537"><span class="linenum">1537</span></a>                  return null;
<a name="l1538"><span class="linenum">1538</span></a>              }
<a name="l1539"><span class="linenum">1539</span></a>          } else {
<a name="l1540"><span class="linenum">1540</span></a>              return <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>;
<a name="l1541"><span class="linenum">1541</span></a>          }
<a name="l1542"><span class="linenum">1542</span></a>      }
<a name="l1543"><span class="linenum">1543</span></a>  
<a name="l1544"><span class="linenum">1544</span></a>      <span class="comment">/**</span>
<a name="l1545"><span class="linenum">1545</span></a>  <span class="comment">     * @access private</span>
<a name="l1546"><span class="linenum">1546</span></a>  <span class="comment">     */</span>
<a name="l1547"><span class="linenum">1547</span></a>      function <a class="function" onClick="logFunction('_requestAssociation')" href="../../../../_functions/_requestassociation.html" onMouseOver="funcPopup(event,'_requestassociation')">_requestAssociation</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>, <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>)
<a name="l1548"><span class="linenum">1548</span></a>      {
<a name="l1549"><span class="linenum">1549</span></a>          list(<a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>, <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a>) = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_createAssociateRequest')" href="../../../../_functions/_createassociaterequest.html" onMouseOver="funcPopup(event,'_createassociaterequest')">_createAssociateRequest</a>(
<a name="l1550"><span class="linenum">1550</span></a>                                        <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>, <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>);
<a name="l1551"><span class="linenum">1551</span></a>  
<a name="l1552"><span class="linenum">1552</span></a>          <a class="var it862" onMouseOver="hilite(862)" onMouseOut="lolite()" onClick="logVariable('response_message')" href="../../../../_variables/response_message.html">$response_message</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_makeKVPost')" href="../../../../_functions/_makekvpost.html" onMouseOver="funcPopup(event,'_makekvpost')">_makeKVPost</a>(<a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a>, <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('server_url')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/server_url.html">server_url</a>);
<a name="l1553"><span class="linenum">1553</span></a>  
<a name="l1554"><span class="linenum">1554</span></a>          if (<a class="var it862" onMouseOver="hilite(862)" onMouseOut="lolite()" onClick="logVariable('response_message')" href="../../../../_variables/response_message.html">$response_message</a> === null) {
<a name="l1555"><span class="linenum">1555</span></a>  <span class="comment">            // oidutil.log('openid.associate request failed: %s' % (why[0],))</span>
<a name="l1556"><span class="linenum">1556</span></a>              return null;
<a name="l1557"><span class="linenum">1557</span></a>          } else if (<a class="phpfunction" onClick="logFunction('is_a')" href="../../../../_functions/is_a.html" onMouseOver="phpfuncPopup(event,'is_a')">is_a</a>(<a class="var it862" onMouseOver="hilite(862)" onMouseOut="lolite()" onClick="logVariable('response_message')" href="../../../../_variables/response_message.html">$response_message</a>,
<a name="l1558"><span class="linenum">1558</span></a>                          'Auth_OpenID_ServerErrorContainer')) {
<a name="l1559"><span class="linenum">1559</span></a>              return <a class="var it862" onMouseOver="hilite(862)" onMouseOut="lolite()" onClick="logVariable('response_message')" href="../../../../_variables/response_message.html">$response_message</a>;
<a name="l1560"><span class="linenum">1560</span></a>          }
<a name="l1561"><span class="linenum">1561</span></a>  
<a name="l1562"><span class="linenum">1562</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_extractAssociation')" href="../../../../_functions/_extractassociation.html" onMouseOver="funcPopup(event,'_extractassociation')">_extractAssociation</a>(<a class="var it862" onMouseOver="hilite(862)" onMouseOut="lolite()" onClick="logVariable('response_message')" href="../../../../_variables/response_message.html">$response_message</a>, <a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>);
<a name="l1563"><span class="linenum">1563</span></a>      }
<a name="l1564"><span class="linenum">1564</span></a>  
<a name="l1565"><span class="linenum">1565</span></a>      <span class="comment">/**</span>
<a name="l1566"><span class="linenum">1566</span></a>  <span class="comment">     * @access private</span>
<a name="l1567"><span class="linenum">1567</span></a>  <span class="comment">     */</span>
<a name="l1568"><span class="linenum">1568</span></a>      function <a class="function" onClick="logFunction('_extractAssociation')" href="../../../../_functions/_extractassociation.html" onMouseOver="funcPopup(event,'_extractassociation')">_extractAssociation</a>(&amp;<a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>, &amp;<a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>)
<a name="l1569"><span class="linenum">1569</span></a>      {
<a name="l1570"><span class="linenum">1570</span></a>  <span class="comment">        // Extract the common fields from the response, raising an</span>
<a name="l1571"><span class="linenum">1571</span></a>  <span class="comment">        // exception if they are not found</span>
<a name="l1572"><span class="linenum">1572</span></a>          <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a> = <a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(
<a name="l1573"><span class="linenum">1573</span></a>                           Auth_OpenID_OPENID_NS, 'assoc_type',
<a name="l1574"><span class="linenum">1574</span></a>                           Auth_OpenID_NO_DEFAULT);
<a name="l1575"><span class="linenum">1575</span></a>  
<a name="l1576"><span class="linenum">1576</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>)) {
<a name="l1577"><span class="linenum">1577</span></a>              return <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>;
<a name="l1578"><span class="linenum">1578</span></a>          }
<a name="l1579"><span class="linenum">1579</span></a>  
<a name="l1580"><span class="linenum">1580</span></a>          <a class="var it842" onMouseOver="hilite(842)" onMouseOut="lolite()" onClick="logVariable('assoc_handle')" href="../../../../_variables/assoc_handle.html">$assoc_handle</a> = <a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(
<a name="l1581"><span class="linenum">1581</span></a>                             Auth_OpenID_OPENID_NS, 'assoc_handle',
<a name="l1582"><span class="linenum">1582</span></a>                             Auth_OpenID_NO_DEFAULT);
<a name="l1583"><span class="linenum">1583</span></a>  
<a name="l1584"><span class="linenum">1584</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it842" onMouseOver="hilite(842)" onMouseOut="lolite()" onClick="logVariable('assoc_handle')" href="../../../../_variables/assoc_handle.html">$assoc_handle</a>)) {
<a name="l1585"><span class="linenum">1585</span></a>              return <a class="var it842" onMouseOver="hilite(842)" onMouseOut="lolite()" onClick="logVariable('assoc_handle')" href="../../../../_variables/assoc_handle.html">$assoc_handle</a>;
<a name="l1586"><span class="linenum">1586</span></a>          }
<a name="l1587"><span class="linenum">1587</span></a>  
<a name="l1588"><span class="linenum">1588</span></a>  <span class="comment">        // expires_in is a base-10 string. The Python parsing will</span>
<a name="l1589"><span class="linenum">1589</span></a>  <span class="comment">        // accept literals that have whitespace around them and will</span>
<a name="l1590"><span class="linenum">1590</span></a>  <span class="comment">        // accept negative values. Neither of these are really in-spec,</span>
<a name="l1591"><span class="linenum">1591</span></a>  <span class="comment">        // but we think it's OK to accept them.</span>
<a name="l1592"><span class="linenum">1592</span></a>          <a class="var it871" onMouseOver="hilite(871)" onMouseOut="lolite()" onClick="logVariable('expires_in_str')" href="../../../../_variables/expires_in_str.html">$expires_in_str</a> = <a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(
<a name="l1593"><span class="linenum">1593</span></a>                               Auth_OpenID_OPENID_NS, 'expires_in',
<a name="l1594"><span class="linenum">1594</span></a>                               Auth_OpenID_NO_DEFAULT);
<a name="l1595"><span class="linenum">1595</span></a>  
<a name="l1596"><span class="linenum">1596</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it871" onMouseOver="hilite(871)" onMouseOut="lolite()" onClick="logVariable('expires_in_str')" href="../../../../_variables/expires_in_str.html">$expires_in_str</a>)) {
<a name="l1597"><span class="linenum">1597</span></a>              return <a class="var it871" onMouseOver="hilite(871)" onMouseOut="lolite()" onClick="logVariable('expires_in_str')" href="../../../../_variables/expires_in_str.html">$expires_in_str</a>;
<a name="l1598"><span class="linenum">1598</span></a>          }
<a name="l1599"><span class="linenum">1599</span></a>  
<a name="l1600"><span class="linenum">1600</span></a>          <a class="var it872" onMouseOver="hilite(872)" onMouseOut="lolite()" onClick="logVariable('expires_in')" href="../../../../_variables/expires_in.html">$expires_in</a> = <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="phpfunction" onClick="logFunction('intval')" href="../../../../_functions/intval.html" onMouseOver="phpfuncPopup(event,'intval')">intval</a>(<a class="var it871" onMouseOver="hilite(871)" onMouseOut="lolite()" onClick="logVariable('expires_in_str')" href="../../../../_variables/expires_in_str.html">$expires_in_str</a>);
<a name="l1601"><span class="linenum">1601</span></a>          if (<a class="var it872" onMouseOver="hilite(872)" onMouseOut="lolite()" onClick="logVariable('expires_in')" href="../../../../_variables/expires_in.html">$expires_in</a> === false) {
<a name="l1602"><span class="linenum">1602</span></a>              
<a name="l1603"><span class="linenum">1603</span></a>              <a class="var it873" onMouseOver="hilite(873)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a> = sprintf(&quot;Could not parse expires_in from association &quot;.
<a name="l1604"><span class="linenum">1604</span></a>                             &quot;response %s&quot;, <a class="phpfunction" onClick="logFunction('print_r')" href="../../../../_functions/print_r.html" onMouseOver="phpfuncPopup(event,'print_r')">print_r</a>(<a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>, true));
<a name="l1605"><span class="linenum">1605</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null, <a class="var it873" onMouseOver="hilite(873)" onMouseOut="lolite()" onClick="logVariable('err')" href="../../../../_variables/err.html">$err</a>);
<a name="l1606"><span class="linenum">1606</span></a>          }
<a name="l1607"><span class="linenum">1607</span></a>  
<a name="l1608"><span class="linenum">1608</span></a>  <span class="comment">        // OpenID 1 has funny association session behaviour.</span>
<a name="l1609"><span class="linenum">1609</span></a>          if (<a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>()) {
<a name="l1610"><span class="linenum">1610</span></a>              <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('_getOpenID1SessionType')" href="../../../../_functions/_getopenid1sessiontype.html" onMouseOver="funcPopup(event,'_getopenid1sessiontype')">_getOpenID1SessionType</a>(<a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>);
<a name="l1611"><span class="linenum">1611</span></a>          } else {
<a name="l1612"><span class="linenum">1612</span></a>              <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> = <a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(
<a name="l1613"><span class="linenum">1613</span></a>                                 Auth_OpenID_OPENID2_NS, 'session_type',
<a name="l1614"><span class="linenum">1614</span></a>                                 Auth_OpenID_NO_DEFAULT);
<a name="l1615"><span class="linenum">1615</span></a>  
<a name="l1616"><span class="linenum">1616</span></a>              if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>)) {
<a name="l1617"><span class="linenum">1617</span></a>                  return <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>;
<a name="l1618"><span class="linenum">1618</span></a>              }
<a name="l1619"><span class="linenum">1619</span></a>          }
<a name="l1620"><span class="linenum">1620</span></a>  
<a name="l1621"><span class="linenum">1621</span></a>  <span class="comment">        // Session type mismatch</span>
<a name="l1622"><span class="linenum">1622</span></a>          if (<a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>-&gt;<a onClick="logVariable('session_type')" class="var it2312" onMouseOver="hilite(2312)" onMouseOut="lolite()" href="../../../../_variables/session_type.html">session_type</a> != <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>) {
<a name="l1623"><span class="linenum">1623</span></a>              if (<a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>() &amp;&amp;
<a name="l1624"><span class="linenum">1624</span></a>                  (<a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> == 'no-encryption')) {
<a name="l1625"><span class="linenum">1625</span></a>  <span class="comment">                // In OpenID 1, any association request can result in</span>
<a name="l1626"><span class="linenum">1626</span></a>  <span class="comment">                // a 'no-encryption' association response. Setting</span>
<a name="l1627"><span class="linenum">1627</span></a>  <span class="comment">                // assoc_session to a new no-encryption session should</span>
<a name="l1628"><span class="linenum">1628</span></a>  <span class="comment">                // make the rest of this function work properly for</span>
<a name="l1629"><span class="linenum">1629</span></a>  <span class="comment">                // that case.</span>
<a name="l1630"><span class="linenum">1630</span></a>                  <a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_PlainTextConsumerSession')" href="../../../../_classes/auth_openid_plaintextconsumersession.html" onMouseOver="classPopup(event,'auth_openid_plaintextconsumersession')">Auth_OpenID_PlainTextConsumerSession</a>();
<a name="l1631"><span class="linenum">1631</span></a>              } else {
<a name="l1632"><span class="linenum">1632</span></a>  <span class="comment">                // Any other mismatch, regardless of protocol version</span>
<a name="l1633"><span class="linenum">1633</span></a>  <span class="comment">                // results in the failure of the association session</span>
<a name="l1634"><span class="linenum">1634</span></a>  <span class="comment">                // altogether.</span>
<a name="l1635"><span class="linenum">1635</span></a>                  return null;
<a name="l1636"><span class="linenum">1636</span></a>              }
<a name="l1637"><span class="linenum">1637</span></a>          }
<a name="l1638"><span class="linenum">1638</span></a>  
<a name="l1639"><span class="linenum">1639</span></a>  <span class="comment">        // Make sure assoc_type is valid for session_type</span>
<a name="l1640"><span class="linenum">1640</span></a>          if (!<a class="phpfunction" onClick="logFunction('in_array')" href="../../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>, <a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>-&gt;<a onClick="logVariable('allowed_assoc_types')" class="var it2312" onMouseOver="hilite(2312)" onMouseOut="lolite()" href="../../../../_variables/allowed_assoc_types.html">allowed_assoc_types</a>)) {
<a name="l1641"><span class="linenum">1641</span></a>              return null;
<a name="l1642"><span class="linenum">1642</span></a>          }
<a name="l1643"><span class="linenum">1643</span></a>  
<a name="l1644"><span class="linenum">1644</span></a>  <span class="comment">        // Delegate to the association session to extract the secret</span>
<a name="l1645"><span class="linenum">1645</span></a>  <span class="comment">        // from the response, however is appropriate for that session</span>
<a name="l1646"><span class="linenum">1646</span></a>  <span class="comment">        // type.</span>
<a name="l1647"><span class="linenum">1647</span></a>          <a class="var it874" onMouseOver="hilite(874)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../../../_variables/secret.html">$secret</a> = <a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>-&gt;<a class="function" onClick="logFunction('extractSecret')" href="../../../../_functions/extractsecret.html" onMouseOver="funcPopup(event,'extractsecret')">extractSecret</a>(<a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>);
<a name="l1648"><span class="linenum">1648</span></a>  
<a name="l1649"><span class="linenum">1649</span></a>          if (<a class="var it874" onMouseOver="hilite(874)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../../../_variables/secret.html">$secret</a> === null) {
<a name="l1650"><span class="linenum">1650</span></a>              return null;
<a name="l1651"><span class="linenum">1651</span></a>          }
<a name="l1652"><span class="linenum">1652</span></a>  
<a name="l1653"><span class="linenum">1653</span></a>          return <a class="class" onClick="logClass('Auth_OpenID_Association')" href="../../../../_classes/auth_openid_association.html" onMouseOver="classPopup(event,'auth_openid_association')">Auth_OpenID_Association</a>::<a class="function" onClick="logFunction('fromExpiresIn')" href="../../../../_functions/fromexpiresin.html" onMouseOver="funcPopup(event,'fromexpiresin')">fromExpiresIn</a>(
<a name="l1654"><span class="linenum">1654</span></a>                   <a class="var it872" onMouseOver="hilite(872)" onMouseOut="lolite()" onClick="logVariable('expires_in')" href="../../../../_variables/expires_in.html">$expires_in</a>, <a class="var it842" onMouseOver="hilite(842)" onMouseOut="lolite()" onClick="logVariable('assoc_handle')" href="../../../../_variables/assoc_handle.html">$assoc_handle</a>, <a class="var it874" onMouseOver="hilite(874)" onMouseOut="lolite()" onClick="logVariable('secret')" href="../../../../_variables/secret.html">$secret</a>, <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>);
<a name="l1655"><span class="linenum">1655</span></a>      }
<a name="l1656"><span class="linenum">1656</span></a>  
<a name="l1657"><span class="linenum">1657</span></a>      <span class="comment">/**</span>
<a name="l1658"><span class="linenum">1658</span></a>  <span class="comment">     * @access private</span>
<a name="l1659"><span class="linenum">1659</span></a>  <span class="comment">     */</span>
<a name="l1660"><span class="linenum">1660</span></a>      function <a class="function" onClick="logFunction('_createAssociateRequest')" href="../../../../_functions/_createassociaterequest.html" onMouseOver="funcPopup(event,'_createassociaterequest')">_createAssociateRequest</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>, <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>)
<a name="l1661"><span class="linenum">1661</span></a>      {
<a name="l1662"><span class="linenum">1662</span></a>          if (<a class="phpfunction" onClick="logFunction('array_key_exists')" href="../../../../_functions/array_key_exists.html" onMouseOver="phpfuncPopup(event,'array_key_exists')">array_key_exists</a>(<a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>, <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session_types')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session_types.html">session_types</a>)) {
<a name="l1663"><span class="linenum">1663</span></a>              <a class="var it875" onMouseOver="hilite(875)" onMouseOut="lolite()" onClick="logVariable('session_type_class')" href="../../../../_variables/session_type_class.html">$session_type_class</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('session_types')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/session_types.html">session_types</a>[<a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>];
<a name="l1664"><span class="linenum">1664</span></a>  
<a name="l1665"><span class="linenum">1665</span></a>              if (<a class="phpfunction" onClick="logFunction('is_callable')" href="../../../../_functions/is_callable.html" onMouseOver="phpfuncPopup(event,'is_callable')">is_callable</a>(<a class="var it875" onMouseOver="hilite(875)" onMouseOut="lolite()" onClick="logVariable('session_type_class')" href="../../../../_variables/session_type_class.html">$session_type_class</a>)) {
<a name="l1666"><span class="linenum">1666</span></a>                  <a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a> = <a class="var it875" onMouseOver="hilite(875)" onMouseOut="lolite()" onClick="logVariable('session_type_class')" href="../../../../_variables/session_type_class.html">$session_type_class</a>();
<a name="l1667"><span class="linenum">1667</span></a>              } else {
<a name="l1668"><span class="linenum">1668</span></a>                  <a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a> = new <a class="var it875" onMouseOver="hilite(875)" onMouseOut="lolite()" onClick="logVariable('session_type_class')" href="../../../../_variables/session_type_class.html">$session_type_class</a>();
<a name="l1669"><span class="linenum">1669</span></a>              }
<a name="l1670"><span class="linenum">1670</span></a>          } else {
<a name="l1671"><span class="linenum">1671</span></a>              return null;
<a name="l1672"><span class="linenum">1672</span></a>          }
<a name="l1673"><span class="linenum">1673</span></a>  
<a name="l1674"><span class="linenum">1674</span></a>          <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a> = array(
<a name="l1675"><span class="linenum">1675</span></a>              'mode' =&gt; 'associate',
<a name="l1676"><span class="linenum">1676</span></a>              'assoc_type' =&gt; <a class="var it865" onMouseOver="hilite(865)" onMouseOut="lolite()" onClick="logVariable('assoc_type')" href="../../../../_variables/assoc_type.html">$assoc_type</a>);
<a name="l1677"><span class="linenum">1677</span></a>  
<a name="l1678"><span class="linenum">1678</span></a>          if (!<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a class="function" onClick="logFunction('compatibilityMode')" href="../../../../_functions/compatibilitymode.html" onMouseOver="funcPopup(event,'compatibilitymode')">compatibilityMode</a>()) {
<a name="l1679"><span class="linenum">1679</span></a>              <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a>['ns'] = Auth_OpenID_OPENID2_NS;
<a name="l1680"><span class="linenum">1680</span></a>          }
<a name="l1681"><span class="linenum">1681</span></a>  
<a name="l1682"><span class="linenum">1682</span></a>  <span class="comment">        // Leave out the session type if we're in compatibility mode</span>
<a name="l1683"><span class="linenum">1683</span></a>  <span class="comment">        // *and* it's no-encryption.</span>
<a name="l1684"><span class="linenum">1684</span></a>          if ((!<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a class="function" onClick="logFunction('compatibilityMode')" href="../../../../_functions/compatibilitymode.html" onMouseOver="funcPopup(event,'compatibilitymode')">compatibilityMode</a>()) ||
<a name="l1685"><span class="linenum">1685</span></a>              (<a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>-&gt;<a onClick="logVariable('session_type')" class="var it2312" onMouseOver="hilite(2312)" onMouseOut="lolite()" href="../../../../_variables/session_type.html">session_type</a> != 'no-encryption')) {
<a name="l1686"><span class="linenum">1686</span></a>              <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a>['session_type'] = <a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>-&gt;<a onClick="logVariable('session_type')" class="var it2312" onMouseOver="hilite(2312)" onMouseOut="lolite()" href="../../../../_variables/session_type.html">session_type</a>;
<a name="l1687"><span class="linenum">1687</span></a>          }
<a name="l1688"><span class="linenum">1688</span></a>  
<a name="l1689"><span class="linenum">1689</span></a>          <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a> = <a class="phpfunction" onClick="logFunction('array_merge')" href="../../../../_functions/array_merge.html" onMouseOver="phpfuncPopup(event,'array_merge')">array_merge</a>(<a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a>, <a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>-&gt;<a class="function" onClick="logFunction('getRequest')" href="../../../../_functions/getrequest.html" onMouseOver="funcPopup(event,'getrequest')">getRequest</a>());
<a name="l1690"><span class="linenum">1690</span></a>          <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a> = <a class="class" onClick="logClass('Auth_OpenID_Message')" href="../../../../_classes/auth_openid_message.html" onMouseOver="classPopup(event,'auth_openid_message')">Auth_OpenID_Message</a>::<a class="function" onClick="logFunction('fromOpenIDArgs')" href="../../../../_functions/fromopenidargs.html" onMouseOver="funcPopup(event,'fromopenidargs')">fromOpenIDArgs</a>(<a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a>);
<a name="l1691"><span class="linenum">1691</span></a>          return array(<a class="var it869" onMouseOver="hilite(869)" onMouseOut="lolite()" onClick="logVariable('assoc_session')" href="../../../../_variables/assoc_session.html">$assoc_session</a>, <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>);
<a name="l1692"><span class="linenum">1692</span></a>      }
<a name="l1693"><span class="linenum">1693</span></a>  
<a name="l1694"><span class="linenum">1694</span></a>      <span class="comment">/**</span>
<a name="l1695"><span class="linenum">1695</span></a>  <span class="comment">     * Given an association response message, extract the OpenID 1.X</span>
<a name="l1696"><span class="linenum">1696</span></a>  <span class="comment">     * session type.</span>
<a name="l1697"><span class="linenum">1697</span></a>  <span class="comment">     *</span>
<a name="l1698"><span class="linenum">1698</span></a>  <span class="comment">     * This function mostly takes care of the 'no-encryption' default</span>
<a name="l1699"><span class="linenum">1699</span></a>  <span class="comment">     * behavior in OpenID 1.</span>
<a name="l1700"><span class="linenum">1700</span></a>  <span class="comment">     *</span>
<a name="l1701"><span class="linenum">1701</span></a>  <span class="comment">     * If the association type is plain-text, this function will</span>
<a name="l1702"><span class="linenum">1702</span></a>  <span class="comment">     * return 'no-encryption'</span>
<a name="l1703"><span class="linenum">1703</span></a>  <span class="comment">     *</span>
<a name="l1704"><span class="linenum">1704</span></a>  <span class="comment">     * @access private</span>
<a name="l1705"><span class="linenum">1705</span></a>  <span class="comment">     * @return $typ The association type for this message</span>
<a name="l1706"><span class="linenum">1706</span></a>  <span class="comment">     */</span>
<a name="l1707"><span class="linenum">1707</span></a>      function <a class="function" onClick="logFunction('_getOpenID1SessionType')" href="../../../../_functions/_getopenid1sessiontype.html" onMouseOver="funcPopup(event,'_getopenid1sessiontype')">_getOpenID1SessionType</a>(<a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>)
<a name="l1708"><span class="linenum">1708</span></a>      {
<a name="l1709"><span class="linenum">1709</span></a>  <span class="comment">        // If it's an OpenID 1 message, allow session_type to default</span>
<a name="l1710"><span class="linenum">1710</span></a>  <span class="comment">        // to None (which signifies &quot;no-encryption&quot;)</span>
<a name="l1711"><span class="linenum">1711</span></a>          <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> = <a class="var it870" onMouseOver="hilite(870)" onMouseOut="lolite()" onClick="logVariable('assoc_response')" href="../../../../_variables/assoc_response.html">$assoc_response</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID1_NS,
<a name="l1712"><span class="linenum">1712</span></a>                                                  'session_type');
<a name="l1713"><span class="linenum">1713</span></a>  
<a name="l1714"><span class="linenum">1714</span></a>  <span class="comment">        // Handle the differences between no-encryption association</span>
<a name="l1715"><span class="linenum">1715</span></a>  <span class="comment">        // respones in OpenID 1 and 2:</span>
<a name="l1716"><span class="linenum">1716</span></a>  
<a name="l1717"><span class="linenum">1717</span></a>  <span class="comment">        // no-encryption is not really a valid session type for OpenID</span>
<a name="l1718"><span class="linenum">1718</span></a>  <span class="comment">        // 1, but we'll accept it anyway, while issuing a warning.</span>
<a name="l1719"><span class="linenum">1719</span></a>          if (<a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> == 'no-encryption') {
<a name="l1720"><span class="linenum">1720</span></a>  <span class="comment">            // oidutil.log('WARNING: OpenID server sent &quot;no-encryption&quot;'</span>
<a name="l1721"><span class="linenum">1721</span></a>  <span class="comment">            //             'for OpenID 1.X')</span>
<a name="l1722"><span class="linenum">1722</span></a>          } else if ((<a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> == '') || (<a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> === null)) {
<a name="l1723"><span class="linenum">1723</span></a>  <span class="comment">            // Missing or empty session type is the way to flag a</span>
<a name="l1724"><span class="linenum">1724</span></a>  <span class="comment">            // 'no-encryption' response. Change the session type to</span>
<a name="l1725"><span class="linenum">1725</span></a>  <span class="comment">            // 'no-encryption' so that it can be handled in the same</span>
<a name="l1726"><span class="linenum">1726</span></a>  <span class="comment">            // way as OpenID 2 'no-encryption' respones.</span>
<a name="l1727"><span class="linenum">1727</span></a>              <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a> = 'no-encryption';
<a name="l1728"><span class="linenum">1728</span></a>          }
<a name="l1729"><span class="linenum">1729</span></a>  
<a name="l1730"><span class="linenum">1730</span></a>          return <a class="var it805" onMouseOver="hilite(805)" onMouseOut="lolite()" onClick="logVariable('session_type')" href="../../../../_variables/session_type.html">$session_type</a>;
<a name="l1731"><span class="linenum">1731</span></a>      }
<a name="l1732"><span class="linenum">1732</span></a>  }
<a name="l1733"><span class="linenum">1733</span></a>  
<a name="l1734"><span class="linenum">1734</span></a>  <span class="comment">/**</span>
<a name="l1735"><span class="linenum">1735</span></a>  <span class="comment"> * This class represents an authentication request from a consumer to</span>
<a name="l1736"><span class="linenum">1736</span></a>  <span class="comment"> * an OpenID server.</span>
<a name="l1737"><span class="linenum">1737</span></a>  <span class="comment"> *</span>
<a name="l1738"><span class="linenum">1738</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l1739"><span class="linenum">1739</span></a>  <span class="comment"> */</span>
<a name="l1740"><span class="linenum">1740</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_AuthRequest')" href="../../../../_classes/auth_openid_authrequest.html" onMouseOver="classPopup(event,'auth_openid_authrequest')">Auth_OpenID_AuthRequest</a> {
<a name="l1741"><span class="linenum">1741</span></a>  
<a name="l1742"><span class="linenum">1742</span></a>      <span class="comment">/**</span>
<a name="l1743"><span class="linenum">1743</span></a>  <span class="comment">     * Initialize an authentication request with the specified token,</span>
<a name="l1744"><span class="linenum">1744</span></a>  <span class="comment">     * association, and endpoint.</span>
<a name="l1745"><span class="linenum">1745</span></a>  <span class="comment">     *</span>
<a name="l1746"><span class="linenum">1746</span></a>  <span class="comment">     * Users of this library should not create instances of this</span>
<a name="l1747"><span class="linenum">1747</span></a>  <span class="comment">     * class.  Instances of this class are created by the library when</span>
<a name="l1748"><span class="linenum">1748</span></a>  <span class="comment">     * needed.</span>
<a name="l1749"><span class="linenum">1749</span></a>  <span class="comment">     */</span>
<a name="l1750"><span class="linenum">1750</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_AuthRequest')" href="../../../../_functions/auth_openid_authrequest.html" onMouseOver="funcPopup(event,'auth_openid_authrequest')">Auth_OpenID_AuthRequest</a>(&amp;<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>)
<a name="l1751"><span class="linenum">1751</span></a>      {
<a name="l1752"><span class="linenum">1752</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('assoc')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/assoc.html">assoc</a> = <a class="var it200" onMouseOver="hilite(200)" onMouseOut="lolite()" onClick="logVariable('assoc')" href="../../../../_variables/assoc.html">$assoc</a>;
<a name="l1753"><span class="linenum">1753</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a> =&amp; <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>;
<a name="l1754"><span class="linenum">1754</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('return_to_args')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/return_to_args.html">return_to_args</a> = array();
<a name="l1755"><span class="linenum">1755</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a> = <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_Message')" href="../../../../_classes/auth_openid_message.html" onMouseOver="classPopup(event,'auth_openid_message')">Auth_OpenID_Message</a>(
<a name="l1756"><span class="linenum">1756</span></a>              <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a class="function" onClick="logFunction('preferredNamespace')" href="../../../../_functions/preferrednamespace.html" onMouseOver="funcPopup(event,'preferrednamespace')">preferredNamespace</a>());
<a name="l1757"><span class="linenum">1757</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_anonymous')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_anonymous.html">_anonymous</a> = false;
<a name="l1758"><span class="linenum">1758</span></a>      }
<a name="l1759"><span class="linenum">1759</span></a>  
<a name="l1760"><span class="linenum">1760</span></a>      <span class="comment">/**</span>
<a name="l1761"><span class="linenum">1761</span></a>  <span class="comment">     * Add an extension to this checkid request.</span>
<a name="l1762"><span class="linenum">1762</span></a>  <span class="comment">     *</span>
<a name="l1763"><span class="linenum">1763</span></a>  <span class="comment">     * $extension_request: An object that implements the extension</span>
<a name="l1764"><span class="linenum">1764</span></a>  <span class="comment">     * request interface for adding arguments to an OpenID message.</span>
<a name="l1765"><span class="linenum">1765</span></a>  <span class="comment">     */</span>
<a name="l1766"><span class="linenum">1766</span></a>      function <a class="function" onClick="logFunction('addExtension')" href="../../../../_functions/addextension.html" onMouseOver="funcPopup(event,'addextension')">addExtension</a>(&amp;<a class="var it877" onMouseOver="hilite(877)" onMouseOut="lolite()" onClick="logVariable('extension_request')" href="../../../../_variables/extension_request.html">$extension_request</a>)
<a name="l1767"><span class="linenum">1767</span></a>      {
<a name="l1768"><span class="linenum">1768</span></a>          <a class="var it877" onMouseOver="hilite(877)" onMouseOut="lolite()" onClick="logVariable('extension_request')" href="../../../../_variables/extension_request.html">$extension_request</a>-&gt;<a class="function" onClick="logFunction('toMessage')" href="../../../../_functions/tomessage.html" onMouseOver="funcPopup(event,'tomessage')">toMessage</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>);
<a name="l1769"><span class="linenum">1769</span></a>      }
<a name="l1770"><span class="linenum">1770</span></a>  
<a name="l1771"><span class="linenum">1771</span></a>      <span class="comment">/**</span>
<a name="l1772"><span class="linenum">1772</span></a>  <span class="comment">     * Add an extension argument to this OpenID authentication</span>
<a name="l1773"><span class="linenum">1773</span></a>  <span class="comment">     * request.</span>
<a name="l1774"><span class="linenum">1774</span></a>  <span class="comment">     *</span>
<a name="l1775"><span class="linenum">1775</span></a>  <span class="comment">     * Use caution when adding arguments, because they will be</span>
<a name="l1776"><span class="linenum">1776</span></a>  <span class="comment">     * URL-escaped and appended to the redirect URL, which can easily</span>
<a name="l1777"><span class="linenum">1777</span></a>  <span class="comment">     * get quite long.</span>
<a name="l1778"><span class="linenum">1778</span></a>  <span class="comment">     *</span>
<a name="l1779"><span class="linenum">1779</span></a>  <span class="comment">     * @param string $namespace The namespace for the extension. For</span>
<a name="l1780"><span class="linenum">1780</span></a>  <span class="comment">     * example, the simple registration extension uses the namespace</span>
<a name="l1781"><span class="linenum">1781</span></a>  <span class="comment">     * 'sreg'.</span>
<a name="l1782"><span class="linenum">1782</span></a>  <span class="comment">     *</span>
<a name="l1783"><span class="linenum">1783</span></a>  <span class="comment">     * @param string $key The key within the extension namespace. For</span>
<a name="l1784"><span class="linenum">1784</span></a>  <span class="comment">     * example, the nickname field in the simple registration</span>
<a name="l1785"><span class="linenum">1785</span></a>  <span class="comment">     * extension's key is 'nickname'.</span>
<a name="l1786"><span class="linenum">1786</span></a>  <span class="comment">     *</span>
<a name="l1787"><span class="linenum">1787</span></a>  <span class="comment">     * @param string $value The value to provide to the server for</span>
<a name="l1788"><span class="linenum">1788</span></a>  <span class="comment">     * this argument.</span>
<a name="l1789"><span class="linenum">1789</span></a>  <span class="comment">     */</span>
<a name="l1790"><span class="linenum">1790</span></a>      function <a class="function" onClick="logFunction('addExtensionArg')" href="../../../../_functions/addextensionarg.html" onMouseOver="funcPopup(event,'addextensionarg')">addExtensionArg</a>(<a class="var it878" onMouseOver="hilite(878)" onMouseOut="lolite()" onClick="logVariable('namespace')" href="../../../../_variables/namespace.html">$namespace</a>, <a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>)
<a name="l1791"><span class="linenum">1791</span></a>      {
<a name="l1792"><span class="linenum">1792</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('setArg')" href="../../../../_functions/setarg.html" onMouseOver="funcPopup(event,'setarg')">setArg</a>(<a class="var it878" onMouseOver="hilite(878)" onMouseOut="lolite()" onClick="logVariable('namespace')" href="../../../../_variables/namespace.html">$namespace</a>, <a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>, <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>);
<a name="l1793"><span class="linenum">1793</span></a>      }
<a name="l1794"><span class="linenum">1794</span></a>  
<a name="l1795"><span class="linenum">1795</span></a>      <span class="comment">/**</span>
<a name="l1796"><span class="linenum">1796</span></a>  <span class="comment">     * Set whether this request should be made anonymously. If a</span>
<a name="l1797"><span class="linenum">1797</span></a>  <span class="comment">     * request is anonymous, the identifier will not be sent in the</span>
<a name="l1798"><span class="linenum">1798</span></a>  <span class="comment">     * request. This is only useful if you are making another kind of</span>
<a name="l1799"><span class="linenum">1799</span></a>  <span class="comment">     * request with an extension in this request.</span>
<a name="l1800"><span class="linenum">1800</span></a>  <span class="comment">     *</span>
<a name="l1801"><span class="linenum">1801</span></a>  <span class="comment">     * Anonymous requests are not allowed when the request is made</span>
<a name="l1802"><span class="linenum">1802</span></a>  <span class="comment">     * with OpenID 1.</span>
<a name="l1803"><span class="linenum">1803</span></a>  <span class="comment">     */</span>
<a name="l1804"><span class="linenum">1804</span></a>      function <a class="function" onClick="logFunction('setAnonymous')" href="../../../../_functions/setanonymous.html" onMouseOver="funcPopup(event,'setanonymous')">setAnonymous</a>(<a class="var it879" onMouseOver="hilite(879)" onMouseOut="lolite()" onClick="logVariable('is_anonymous')" href="../../../../_variables/is_anonymous.html">$is_anonymous</a>)
<a name="l1805"><span class="linenum">1805</span></a>      {
<a name="l1806"><span class="linenum">1806</span></a>          if (<a class="var it879" onMouseOver="hilite(879)" onMouseOut="lolite()" onClick="logVariable('is_anonymous')" href="../../../../_variables/is_anonymous.html">$is_anonymous</a> &amp;&amp; <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>()) {
<a name="l1807"><span class="linenum">1807</span></a>              return false;
<a name="l1808"><span class="linenum">1808</span></a>          } else {
<a name="l1809"><span class="linenum">1809</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_anonymous')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_anonymous.html">_anonymous</a> = <a class="var it879" onMouseOver="hilite(879)" onMouseOut="lolite()" onClick="logVariable('is_anonymous')" href="../../../../_variables/is_anonymous.html">$is_anonymous</a>;
<a name="l1810"><span class="linenum">1810</span></a>              return true;
<a name="l1811"><span class="linenum">1811</span></a>          }
<a name="l1812"><span class="linenum">1812</span></a>      }
<a name="l1813"><span class="linenum">1813</span></a>  
<a name="l1814"><span class="linenum">1814</span></a>      <span class="comment">/**</span>
<a name="l1815"><span class="linenum">1815</span></a>  <span class="comment">     * Produce a {@link Auth_OpenID_Message} representing this</span>
<a name="l1816"><span class="linenum">1816</span></a>  <span class="comment">     * request.</span>
<a name="l1817"><span class="linenum">1817</span></a>  <span class="comment">     *</span>
<a name="l1818"><span class="linenum">1818</span></a>  <span class="comment">     * @param string $realm The URL (or URL pattern) that identifies</span>
<a name="l1819"><span class="linenum">1819</span></a>  <span class="comment">     * your web site to the user when she is authorizing it.</span>
<a name="l1820"><span class="linenum">1820</span></a>  <span class="comment">     *</span>
<a name="l1821"><span class="linenum">1821</span></a>  <span class="comment">     * @param string $return_to The URL that the OpenID provider will</span>
<a name="l1822"><span class="linenum">1822</span></a>  <span class="comment">     * send the user back to after attempting to verify her identity.</span>
<a name="l1823"><span class="linenum">1823</span></a>  <span class="comment">     *</span>
<a name="l1824"><span class="linenum">1824</span></a>  <span class="comment">     * Not specifying a return_to URL means that the user will not be</span>
<a name="l1825"><span class="linenum">1825</span></a>  <span class="comment">     * returned to the site issuing the request upon its completion.</span>
<a name="l1826"><span class="linenum">1826</span></a>  <span class="comment">     *</span>
<a name="l1827"><span class="linenum">1827</span></a>  <span class="comment">     * @param bool $immediate If true, the OpenID provider is to send</span>
<a name="l1828"><span class="linenum">1828</span></a>  <span class="comment">     * back a response immediately, useful for behind-the-scenes</span>
<a name="l1829"><span class="linenum">1829</span></a>  <span class="comment">     * authentication attempts.  Otherwise the OpenID provider may</span>
<a name="l1830"><span class="linenum">1830</span></a>  <span class="comment">     * engage the user before providing a response.  This is the</span>
<a name="l1831"><span class="linenum">1831</span></a>  <span class="comment">     * default case, as the user may need to provide credentials or</span>
<a name="l1832"><span class="linenum">1832</span></a>  <span class="comment">     * approve the request before a positive response can be sent.</span>
<a name="l1833"><span class="linenum">1833</span></a>  <span class="comment">     */</span>
<a name="l1834"><span class="linenum">1834</span></a>      function <a class="function" onClick="logFunction('getMessage')" href="../../../../_functions/getmessage.html" onMouseOver="funcPopup(event,'getmessage')">getMessage</a>(<a class="var it880" onMouseOver="hilite(880)" onMouseOut="lolite()" onClick="logVariable('realm')" href="../../../../_variables/realm.html">$realm</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>=null, <a class="var it881" onMouseOver="hilite(881)" onMouseOut="lolite()" onClick="logVariable('immediate')" href="../../../../_variables/immediate.html">$immediate</a>=false)
<a name="l1835"><span class="linenum">1835</span></a>      {
<a name="l1836"><span class="linenum">1836</span></a>          if (<a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>) {
<a name="l1837"><span class="linenum">1837</span></a>              <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a> = <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('appendArgs')" href="../../../../_functions/appendargs.html" onMouseOver="funcPopup(event,'appendargs')">appendArgs</a>(<a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>,
<a name="l1838"><span class="linenum">1838</span></a>                                                   <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('return_to_args')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/return_to_args.html">return_to_args</a>);
<a name="l1839"><span class="linenum">1839</span></a>          } else if (<a class="var it881" onMouseOver="hilite(881)" onMouseOut="lolite()" onClick="logVariable('immediate')" href="../../../../_variables/immediate.html">$immediate</a>) {
<a name="l1840"><span class="linenum">1840</span></a>  <span class="comment">            // raise ValueError(</span>
<a name="l1841"><span class="linenum">1841</span></a>  <span class="comment">            //     '&quot;return_to&quot; is mandatory when</span>
<a name="l1842"><span class="linenum">1842</span></a>  <span class="comment">            //using &quot;checkid_immediate&quot;')</span>
<a name="l1843"><span class="linenum">1843</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l1844"><span class="linenum">1844</span></a>                &quot;'return_to' is mandatory when using checkid_immediate&quot;);
<a name="l1845"><span class="linenum">1845</span></a>          } else if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>()) {
<a name="l1846"><span class="linenum">1846</span></a>  <span class="comment">            // raise ValueError('&quot;return_to&quot; is</span>
<a name="l1847"><span class="linenum">1847</span></a>  <span class="comment">            // mandatory for OpenID 1 requests')</span>
<a name="l1848"><span class="linenum">1848</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l1849"><span class="linenum">1849</span></a>                &quot;'return_to' is mandatory for OpenID 1 requests&quot;);
<a name="l1850"><span class="linenum">1850</span></a>          } else if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('return_to_args')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/return_to_args.html">return_to_args</a>) {
<a name="l1851"><span class="linenum">1851</span></a>  <span class="comment">            // raise ValueError('extra &quot;return_to&quot; arguments</span>
<a name="l1852"><span class="linenum">1852</span></a>  <span class="comment">            // were specified, but no return_to was specified')</span>
<a name="l1853"><span class="linenum">1853</span></a>              return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(null,
<a name="l1854"><span class="linenum">1854</span></a>                &quot;extra 'return_to' arguments where specified, &quot; .
<a name="l1855"><span class="linenum">1855</span></a>                &quot;but no return_to was specified&quot;);
<a name="l1856"><span class="linenum">1856</span></a>          }
<a name="l1857"><span class="linenum">1857</span></a>  
<a name="l1858"><span class="linenum">1858</span></a>          if (<a class="var it881" onMouseOver="hilite(881)" onMouseOut="lolite()" onClick="logVariable('immediate')" href="../../../../_variables/immediate.html">$immediate</a>) {
<a name="l1859"><span class="linenum">1859</span></a>              <a class="var it824" onMouseOver="hilite(824)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a> = 'checkid_immediate';
<a name="l1860"><span class="linenum">1860</span></a>          } else {
<a name="l1861"><span class="linenum">1861</span></a>              <a class="var it824" onMouseOver="hilite(824)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a> = 'checkid_setup';
<a name="l1862"><span class="linenum">1862</span></a>          }
<a name="l1863"><span class="linenum">1863</span></a>  
<a name="l1864"><span class="linenum">1864</span></a>          <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="phpfunction" onClick="logFunction('copy')" href="../../../../_functions/copy.html" onMouseOver="phpfuncPopup(event,'copy')">copy</a>();
<a name="l1865"><span class="linenum">1865</span></a>          if (<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>()) {
<a name="l1866"><span class="linenum">1866</span></a>              <a class="var it882" onMouseOver="hilite(882)" onMouseOut="lolite()" onClick="logVariable('realm_key')" href="../../../../_variables/realm_key.html">$realm_key</a> = 'trust_root';
<a name="l1867"><span class="linenum">1867</span></a>          } else {
<a name="l1868"><span class="linenum">1868</span></a>              <a class="var it882" onMouseOver="hilite(882)" onMouseOut="lolite()" onClick="logVariable('realm_key')" href="../../../../_variables/realm_key.html">$realm_key</a> = 'realm';
<a name="l1869"><span class="linenum">1869</span></a>          }
<a name="l1870"><span class="linenum">1870</span></a>  
<a name="l1871"><span class="linenum">1871</span></a>          <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('updateArgs')" href="../../../../_functions/updateargs.html" onMouseOver="funcPopup(event,'updateargs')">updateArgs</a>(Auth_OpenID_OPENID_NS,
<a name="l1872"><span class="linenum">1872</span></a>                               array(
<a name="l1873"><span class="linenum">1873</span></a>                                     <a class="var it882" onMouseOver="hilite(882)" onMouseOut="lolite()" onClick="logVariable('realm_key')" href="../../../../_variables/realm_key.html">$realm_key</a> =&gt; <a class="var it880" onMouseOver="hilite(880)" onMouseOut="lolite()" onClick="logVariable('realm')" href="../../../../_variables/realm.html">$realm</a>,
<a name="l1874"><span class="linenum">1874</span></a>                                     'mode' =&gt; <a class="var it824" onMouseOver="hilite(824)" onMouseOut="lolite()" onClick="logVariable('mode')" href="../../../../_variables/mode.html">$mode</a>,
<a name="l1875"><span class="linenum">1875</span></a>                                     'return_to' =&gt; <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>));
<a name="l1876"><span class="linenum">1876</span></a>  
<a name="l1877"><span class="linenum">1877</span></a>          if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('_anonymous')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/_anonymous.html">_anonymous</a>) {
<a name="l1878"><span class="linenum">1878</span></a>              if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a>-&gt;<a class="function" onClick="logFunction('isOPIdentifier')" href="../../../../_functions/isopidentifier.html" onMouseOver="funcPopup(event,'isopidentifier')">isOPIdentifier</a>()) {
<a name="l1879"><span class="linenum">1879</span></a>  <span class="comment">                // This will never happen when we're in compatibility</span>
<a name="l1880"><span class="linenum">1880</span></a>  <span class="comment">                // mode, as long as isOPIdentifier() returns False</span>
<a name="l1881"><span class="linenum">1881</span></a>  <span class="comment">                // whenever preferredNamespace() returns OPENID1_NS.</span>
<a name="l1882"><span class="linenum">1882</span></a>                  <a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a> = <a class="var it883" onMouseOver="hilite(883)" onMouseOut="lolite()" onClick="logVariable('request_identity')" href="../../../../_variables/request_identity.html">$request_identity</a> =
<a name="l1883"><span class="linenum">1883</span></a>                      Auth_OpenID_IDENTIFIER_SELECT;
<a name="l1884"><span class="linenum">1884</span></a>              } else {
<a name="l1885"><span class="linenum">1885</span></a>                  <a class="var it883" onMouseOver="hilite(883)" onMouseOut="lolite()" onClick="logVariable('request_identity')" href="../../../../_variables/request_identity.html">$request_identity</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a>-&gt;<a class="function" onClick="logFunction('getLocalID')" href="../../../../_functions/getlocalid.html" onMouseOver="funcPopup(event,'getlocalid')">getLocalID</a>();
<a name="l1886"><span class="linenum">1886</span></a>                  <a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a>-&gt;claimed_id;
<a name="l1887"><span class="linenum">1887</span></a>              }
<a name="l1888"><span class="linenum">1888</span></a>  
<a name="l1889"><span class="linenum">1889</span></a>  <span class="comment">            // This is true for both OpenID 1 and 2</span>
<a name="l1890"><span class="linenum">1890</span></a>              <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('setArg')" href="../../../../_functions/setarg.html" onMouseOver="funcPopup(event,'setarg')">setArg</a>(Auth_OpenID_OPENID_NS, 'identity',
<a name="l1891"><span class="linenum">1891</span></a>                               <a class="var it883" onMouseOver="hilite(883)" onMouseOut="lolite()" onClick="logVariable('request_identity')" href="../../../../_variables/request_identity.html">$request_identity</a>);
<a name="l1892"><span class="linenum">1892</span></a>  
<a name="l1893"><span class="linenum">1893</span></a>              if (<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('isOpenID2')" href="../../../../_functions/isopenid2.html" onMouseOver="funcPopup(event,'isopenid2')">isOpenID2</a>()) {
<a name="l1894"><span class="linenum">1894</span></a>                  <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('setArg')" href="../../../../_functions/setarg.html" onMouseOver="funcPopup(event,'setarg')">setArg</a>(Auth_OpenID_OPENID2_NS, 'claimed_id',
<a name="l1895"><span class="linenum">1895</span></a>                                   <a class="var it843" onMouseOver="hilite(843)" onMouseOut="lolite()" onClick="logVariable('claimed_id')" href="../../../../_variables/claimed_id.html">$claimed_id</a>);
<a name="l1896"><span class="linenum">1896</span></a>              }
<a name="l1897"><span class="linenum">1897</span></a>          }
<a name="l1898"><span class="linenum">1898</span></a>  
<a name="l1899"><span class="linenum">1899</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('assoc')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/assoc.html">assoc</a>) {
<a name="l1900"><span class="linenum">1900</span></a>              <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('setArg')" href="../../../../_functions/setarg.html" onMouseOver="funcPopup(event,'setarg')">setArg</a>(Auth_OpenID_OPENID_NS, 'assoc_handle',
<a name="l1901"><span class="linenum">1901</span></a>                               <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('assoc')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/assoc.html">assoc</a>-&gt;handle);
<a name="l1902"><span class="linenum">1902</span></a>          }
<a name="l1903"><span class="linenum">1903</span></a>  
<a name="l1904"><span class="linenum">1904</span></a>          return <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>;
<a name="l1905"><span class="linenum">1905</span></a>      }
<a name="l1906"><span class="linenum">1906</span></a>  
<a name="l1907"><span class="linenum">1907</span></a>      function <a class="function" onClick="logFunction('redirectURL')" href="../../../../_functions/redirecturl.html" onMouseOver="funcPopup(event,'redirecturl')">redirectURL</a>(<a class="var it880" onMouseOver="hilite(880)" onMouseOut="lolite()" onClick="logVariable('realm')" href="../../../../_variables/realm.html">$realm</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a> = null,
<a name="l1908"><span class="linenum">1908</span></a>                           <a class="var it881" onMouseOver="hilite(881)" onMouseOut="lolite()" onClick="logVariable('immediate')" href="../../../../_variables/immediate.html">$immediate</a> = false)
<a name="l1909"><span class="linenum">1909</span></a>      {
<a name="l1910"><span class="linenum">1910</span></a>          <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getMessage')" href="../../../../_functions/getmessage.html" onMouseOver="funcPopup(event,'getmessage')">getMessage</a>(<a class="var it880" onMouseOver="hilite(880)" onMouseOut="lolite()" onClick="logVariable('realm')" href="../../../../_variables/realm.html">$realm</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>, <a class="var it881" onMouseOver="hilite(881)" onMouseOut="lolite()" onClick="logVariable('immediate')" href="../../../../_variables/immediate.html">$immediate</a>);
<a name="l1911"><span class="linenum">1911</span></a>  
<a name="l1912"><span class="linenum">1912</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>)) {
<a name="l1913"><span class="linenum">1913</span></a>              return <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>;
<a name="l1914"><span class="linenum">1914</span></a>          }
<a name="l1915"><span class="linenum">1915</span></a>  
<a name="l1916"><span class="linenum">1916</span></a>          return <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('toURL')" href="../../../../_functions/tourl.html" onMouseOver="funcPopup(event,'tourl')">toURL</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a>-&gt;server_url);
<a name="l1917"><span class="linenum">1917</span></a>      }
<a name="l1918"><span class="linenum">1918</span></a>  
<a name="l1919"><span class="linenum">1919</span></a>      <span class="comment">/**</span>
<a name="l1920"><span class="linenum">1920</span></a>  <span class="comment">     * Get html for a form to submit this request to the IDP.</span>
<a name="l1921"><span class="linenum">1921</span></a>  <span class="comment">     *</span>
<a name="l1922"><span class="linenum">1922</span></a>  <span class="comment">     * form_tag_attrs: An array of attributes to be added to the form</span>
<a name="l1923"><span class="linenum">1923</span></a>  <span class="comment">     * tag. 'accept-charset' and 'enctype' have defaults that can be</span>
<a name="l1924"><span class="linenum">1924</span></a>  <span class="comment">     * overridden. If a value is supplied for 'action' or 'method', it</span>
<a name="l1925"><span class="linenum">1925</span></a>  <span class="comment">     * will be replaced.</span>
<a name="l1926"><span class="linenum">1926</span></a>  <span class="comment">     */</span>
<a name="l1927"><span class="linenum">1927</span></a>      function <a class="function" onClick="logFunction('formMarkup')" href="../../../../_functions/formmarkup.html" onMouseOver="funcPopup(event,'formmarkup')">formMarkup</a>(<a class="var it880" onMouseOver="hilite(880)" onMouseOut="lolite()" onClick="logVariable('realm')" href="../../../../_variables/realm.html">$realm</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>=null, <a class="var it881" onMouseOver="hilite(881)" onMouseOut="lolite()" onClick="logVariable('immediate')" href="../../../../_variables/immediate.html">$immediate</a>=false,
<a name="l1928"><span class="linenum">1928</span></a>                          <a class="var it884" onMouseOver="hilite(884)" onMouseOut="lolite()" onClick="logVariable('form_tag_attrs')" href="../../../../_variables/form_tag_attrs.html">$form_tag_attrs</a>=null)
<a name="l1929"><span class="linenum">1929</span></a>      {
<a name="l1930"><span class="linenum">1930</span></a>          <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getMessage')" href="../../../../_functions/getmessage.html" onMouseOver="funcPopup(event,'getmessage')">getMessage</a>(<a class="var it880" onMouseOver="hilite(880)" onMouseOut="lolite()" onClick="logVariable('realm')" href="../../../../_variables/realm.html">$realm</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>, <a class="var it881" onMouseOver="hilite(881)" onMouseOut="lolite()" onClick="logVariable('immediate')" href="../../../../_variables/immediate.html">$immediate</a>);
<a name="l1931"><span class="linenum">1931</span></a>  
<a name="l1932"><span class="linenum">1932</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>)) {
<a name="l1933"><span class="linenum">1933</span></a>              return <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>;
<a name="l1934"><span class="linenum">1934</span></a>          }
<a name="l1935"><span class="linenum">1935</span></a>  
<a name="l1936"><span class="linenum">1936</span></a>          return <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('toFormMarkup')" href="../../../../_functions/toformmarkup.html" onMouseOver="funcPopup(event,'toformmarkup')">toFormMarkup</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a>-&gt;server_url,
<a name="l1937"><span class="linenum">1937</span></a>                                        <a class="var it884" onMouseOver="hilite(884)" onMouseOut="lolite()" onClick="logVariable('form_tag_attrs')" href="../../../../_variables/form_tag_attrs.html">$form_tag_attrs</a>);
<a name="l1938"><span class="linenum">1938</span></a>      }
<a name="l1939"><span class="linenum">1939</span></a>  
<a name="l1940"><span class="linenum">1940</span></a>      <span class="comment">/**</span>
<a name="l1941"><span class="linenum">1941</span></a>  <span class="comment">     * Get a complete html document that will autosubmit the request</span>
<a name="l1942"><span class="linenum">1942</span></a>  <span class="comment">     * to the IDP.</span>
<a name="l1943"><span class="linenum">1943</span></a>  <span class="comment">     *</span>
<a name="l1944"><span class="linenum">1944</span></a>  <span class="comment">     * Wraps formMarkup.  See the documentation for that function.</span>
<a name="l1945"><span class="linenum">1945</span></a>  <span class="comment">     */</span>
<a name="l1946"><span class="linenum">1946</span></a>      function <a class="function" onClick="logFunction('htmlMarkup')" href="../../../../_functions/htmlmarkup.html" onMouseOver="funcPopup(event,'htmlmarkup')">htmlMarkup</a>(<a class="var it880" onMouseOver="hilite(880)" onMouseOut="lolite()" onClick="logVariable('realm')" href="../../../../_variables/realm.html">$realm</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>=null, <a class="var it881" onMouseOver="hilite(881)" onMouseOut="lolite()" onClick="logVariable('immediate')" href="../../../../_variables/immediate.html">$immediate</a>=false,
<a name="l1947"><span class="linenum">1947</span></a>                          <a class="var it884" onMouseOver="hilite(884)" onMouseOut="lolite()" onClick="logVariable('form_tag_attrs')" href="../../../../_variables/form_tag_attrs.html">$form_tag_attrs</a>=null)
<a name="l1948"><span class="linenum">1948</span></a>      {
<a name="l1949"><span class="linenum">1949</span></a>          <a class="var it885" onMouseOver="hilite(885)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../../_variables/form.html">$form</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('formMarkup')" href="../../../../_functions/formmarkup.html" onMouseOver="funcPopup(event,'formmarkup')">formMarkup</a>(<a class="var it880" onMouseOver="hilite(880)" onMouseOut="lolite()" onClick="logVariable('realm')" href="../../../../_variables/realm.html">$realm</a>, <a class="var it823" onMouseOver="hilite(823)" onMouseOut="lolite()" onClick="logVariable('return_to')" href="../../../../_variables/return_to.html">$return_to</a>, <a class="var it881" onMouseOver="hilite(881)" onMouseOut="lolite()" onClick="logVariable('immediate')" href="../../../../_variables/immediate.html">$immediate</a>, 
<a name="l1950"><span class="linenum">1950</span></a>                                    <a class="var it884" onMouseOver="hilite(884)" onMouseOut="lolite()" onClick="logVariable('form_tag_attrs')" href="../../../../_variables/form_tag_attrs.html">$form_tag_attrs</a>);
<a name="l1951"><span class="linenum">1951</span></a>  
<a name="l1952"><span class="linenum">1952</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it885" onMouseOver="hilite(885)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../../_variables/form.html">$form</a>)) {
<a name="l1953"><span class="linenum">1953</span></a>              return <a class="var it885" onMouseOver="hilite(885)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../../_variables/form.html">$form</a>;
<a name="l1954"><span class="linenum">1954</span></a>          }
<a name="l1955"><span class="linenum">1955</span></a>          return <a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('autoSubmitHTML')" href="../../../../_functions/autosubmithtml.html" onMouseOver="funcPopup(event,'autosubmithtml')">autoSubmitHTML</a>(<a class="var it885" onMouseOver="hilite(885)" onMouseOut="lolite()" onClick="logVariable('form')" href="../../../../_variables/form.html">$form</a>);
<a name="l1956"><span class="linenum">1956</span></a>      }
<a name="l1957"><span class="linenum">1957</span></a>  
<a name="l1958"><span class="linenum">1958</span></a>      function <a class="function" onClick="logFunction('shouldSendRedirect')" href="../../../../_functions/shouldsendredirect.html" onMouseOver="funcPopup(event,'shouldsendredirect')">shouldSendRedirect</a>()
<a name="l1959"><span class="linenum">1959</span></a>      {
<a name="l1960"><span class="linenum">1960</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a>-&gt;<a class="function" onClick="logFunction('compatibilityMode')" href="../../../../_functions/compatibilitymode.html" onMouseOver="funcPopup(event,'compatibilitymode')">compatibilityMode</a>();
<a name="l1961"><span class="linenum">1961</span></a>      }
<a name="l1962"><span class="linenum">1962</span></a>  }
<a name="l1963"><span class="linenum">1963</span></a>  
<a name="l1964"><span class="linenum">1964</span></a>  <span class="comment">/**</span>
<a name="l1965"><span class="linenum">1965</span></a>  <span class="comment"> * The base class for responses from the Auth_OpenID_Consumer.</span>
<a name="l1966"><span class="linenum">1966</span></a>  <span class="comment"> *</span>
<a name="l1967"><span class="linenum">1967</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l1968"><span class="linenum">1968</span></a>  <span class="comment"> */</span>
<a name="l1969"><span class="linenum">1969</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_ConsumerResponse')" href="../../../../_classes/auth_openid_consumerresponse.html" onMouseOver="classPopup(event,'auth_openid_consumerresponse')">Auth_OpenID_ConsumerResponse</a> {
<a name="l1970"><span class="linenum">1970</span></a>      var <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../../_variables/status.html">$status</a> = null;
<a name="l1971"><span class="linenum">1971</span></a>  
<a name="l1972"><span class="linenum">1972</span></a>      function <a class="function" onClick="logFunction('setEndpoint')" href="../../../../_functions/setendpoint.html" onMouseOver="funcPopup(event,'setendpoint')">setEndpoint</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>)
<a name="l1973"><span class="linenum">1973</span></a>      {
<a name="l1974"><span class="linenum">1974</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a> = <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>;
<a name="l1975"><span class="linenum">1975</span></a>          if (<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a> === null) {
<a name="l1976"><span class="linenum">1976</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identity_url')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/identity_url.html">identity_url</a> = null;
<a name="l1977"><span class="linenum">1977</span></a>          } else {
<a name="l1978"><span class="linenum">1978</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identity_url')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/identity_url.html">identity_url</a> = <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>;
<a name="l1979"><span class="linenum">1979</span></a>          }
<a name="l1980"><span class="linenum">1980</span></a>      }
<a name="l1981"><span class="linenum">1981</span></a>  
<a name="l1982"><span class="linenum">1982</span></a>      <span class="comment">/**</span>
<a name="l1983"><span class="linenum">1983</span></a>  <span class="comment">     * Return the display identifier for this response.</span>
<a name="l1984"><span class="linenum">1984</span></a>  <span class="comment">     *</span>
<a name="l1985"><span class="linenum">1985</span></a>  <span class="comment">     * The display identifier is related to the Claimed Identifier, but the</span>
<a name="l1986"><span class="linenum">1986</span></a>  <span class="comment">     * two are not always identical.  The display identifier is something the</span>
<a name="l1987"><span class="linenum">1987</span></a>  <span class="comment">     * user should recognize as what they entered, whereas the response's</span>
<a name="l1988"><span class="linenum">1988</span></a>  <span class="comment">     * claimed identifier (in the identity_url attribute) may have extra</span>
<a name="l1989"><span class="linenum">1989</span></a>  <span class="comment">     * information for better persistence.</span>
<a name="l1990"><span class="linenum">1990</span></a>  <span class="comment">     *</span>
<a name="l1991"><span class="linenum">1991</span></a>  <span class="comment">     * URLs will be stripped of their fragments for display.  XRIs will</span>
<a name="l1992"><span class="linenum">1992</span></a>  <span class="comment">     * display the human-readable identifier (i-name) instead of the</span>
<a name="l1993"><span class="linenum">1993</span></a>  <span class="comment">     * persistent identifier (i-number).</span>
<a name="l1994"><span class="linenum">1994</span></a>  <span class="comment">     *</span>
<a name="l1995"><span class="linenum">1995</span></a>  <span class="comment">     * Use the display identifier in your user interface.  Use</span>
<a name="l1996"><span class="linenum">1996</span></a>  <span class="comment">     * identity_url for querying your database or authorization server.</span>
<a name="l1997"><span class="linenum">1997</span></a>  <span class="comment">     *</span>
<a name="l1998"><span class="linenum">1998</span></a>  <span class="comment">     */</span>
<a name="l1999"><span class="linenum">1999</span></a>      function <a class="function" onClick="logFunction('getDisplayIdentifier')" href="../../../../_functions/getdisplayidentifier.html" onMouseOver="funcPopup(event,'getdisplayidentifier')">getDisplayIdentifier</a>()
<a name="l2000"><span class="linenum">2000</span></a>      {
<a name="l2001"><span class="linenum">2001</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a> !== null) {
<a name="l2002"><span class="linenum">2002</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a>-&gt;<a class="function" onClick="logFunction('getDisplayIdentifier')" href="../../../../_functions/getdisplayidentifier.html" onMouseOver="funcPopup(event,'getdisplayidentifier')">getDisplayIdentifier</a>();
<a name="l2003"><span class="linenum">2003</span></a>          }
<a name="l2004"><span class="linenum">2004</span></a>          return null;
<a name="l2005"><span class="linenum">2005</span></a>      }
<a name="l2006"><span class="linenum">2006</span></a>  }
<a name="l2007"><span class="linenum">2007</span></a>  
<a name="l2008"><span class="linenum">2008</span></a>  <span class="comment">/**</span>
<a name="l2009"><span class="linenum">2009</span></a>  <span class="comment"> * A response with a status of Auth_OpenID_SUCCESS. Indicates that</span>
<a name="l2010"><span class="linenum">2010</span></a>  <span class="comment"> * this request is a successful acknowledgement from the OpenID server</span>
<a name="l2011"><span class="linenum">2011</span></a>  <span class="comment"> * that the supplied URL is, indeed controlled by the requesting</span>
<a name="l2012"><span class="linenum">2012</span></a>  <span class="comment"> * agent.  This has three relevant attributes:</span>
<a name="l2013"><span class="linenum">2013</span></a>  <span class="comment"> *</span>
<a name="l2014"><span class="linenum">2014</span></a>  <span class="comment"> * claimed_id - The identity URL that has been authenticated</span>
<a name="l2015"><span class="linenum">2015</span></a>  <span class="comment"> *</span>
<a name="l2016"><span class="linenum">2016</span></a>  <span class="comment"> * signed_args - The arguments in the server's response that were</span>
<a name="l2017"><span class="linenum">2017</span></a>  <span class="comment"> * signed and verified.</span>
<a name="l2018"><span class="linenum">2018</span></a>  <span class="comment"> *</span>
<a name="l2019"><span class="linenum">2019</span></a>  <span class="comment"> * status - Auth_OpenID_SUCCESS.</span>
<a name="l2020"><span class="linenum">2020</span></a>  <span class="comment"> *</span>
<a name="l2021"><span class="linenum">2021</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l2022"><span class="linenum">2022</span></a>  <span class="comment"> */</span>
<a name="l2023"><span class="linenum">2023</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_SuccessResponse')" href="../../../../_classes/auth_openid_successresponse.html" onMouseOver="classPopup(event,'auth_openid_successresponse')">Auth_OpenID_SuccessResponse</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('Auth_OpenID_ConsumerResponse')" href="../../../../_classes/auth_openid_consumerresponse.html" onMouseOver="classPopup(event,'auth_openid_consumerresponse')">Auth_OpenID_ConsumerResponse</a> {
<a name="l2024"><span class="linenum">2024</span></a>      var <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../../_variables/status.html">$status</a> = Auth_OpenID_SUCCESS;
<a name="l2025"><span class="linenum">2025</span></a>  
<a name="l2026"><span class="linenum">2026</span></a>      <span class="comment">/**</span>
<a name="l2027"><span class="linenum">2027</span></a>  <span class="comment">     * @access private</span>
<a name="l2028"><span class="linenum">2028</span></a>  <span class="comment">     */</span>
<a name="l2029"><span class="linenum">2029</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_SuccessResponse')" href="../../../../_functions/auth_openid_successresponse.html" onMouseOver="funcPopup(event,'auth_openid_successresponse')">Auth_OpenID_SuccessResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>, <a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('signed_args')" href="../../../../_variables/signed_args.html">$signed_args</a>=null)
<a name="l2030"><span class="linenum">2030</span></a>      {
<a name="l2031"><span class="linenum">2031</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('endpoint')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/endpoint.html">endpoint</a> = <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>;
<a name="l2032"><span class="linenum">2032</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('identity_url')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/identity_url.html">identity_url</a> = <a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>-&gt;<a onClick="logVariable('claimed_id')" class="var it2308" onMouseOver="hilite(2308)" onMouseOut="lolite()" href="../../../../_variables/claimed_id.html">claimed_id</a>;
<a name="l2033"><span class="linenum">2033</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('signed_args')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/signed_args.html">signed_args</a> = <a class="var it886" onMouseOver="hilite(886)" onMouseOut="lolite()" onClick="logVariable('signed_args')" href="../../../../_variables/signed_args.html">$signed_args</a>;
<a name="l2034"><span class="linenum">2034</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>;
<a name="l2035"><span class="linenum">2035</span></a>  
<a name="l2036"><span class="linenum">2036</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('signed_args')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/signed_args.html">signed_args</a> === null) {
<a name="l2037"><span class="linenum">2037</span></a>              <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('signed_args')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/signed_args.html">signed_args</a> = array();
<a name="l2038"><span class="linenum">2038</span></a>          }
<a name="l2039"><span class="linenum">2039</span></a>      }
<a name="l2040"><span class="linenum">2040</span></a>  
<a name="l2041"><span class="linenum">2041</span></a>      <span class="comment">/**</span>
<a name="l2042"><span class="linenum">2042</span></a>  <span class="comment">     * Extract signed extension data from the server's response.</span>
<a name="l2043"><span class="linenum">2043</span></a>  <span class="comment">     *</span>
<a name="l2044"><span class="linenum">2044</span></a>  <span class="comment">     * @param string $prefix The extension namespace from which to</span>
<a name="l2045"><span class="linenum">2045</span></a>  <span class="comment">     * extract the extension data.</span>
<a name="l2046"><span class="linenum">2046</span></a>  <span class="comment">     */</span>
<a name="l2047"><span class="linenum">2047</span></a>      function <a class="function" onClick="logFunction('extensionResponse')" href="../../../../_functions/extensionresponse.html" onMouseOver="funcPopup(event,'extensionresponse')">extensionResponse</a>(<a class="var it887" onMouseOver="hilite(887)" onMouseOut="lolite()" onClick="logVariable('namespace_uri')" href="../../../../_variables/namespace_uri.html">$namespace_uri</a>, <a class="var it888" onMouseOver="hilite(888)" onMouseOut="lolite()" onClick="logVariable('require_signed')" href="../../../../_variables/require_signed.html">$require_signed</a>)
<a name="l2048"><span class="linenum">2048</span></a>      {
<a name="l2049"><span class="linenum">2049</span></a>          if (<a class="var it888" onMouseOver="hilite(888)" onMouseOut="lolite()" onClick="logVariable('require_signed')" href="../../../../_variables/require_signed.html">$require_signed</a>) {
<a name="l2050"><span class="linenum">2050</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getSignedNS')" href="../../../../_functions/getsignedns.html" onMouseOver="funcPopup(event,'getsignedns')">getSignedNS</a>(<a class="var it887" onMouseOver="hilite(887)" onMouseOut="lolite()" onClick="logVariable('namespace_uri')" href="../../../../_variables/namespace_uri.html">$namespace_uri</a>);
<a name="l2051"><span class="linenum">2051</span></a>          } else {
<a name="l2052"><span class="linenum">2052</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('getArgs')" href="../../../../_functions/getargs.html" onMouseOver="funcPopup(event,'getargs')">getArgs</a>(<a class="var it887" onMouseOver="hilite(887)" onMouseOut="lolite()" onClick="logVariable('namespace_uri')" href="../../../../_variables/namespace_uri.html">$namespace_uri</a>);
<a name="l2053"><span class="linenum">2053</span></a>          }
<a name="l2054"><span class="linenum">2054</span></a>      }
<a name="l2055"><span class="linenum">2055</span></a>  
<a name="l2056"><span class="linenum">2056</span></a>      function <a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>()
<a name="l2057"><span class="linenum">2057</span></a>      {
<a name="l2058"><span class="linenum">2058</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('isOpenID1')" href="../../../../_functions/isopenid1.html" onMouseOver="funcPopup(event,'isopenid1')">isOpenID1</a>();
<a name="l2059"><span class="linenum">2059</span></a>      }
<a name="l2060"><span class="linenum">2060</span></a>  
<a name="l2061"><span class="linenum">2061</span></a>      function <a class="function" onClick="logFunction('isSigned')" href="../../../../_functions/issigned.html" onMouseOver="funcPopup(event,'issigned')">isSigned</a>(<a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('ns_uri')" href="../../../../_variables/ns_uri.html">$ns_uri</a>, <a class="var it889" onMouseOver="hilite(889)" onMouseOut="lolite()" onClick="logVariable('ns_key')" href="../../../../_variables/ns_key.html">$ns_key</a>)
<a name="l2062"><span class="linenum">2062</span></a>      {
<a name="l2063"><span class="linenum">2063</span></a>  <span class="comment">        // Return whether a particular key is signed, regardless of</span>
<a name="l2064"><span class="linenum">2064</span></a>  <span class="comment">        // its namespace alias</span>
<a name="l2065"><span class="linenum">2065</span></a>          return <a class="phpfunction" onClick="logFunction('in_array')" href="../../../../_functions/in_array.html" onMouseOver="phpfuncPopup(event,'in_array')">in_array</a>(<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('getKey')" href="../../../../_functions/getkey.html" onMouseOver="funcPopup(event,'getkey')">getKey</a>(<a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('ns_uri')" href="../../../../_variables/ns_uri.html">$ns_uri</a>, <a class="var it889" onMouseOver="hilite(889)" onMouseOut="lolite()" onClick="logVariable('ns_key')" href="../../../../_variables/ns_key.html">$ns_key</a>),
<a name="l2066"><span class="linenum">2066</span></a>                          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('signed_args')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/signed_args.html">signed_args</a>);
<a name="l2067"><span class="linenum">2067</span></a>      }
<a name="l2068"><span class="linenum">2068</span></a>  
<a name="l2069"><span class="linenum">2069</span></a>      function <a class="function" onClick="logFunction('getSigned')" href="../../../../_functions/getsigned.html" onMouseOver="funcPopup(event,'getsigned')">getSigned</a>(<a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('ns_uri')" href="../../../../_variables/ns_uri.html">$ns_uri</a>, <a class="var it889" onMouseOver="hilite(889)" onMouseOut="lolite()" onClick="logVariable('ns_key')" href="../../../../_variables/ns_key.html">$ns_key</a>, <a class="var it617" onMouseOver="hilite(617)" onMouseOut="lolite()" onClick="logVariable('default')" href="../../../../_variables/default.html">$default</a> = null)
<a name="l2070"><span class="linenum">2070</span></a>      {
<a name="l2071"><span class="linenum">2071</span></a>  <span class="comment">        // Return the specified signed field if available, otherwise</span>
<a name="l2072"><span class="linenum">2072</span></a>  <span class="comment">        // return default</span>
<a name="l2073"><span class="linenum">2073</span></a>          if (<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('isSigned')" href="../../../../_functions/issigned.html" onMouseOver="funcPopup(event,'issigned')">isSigned</a>(<a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('ns_uri')" href="../../../../_variables/ns_uri.html">$ns_uri</a>, <a class="var it889" onMouseOver="hilite(889)" onMouseOut="lolite()" onClick="logVariable('ns_key')" href="../../../../_variables/ns_key.html">$ns_key</a>)) {
<a name="l2074"><span class="linenum">2074</span></a>              return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(<a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('ns_uri')" href="../../../../_variables/ns_uri.html">$ns_uri</a>, <a class="var it889" onMouseOver="hilite(889)" onMouseOut="lolite()" onClick="logVariable('ns_key')" href="../../../../_variables/ns_key.html">$ns_key</a>, <a class="var it617" onMouseOver="hilite(617)" onMouseOut="lolite()" onClick="logVariable('default')" href="../../../../_variables/default.html">$default</a>);
<a name="l2075"><span class="linenum">2075</span></a>          } else {
<a name="l2076"><span class="linenum">2076</span></a>              return <a class="var it617" onMouseOver="hilite(617)" onMouseOut="lolite()" onClick="logVariable('default')" href="../../../../_variables/default.html">$default</a>;
<a name="l2077"><span class="linenum">2077</span></a>          }
<a name="l2078"><span class="linenum">2078</span></a>      }
<a name="l2079"><span class="linenum">2079</span></a>  
<a name="l2080"><span class="linenum">2080</span></a>      function <a class="function" onClick="logFunction('getSignedNS')" href="../../../../_functions/getsignedns.html" onMouseOver="funcPopup(event,'getsignedns')">getSignedNS</a>(<a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('ns_uri')" href="../../../../_variables/ns_uri.html">$ns_uri</a>)
<a name="l2081"><span class="linenum">2081</span></a>      {
<a name="l2082"><span class="linenum">2082</span></a>          <a class="var it356" onMouseOver="hilite(356)" onMouseOut="lolite()" onClick="logVariable('args')" href="../../../../_variables/args.html">$args</a> = array();
<a name="l2083"><span class="linenum">2083</span></a>  
<a name="l2084"><span class="linenum">2084</span></a>          <a class="var it890" onMouseOver="hilite(890)" onMouseOut="lolite()" onClick="logVariable('msg_args')" href="../../../../_variables/msg_args.html">$msg_args</a> = <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a>-&gt;<a class="function" onClick="logFunction('getArgs')" href="../../../../_functions/getargs.html" onMouseOver="funcPopup(event,'getargs')">getArgs</a>(<a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('ns_uri')" href="../../../../_variables/ns_uri.html">$ns_uri</a>);
<a name="l2085"><span class="linenum">2085</span></a>          if (<a class="class" onClick="logClass('Auth_OpenID')" href="../../../../_classes/auth_openid.html" onMouseOver="classPopup(event,'auth_openid')">Auth_OpenID</a>::<a class="function" onClick="logFunction('isFailure')" href="../../../../_functions/isfailure.html" onMouseOver="funcPopup(event,'isfailure')">isFailure</a>(<a class="var it890" onMouseOver="hilite(890)" onMouseOut="lolite()" onClick="logVariable('msg_args')" href="../../../../_variables/msg_args.html">$msg_args</a>)) {
<a name="l2086"><span class="linenum">2086</span></a>              return null;
<a name="l2087"><span class="linenum">2087</span></a>          }
<a name="l2088"><span class="linenum">2088</span></a>  
<a name="l2089"><span class="linenum">2089</span></a>          foreach (<a class="var it890" onMouseOver="hilite(890)" onMouseOut="lolite()" onClick="logVariable('msg_args')" href="../../../../_variables/msg_args.html">$msg_args</a> as <a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a> =&gt; <a class="var it4" onMouseOver="hilite(4)" onMouseOut="lolite()" onClick="logVariable('value')" href="../../../../_variables/value.html">$value</a>) {
<a name="l2090"><span class="linenum">2090</span></a>              if (!<a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('isSigned')" href="../../../../_functions/issigned.html" onMouseOver="funcPopup(event,'issigned')">isSigned</a>(<a class="var it282" onMouseOver="hilite(282)" onMouseOut="lolite()" onClick="logVariable('ns_uri')" href="../../../../_variables/ns_uri.html">$ns_uri</a>, <a class="var it100" onMouseOver="hilite(100)" onMouseOut="lolite()" onClick="logVariable('key')" href="../../../../_variables/key.html">$key</a>)) {
<a name="l2091"><span class="linenum">2091</span></a>                  return null;
<a name="l2092"><span class="linenum">2092</span></a>              }
<a name="l2093"><span class="linenum">2093</span></a>          }
<a name="l2094"><span class="linenum">2094</span></a>  
<a name="l2095"><span class="linenum">2095</span></a>          return <a class="var it890" onMouseOver="hilite(890)" onMouseOut="lolite()" onClick="logVariable('msg_args')" href="../../../../_variables/msg_args.html">$msg_args</a>;
<a name="l2096"><span class="linenum">2096</span></a>      }
<a name="l2097"><span class="linenum">2097</span></a>  
<a name="l2098"><span class="linenum">2098</span></a>      <span class="comment">/**</span>
<a name="l2099"><span class="linenum">2099</span></a>  <span class="comment">     * Get the openid.return_to argument from this response.</span>
<a name="l2100"><span class="linenum">2100</span></a>  <span class="comment">     *</span>
<a name="l2101"><span class="linenum">2101</span></a>  <span class="comment">     * This is useful for verifying that this request was initiated by</span>
<a name="l2102"><span class="linenum">2102</span></a>  <span class="comment">     * this consumer.</span>
<a name="l2103"><span class="linenum">2103</span></a>  <span class="comment">     *</span>
<a name="l2104"><span class="linenum">2104</span></a>  <span class="comment">     * @return string $return_to The return_to URL supplied to the</span>
<a name="l2105"><span class="linenum">2105</span></a>  <span class="comment">     * server on the initial request, or null if the response did not</span>
<a name="l2106"><span class="linenum">2106</span></a>  <span class="comment">     * contain an 'openid.return_to' argument.</span>
<a name="l2107"><span class="linenum">2107</span></a>  <span class="comment">    */</span>
<a name="l2108"><span class="linenum">2108</span></a>      function <a class="function" onClick="logFunction('getReturnTo')" href="../../../../_functions/getreturnto.html" onMouseOver="funcPopup(event,'getreturnto')">getReturnTo</a>()
<a name="l2109"><span class="linenum">2109</span></a>      {
<a name="l2110"><span class="linenum">2110</span></a>          return <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('getSigned')" href="../../../../_functions/getsigned.html" onMouseOver="funcPopup(event,'getsigned')">getSigned</a>(Auth_OpenID_OPENID_NS, 'return_to');
<a name="l2111"><span class="linenum">2111</span></a>      }
<a name="l2112"><span class="linenum">2112</span></a>  }
<a name="l2113"><span class="linenum">2113</span></a>  
<a name="l2114"><span class="linenum">2114</span></a>  <span class="comment">/**</span>
<a name="l2115"><span class="linenum">2115</span></a>  <span class="comment"> * A response with a status of Auth_OpenID_FAILURE. Indicates that the</span>
<a name="l2116"><span class="linenum">2116</span></a>  <span class="comment"> * OpenID protocol has failed. This could be locally or remotely</span>
<a name="l2117"><span class="linenum">2117</span></a>  <span class="comment"> * triggered.  This has three relevant attributes:</span>
<a name="l2118"><span class="linenum">2118</span></a>  <span class="comment"> *</span>
<a name="l2119"><span class="linenum">2119</span></a>  <span class="comment"> * claimed_id - The identity URL for which authentication was</span>
<a name="l2120"><span class="linenum">2120</span></a>  <span class="comment"> * attempted, if it can be determined.  Otherwise, null.</span>
<a name="l2121"><span class="linenum">2121</span></a>  <span class="comment"> *</span>
<a name="l2122"><span class="linenum">2122</span></a>  <span class="comment"> * message - A message indicating why the request failed, if one is</span>
<a name="l2123"><span class="linenum">2123</span></a>  <span class="comment"> * supplied.  Otherwise, null.</span>
<a name="l2124"><span class="linenum">2124</span></a>  <span class="comment"> *</span>
<a name="l2125"><span class="linenum">2125</span></a>  <span class="comment"> * status - Auth_OpenID_FAILURE.</span>
<a name="l2126"><span class="linenum">2126</span></a>  <span class="comment"> *</span>
<a name="l2127"><span class="linenum">2127</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l2128"><span class="linenum">2128</span></a>  <span class="comment"> */</span>
<a name="l2129"><span class="linenum">2129</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('Auth_OpenID_ConsumerResponse')" href="../../../../_classes/auth_openid_consumerresponse.html" onMouseOver="classPopup(event,'auth_openid_consumerresponse')">Auth_OpenID_ConsumerResponse</a> {
<a name="l2130"><span class="linenum">2130</span></a>      var <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../../_variables/status.html">$status</a> = Auth_OpenID_FAILURE;
<a name="l2131"><span class="linenum">2131</span></a>  
<a name="l2132"><span class="linenum">2132</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_FailureResponse')" href="../../../../_functions/auth_openid_failureresponse.html" onMouseOver="funcPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>, <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a> = null,
<a name="l2133"><span class="linenum">2133</span></a>                                           <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../../../../_variables/contact.html">$contact</a> = null, <a class="var it827" onMouseOver="hilite(827)" onMouseOut="lolite()" onClick="logVariable('reference')" href="../../../../_variables/reference.html">$reference</a> = null)
<a name="l2134"><span class="linenum">2134</span></a>      {
<a name="l2135"><span class="linenum">2135</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setEndpoint')" href="../../../../_functions/setendpoint.html" onMouseOver="funcPopup(event,'setendpoint')">setEndpoint</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l2136"><span class="linenum">2136</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>;
<a name="l2137"><span class="linenum">2137</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('contact')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/contact.html">contact</a> = <a class="var it826" onMouseOver="hilite(826)" onMouseOut="lolite()" onClick="logVariable('contact')" href="../../../../_variables/contact.html">$contact</a>;
<a name="l2138"><span class="linenum">2138</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('reference')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/reference.html">reference</a> = <a class="var it827" onMouseOver="hilite(827)" onMouseOut="lolite()" onClick="logVariable('reference')" href="../../../../_variables/reference.html">$reference</a>;
<a name="l2139"><span class="linenum">2139</span></a>      }
<a name="l2140"><span class="linenum">2140</span></a>  }
<a name="l2141"><span class="linenum">2141</span></a>  
<a name="l2142"><span class="linenum">2142</span></a>  <span class="comment">/**</span>
<a name="l2143"><span class="linenum">2143</span></a>  <span class="comment"> * A specific, internal failure used to detect type URI mismatch.</span>
<a name="l2144"><span class="linenum">2144</span></a>  <span class="comment"> *</span>
<a name="l2145"><span class="linenum">2145</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l2146"><span class="linenum">2146</span></a>  <span class="comment"> */</span>
<a name="l2147"><span class="linenum">2147</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_TypeURIMismatch')" href="../../../../_classes/auth_openid_typeurimismatch.html" onMouseOver="classPopup(event,'auth_openid_typeurimismatch')">Auth_OpenID_TypeURIMismatch</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('Auth_OpenID_FailureResponse')" href="../../../../_classes/auth_openid_failureresponse.html" onMouseOver="classPopup(event,'auth_openid_failureresponse')">Auth_OpenID_FailureResponse</a> {
<a name="l2148"><span class="linenum">2148</span></a>  }
<a name="l2149"><span class="linenum">2149</span></a>  
<a name="l2150"><span class="linenum">2150</span></a>  <span class="comment">/**</span>
<a name="l2151"><span class="linenum">2151</span></a>  <span class="comment"> * Exception that is raised when the server returns a 400 response</span>
<a name="l2152"><span class="linenum">2152</span></a>  <span class="comment"> * code to a direct request.</span>
<a name="l2153"><span class="linenum">2153</span></a>  <span class="comment"> *</span>
<a name="l2154"><span class="linenum">2154</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l2155"><span class="linenum">2155</span></a>  <span class="comment"> */</span>
<a name="l2156"><span class="linenum">2156</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_ServerErrorContainer')" href="../../../../_classes/auth_openid_servererrorcontainer.html" onMouseOver="classPopup(event,'auth_openid_servererrorcontainer')">Auth_OpenID_ServerErrorContainer</a> {
<a name="l2157"><span class="linenum">2157</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_ServerErrorContainer')" href="../../../../_functions/auth_openid_servererrorcontainer.html" onMouseOver="funcPopup(event,'auth_openid_servererrorcontainer')">Auth_OpenID_ServerErrorContainer</a>(<a class="var it891" onMouseOver="hilite(891)" onMouseOut="lolite()" onClick="logVariable('error_text')" href="../../../../_variables/error_text.html">$error_text</a>,
<a name="l2158"><span class="linenum">2158</span></a>                                                <a class="var it866" onMouseOver="hilite(866)" onMouseOut="lolite()" onClick="logVariable('error_code')" href="../../../../_variables/error_code.html">$error_code</a>,
<a name="l2159"><span class="linenum">2159</span></a>                                                <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>)
<a name="l2160"><span class="linenum">2160</span></a>      {
<a name="l2161"><span class="linenum">2161</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('error_text')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/error_text.html">error_text</a> = <a class="var it891" onMouseOver="hilite(891)" onMouseOut="lolite()" onClick="logVariable('error_text')" href="../../../../_variables/error_text.html">$error_text</a>;
<a name="l2162"><span class="linenum">2162</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('error_code')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/error_code.html">error_code</a> = <a class="var it866" onMouseOver="hilite(866)" onMouseOut="lolite()" onClick="logVariable('error_code')" href="../../../../_variables/error_code.html">$error_code</a>;
<a name="l2163"><span class="linenum">2163</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('message')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/message.html">message</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>;
<a name="l2164"><span class="linenum">2164</span></a>      }
<a name="l2165"><span class="linenum">2165</span></a>  
<a name="l2166"><span class="linenum">2166</span></a>      <span class="comment">/**</span>
<a name="l2167"><span class="linenum">2167</span></a>  <span class="comment">     * @access private</span>
<a name="l2168"><span class="linenum">2168</span></a>  <span class="comment">     */</span>
<a name="l2169"><span class="linenum">2169</span></a>      function <a class="function" onClick="logFunction('fromMessage')" href="../../../../_functions/frommessage.html" onMouseOver="funcPopup(event,'frommessage')">fromMessage</a>(<a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>)
<a name="l2170"><span class="linenum">2170</span></a>      {
<a name="l2171"><span class="linenum">2171</span></a>          <a class="var it891" onMouseOver="hilite(891)" onMouseOut="lolite()" onClick="logVariable('error_text')" href="../../../../_variables/error_text.html">$error_text</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(
<a name="l2172"><span class="linenum">2172</span></a>             Auth_OpenID_OPENID_NS, 'error', '&lt;no error message supplied&gt;');
<a name="l2173"><span class="linenum">2173</span></a>          <a class="var it866" onMouseOver="hilite(866)" onMouseOut="lolite()" onClick="logVariable('error_code')" href="../../../../_variables/error_code.html">$error_code</a> = <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>-&gt;<a class="function" onClick="logFunction('getArg')" href="../../../../_functions/getarg.html" onMouseOver="funcPopup(event,'getarg')">getArg</a>(Auth_OpenID_OPENID_NS, 'error_code');
<a name="l2174"><span class="linenum">2174</span></a>          return <span class="keyword">new </span><a class="class" onClick="logClass('Auth_OpenID_ServerErrorContainer')" href="../../../../_classes/auth_openid_servererrorcontainer.html" onMouseOver="classPopup(event,'auth_openid_servererrorcontainer')">Auth_OpenID_ServerErrorContainer</a>(<a class="var it891" onMouseOver="hilite(891)" onMouseOut="lolite()" onClick="logVariable('error_text')" href="../../../../_variables/error_text.html">$error_text</a>,
<a name="l2175"><span class="linenum">2175</span></a>                                                      <a class="var it866" onMouseOver="hilite(866)" onMouseOut="lolite()" onClick="logVariable('error_code')" href="../../../../_variables/error_code.html">$error_code</a>,
<a name="l2176"><span class="linenum">2176</span></a>                                                      <a class="var it284" onMouseOver="hilite(284)" onMouseOut="lolite()" onClick="logVariable('message')" href="../../../../_variables/message.html">$message</a>);
<a name="l2177"><span class="linenum">2177</span></a>      }
<a name="l2178"><span class="linenum">2178</span></a>  }
<a name="l2179"><span class="linenum">2179</span></a>  
<a name="l2180"><span class="linenum">2180</span></a>  <span class="comment">/**</span>
<a name="l2181"><span class="linenum">2181</span></a>  <span class="comment"> * A response with a status of Auth_OpenID_CANCEL. Indicates that the</span>
<a name="l2182"><span class="linenum">2182</span></a>  <span class="comment"> * user cancelled the OpenID authentication request.  This has two</span>
<a name="l2183"><span class="linenum">2183</span></a>  <span class="comment"> * relevant attributes:</span>
<a name="l2184"><span class="linenum">2184</span></a>  <span class="comment"> *</span>
<a name="l2185"><span class="linenum">2185</span></a>  <span class="comment"> * claimed_id - The identity URL for which authentication was</span>
<a name="l2186"><span class="linenum">2186</span></a>  <span class="comment"> * attempted, if it can be determined.  Otherwise, null.</span>
<a name="l2187"><span class="linenum">2187</span></a>  <span class="comment"> *</span>
<a name="l2188"><span class="linenum">2188</span></a>  <span class="comment"> * status - Auth_OpenID_SUCCESS.</span>
<a name="l2189"><span class="linenum">2189</span></a>  <span class="comment"> *</span>
<a name="l2190"><span class="linenum">2190</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l2191"><span class="linenum">2191</span></a>  <span class="comment"> */</span>
<a name="l2192"><span class="linenum">2192</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_CancelResponse')" href="../../../../_classes/auth_openid_cancelresponse.html" onMouseOver="classPopup(event,'auth_openid_cancelresponse')">Auth_OpenID_CancelResponse</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('Auth_OpenID_ConsumerResponse')" href="../../../../_classes/auth_openid_consumerresponse.html" onMouseOver="classPopup(event,'auth_openid_consumerresponse')">Auth_OpenID_ConsumerResponse</a> {
<a name="l2193"><span class="linenum">2193</span></a>      var <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../../_variables/status.html">$status</a> = Auth_OpenID_CANCEL;
<a name="l2194"><span class="linenum">2194</span></a>  
<a name="l2195"><span class="linenum">2195</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_CancelResponse')" href="../../../../_functions/auth_openid_cancelresponse.html" onMouseOver="funcPopup(event,'auth_openid_cancelresponse')">Auth_OpenID_CancelResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>)
<a name="l2196"><span class="linenum">2196</span></a>      {
<a name="l2197"><span class="linenum">2197</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setEndpoint')" href="../../../../_functions/setendpoint.html" onMouseOver="funcPopup(event,'setendpoint')">setEndpoint</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l2198"><span class="linenum">2198</span></a>      }
<a name="l2199"><span class="linenum">2199</span></a>  }
<a name="l2200"><span class="linenum">2200</span></a>  
<a name="l2201"><span class="linenum">2201</span></a>  <span class="comment">/**</span>
<a name="l2202"><span class="linenum">2202</span></a>  <span class="comment"> * A response with a status of Auth_OpenID_SETUP_NEEDED. Indicates</span>
<a name="l2203"><span class="linenum">2203</span></a>  <span class="comment"> * that the request was in immediate mode, and the server is unable to</span>
<a name="l2204"><span class="linenum">2204</span></a>  <span class="comment"> * authenticate the user without further interaction.</span>
<a name="l2205"><span class="linenum">2205</span></a>  <span class="comment"> *</span>
<a name="l2206"><span class="linenum">2206</span></a>  <span class="comment"> * claimed_id - The identity URL for which authentication was</span>
<a name="l2207"><span class="linenum">2207</span></a>  <span class="comment"> * attempted.</span>
<a name="l2208"><span class="linenum">2208</span></a>  <span class="comment"> *</span>
<a name="l2209"><span class="linenum">2209</span></a>  <span class="comment"> * setup_url - A URL that can be used to send the user to the server</span>
<a name="l2210"><span class="linenum">2210</span></a>  <span class="comment"> * to set up for authentication. The user should be redirected in to</span>
<a name="l2211"><span class="linenum">2211</span></a>  <span class="comment"> * the setup_url, either in the current window or in a new browser</span>
<a name="l2212"><span class="linenum">2212</span></a>  <span class="comment"> * window.  Null in OpenID 2.</span>
<a name="l2213"><span class="linenum">2213</span></a>  <span class="comment"> *</span>
<a name="l2214"><span class="linenum">2214</span></a>  <span class="comment"> * status - Auth_OpenID_SETUP_NEEDED.</span>
<a name="l2215"><span class="linenum">2215</span></a>  <span class="comment"> *</span>
<a name="l2216"><span class="linenum">2216</span></a>  <span class="comment"> * @package OpenID</span>
<a name="l2217"><span class="linenum">2217</span></a>  <span class="comment"> */</span>
<a name="l2218"><span class="linenum">2218</span></a>  <span class="keyword">class </span><a class="class" onClick="logClass('Auth_OpenID_SetupNeededResponse')" href="../../../../_classes/auth_openid_setupneededresponse.html" onMouseOver="classPopup(event,'auth_openid_setupneededresponse')">Auth_OpenID_SetupNeededResponse</a> <span class="keyword">extends</span> <a class="class" onClick="logClass('Auth_OpenID_ConsumerResponse')" href="../../../../_classes/auth_openid_consumerresponse.html" onMouseOver="classPopup(event,'auth_openid_consumerresponse')">Auth_OpenID_ConsumerResponse</a> {
<a name="l2219"><span class="linenum">2219</span></a>      var <a class="var it43" onMouseOver="hilite(43)" onMouseOut="lolite()" onClick="logVariable('status')" href="../../../../_variables/status.html">$status</a> = Auth_OpenID_SETUP_NEEDED;
<a name="l2220"><span class="linenum">2220</span></a>  
<a name="l2221"><span class="linenum">2221</span></a>      function <a class="function" onClick="logFunction('Auth_OpenID_SetupNeededResponse')" href="../../../../_functions/auth_openid_setupneededresponse.html" onMouseOver="funcPopup(event,'auth_openid_setupneededresponse')">Auth_OpenID_SetupNeededResponse</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>,
<a name="l2222"><span class="linenum">2222</span></a>                                               <a class="var it892" onMouseOver="hilite(892)" onMouseOut="lolite()" onClick="logVariable('setup_url')" href="../../../../_variables/setup_url.html">$setup_url</a> = null)
<a name="l2223"><span class="linenum">2223</span></a>      {
<a name="l2224"><span class="linenum">2224</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a class="function" onClick="logFunction('setEndpoint')" href="../../../../_functions/setendpoint.html" onMouseOver="funcPopup(event,'setendpoint')">setEndpoint</a>(<a class="var it800" onMouseOver="hilite(800)" onMouseOut="lolite()" onClick="logVariable('endpoint')" href="../../../../_variables/endpoint.html">$endpoint</a>);
<a name="l2225"><span class="linenum">2225</span></a>          <a class="var it5" onMouseOver="hilite(5)" onMouseOut="lolite()" onClick="logVariable('this')" href="../../../../_variables/this.html">$this</a>-&gt;<a onClick="logVariable('setup_url')" class="var it2267" onMouseOver="hilite(2267)" onMouseOut="lolite()" href="../../../../_variables/setup_url.html">setup_url</a> = <a class="var it892" onMouseOver="hilite(892)" onMouseOut="lolite()" onClick="logVariable('setup_url')" href="../../../../_variables/setup_url.html">$setup_url</a>;
<a name="l2226"><span class="linenum">2226</span></a>      }
<a name="l2227"><span class="linenum">2227</span></a>  }
<a name="l2228"><span class="linenum">2228</span></a>  
<a name="l2229"><span class="linenum">2229</span></a>  ?&gt;
</pre>
</div>
<script language="JavaScript" type="text/javascript">
FUNC_DATA={
'auth_openid_cancelresponse': ['auth_openid_cancelresponse', '', [['admin/oauth/Auth/OpenID','Consumer.php',2195]], 1],
'gethttpfetcher': ['gethttpfetcher', 'Returns an HTTP fetcher object.  If the CURL extension is present, an instance of {@link Auth_Yadis_ParanoidHTTPFetcher} is returned.  If not, an instance of {@link Auth_Yadis_PlainHTTPFetcher} is returned. ', [['admin/oauth/Auth/Yadis','Yadis.php',244]], 4],
'_createcheckauthrequest': ['_createcheckauthrequest', '', [['admin/oauth/Auth/OpenID','Consumer.php',1352]], 1],
'fromopendpointurl': ['fromopendpointurl', '', [['admin/oauth/Auth/OpenID','Discover.php',127]], 1],
'auth_openid_getdefaultnegotiator': ['auth_openid_getdefaultnegotiator', '', [['admin/oauth/Auth/OpenID','Association.php',472]], 2],
'setarg': ['setarg', '', [['admin/oauth/Auth/OpenID','Message.php',861]], 29],
'getexpiresin': ['getexpiresin', 'This returns the number of seconds this association is still valid for, or 0 if the association is no longer valid. ', [['admin/oauth/Auth/OpenID','Association.php',147]], 11],
'longtobase64': ['longtobase64', '', [['admin/oauth/Auth/OpenID','BigMath.php',123]], 4],
'_makekvpost': ['_makekvpost', '', [['admin/oauth/Auth/OpenID','Consumer.php',1417]], 2],
'isallowed': ['isallowed', '', [['fckeditor/editor/filemanager/connectors/asp','class_upload.asp',276],['admin/oauth/Auth/OpenID','Association.php',588]], 3],
'getkey': ['getkey', '', [['admin/oauth/Zend/Gdata/Gbase','Query.php',175],['admin/oauth/Auth/OpenID','Message.php',778]], 2],
'setendpoint': ['setendpoint', '', [['admin/oauth/Auth/OpenID','Consumer.php',1972]], 5],
'_checkauth': ['_checkauth', '', [['admin/oauth/Auth/OpenID','Consumer.php',1333]], 1],
'isopenid2': ['isopenid2', '', [['admin/oauth/Auth/OpenID','Message.php',440]], 5],
'_verifyreturntoargs': ['_verifyreturntoargs', '', [['admin/oauth/Auth/OpenID','Consumer.php',880]], 1],
'_negotiateassociation': ['_negotiateassociation', '', [['admin/oauth/Auth/OpenID','Consumer.php',1498]], 1],
'isfailure': ['isfailure', '', [['admin/oauth/Auth/Yadis','Yadis.php',83],['admin/oauth/Auth','OpenID.php',117]], 38],
'_verifydiscoveryresultsopenid1': ['_verifydiscoveryresultsopenid1', '', [['admin/oauth/Auth/OpenID','Consumer.php',994]], 1],
'tomessage': ['tomessage', 'Add the arguments from this extension to the provided message. ', [['admin/oauth/Auth/OpenID','Extension.php',37],['admin/oauth/Auth/OpenID','Server.php',220]], 4],
'_extractassociation': ['_extractassociation', '', [['admin/oauth/Auth/OpenID','Consumer.php',1568]], 1],
'getmessage': ['getmessage', 'Produce a {@link Auth_OpenID_Message} representing this request. ', [['admin/oauth/Auth/OpenID','Consumer.php',1814],['admin/oauth/Zend/Http','Response.php',323]], 8],
'arrayget': ['arrayget', 'Convenience function for getting array values.  Given an array $arr and a key $key, get the corresponding value from the array or return $default if the key is absent. ', [['admin/oauth/Auth','OpenID.php',237]], 29],
'usenonce': ['usenonce', 'Return whether this nonce is present. As a side effect, mark it as no longer present. ', [['admin/oauth/Auth/OpenID','FileStore.php',354],['admin/oauth/Auth/OpenID','MemcachedStore.php',161],['admin/oauth/Auth/OpenID','SQLStore.php',480],['admin/oauth/Auth/OpenID','DumbStore.php',81],['admin/oauth/Auth/OpenID','Interface.php',164]], 1],
'_checksetupneeded': ['_checksetupneeded', '', [['admin/oauth/Auth/OpenID','Consumer.php',738]], 1],
'_processcheckauthresponse': ['_processcheckauthresponse', '', [['admin/oauth/Auth/OpenID','Consumer.php',1372]], 1],
'urldefrag': ['urldefrag', '', [['admin/oauth/Auth','OpenID.php',489]], 2],
'getallowedtype': ['getallowedtype', 'Get a pair of assocation type and session type that are supported. ', [['admin/oauth/Auth/OpenID','Association.php',599]], 2],
'redirecturl': ['redirecturl', '', [['admin/oauth/Auth/OpenID','Consumer.php',1907]], 0],
'auth_openid_getavailablesessiontypes': ['auth_openid_getavailablesessiontypes', 'Returns available session types. ', [['admin/oauth/Auth/OpenID','Consumer.php',548]], 1],
'_getassociation': ['_getassociation', '', [['admin/oauth/Auth/OpenID','FileStore.php',296],['admin/oauth/Auth/OpenID','Consumer.php',1432]], 3],
'usesextension': ['usesextension', '', [['admin/oauth/Auth/OpenID','Discover.php',71]], 3],
'shouldsendredirect': ['shouldsendredirect', '', [['admin/oauth/Auth/OpenID','Consumer.php',1958]], 0],
'auth_openid_servererrorcontainer': ['auth_openid_servererrorcontainer', '', [['admin/oauth/Auth/OpenID','Consumer.php',2157]], 1],
'_createassociaterequest': ['_createassociaterequest', '', [['admin/oauth/Auth/OpenID','Consumer.php',1660]], 1],
'updateargs': ['updateargs', '', [['admin/oauth/Auth/OpenID','Message.php',845]], 6],
'auth_openid_genericconsumer': ['auth_openid_genericconsumer', 'This method initializes a new {@link Auth_OpenID_Consumer} instance to access the library. ', [['admin/oauth/Auth/OpenID','Consumer.php',596]], 1],
'fromexpiresin': ['fromexpiresin', 'This is an alternate constructor (factory method) used by the OpenID consumer library to create associations.  OpenID store implementations shouldn\'t use this constructor. ', [['admin/oauth/Auth/OpenID','Association.php',72]], 2],
'post': ['post', 'POST data with client object ', [['admin/oauth/Zend/Gdata','App.php',864],['admin/oauth/Zend/Gdata','Gapps.php',208],['admin/oauth/Auth/Yadis','ParanoidHTTPFetcher.php',178],['admin/oauth/Auth/Yadis','PlainHTTPFetcher.php',153]], 4],
'formmarkup': ['formmarkup', 'Get html for a form to submit this request to the IDP. ', [['admin/oauth/Auth/OpenID','Consumer.php',1919]], 1],
'_doidres': ['_doidres', '', [['admin/oauth/Auth/OpenID','Consumer.php',757]], 1],
'_complete_setup_needed': ['_complete_setup_needed', '', [['admin/oauth/Auth/OpenID','Consumer.php',708]], 0],
'xorsecret': ['xorsecret', '', [['admin/oauth/Auth/OpenID','DiffieHellman.php',98]], 2],
'getaliasedarg': ['getaliasedarg', '', [['admin/oauth/Auth/OpenID','Message.php',888]], 1],
'appendargs': ['appendargs', '"Appends" query arguments onto a URL.  The URL may or may not already have arguments (following a question mark). ', [['admin/oauth/Auth','OpenID.php',311]], 2],
'_checkreturnto': ['_checkreturnto', '', [['admin/oauth/Auth/OpenID','Consumer.php',813]], 1],
'cleanup': ['cleanup', '', [['admin/oauth/Auth/OpenID','Interface.php',90],['admin/oauth/Auth/Yadis','Manager.php',433]], 1],
'_idreschecknonce': ['_idreschecknonce', '', [['admin/oauth/Auth/OpenID','Consumer.php',1243]], 1],
'getarg': ['getarg', '', [['admin/oauth/Auth/OpenID','Message.php',805]], 65],
'_complete_cancel': ['_complete_cancel', '', [['admin/oauth/Auth/OpenID','Consumer.php',687]], 0],
'_verifydiscoverysingle': ['_verifydiscoverysingle', '', [['admin/oauth/Auth/OpenID','Consumer.php',1051]], 4],
'addextensionarg': ['addextensionarg', 'Add an extension argument to this OpenID authentication request. ', [['admin/oauth/Auth/OpenID','Consumer.php',1771]], 0],
'auth_openid_urinorm': ['auth_openid_urinorm', '', [['admin/oauth/Auth/OpenID','URINorm.php',142]], 4],
'htmlmarkup': ['htmlmarkup', 'Get a complete html document that will autosubmit the request to the IDP. ', [['admin/oauth/Auth/OpenID','Consumer.php',1940]], 0],
'getreturnto': ['getreturnto', 'Get the openid.return_to argument from this response. ', [['admin/oauth/Auth/OpenID','Consumer.php',2098],['admin/oauth/Auth/OpenID','Server.php',160]], 3],
'extensionresponse': ['extensionresponse', 'Extract signed extension data from the server\'s response. ', [['admin/oauth/Auth/OpenID','Consumer.php',2041]], 0],
'_complete_error': ['_complete_error', '', [['admin/oauth/Auth/OpenID','Consumer.php',695]], 0],
'getquery': ['getquery', 'Gets the query data from the server environment based on the request method used.  If GET was used, this looks at $_SERVER[\'QUERY_STRING\'] directly.  If POST was used, this fetches data from the special php://input file stream. ', [['admin/oauth/Auth','OpenID.php',128],['admin/oauth/Zend/Gdata','Query.php',296],['admin/oauth/Zend/Uri','Http.php',584]], 12],
'tourl': ['tourl', '', [['admin/oauth/Auth/OpenID','Message.php',698]], 5],
'get': ['get', 'GET a URI using client object. ', [['admin/oauth/Zend/Gdata','App.php',847],['admin/oauth/Zend','Registry.php',130],['admin/oauth/Zend/Gdata','Gapps.php',187],['admin/oauth/Auth/Yadis','ParanoidHTTPFetcher.php',78],['admin/oauth/Auth/Yadis','HTTPFetcher.php',129],['admin/oauth/Auth/OpenID','Message.php',206],['admin/oauth/Auth/OpenID','SReg.php',506],['admin/oauth/Auth/OpenID','AX.php',737],['admin/oauth/Auth/Yadis','Manager.php',29],['admin/oauth/Auth/Yadis','PlainHTTPFetcher.php',37]], 42],
'auth_openid_getmathlib': ['auth_openid_getmathlib', '{@link Auth_OpenID_getMathLib} checks for the presence of long number extension modules and returns an instance of {@link Auth_OpenID_MathWrapper} which exposes the module\'s functionality. ', [['admin/oauth/Auth/OpenID','BigMath.php',397]], 6],
'isopenid1': ['isopenid1', '', [['admin/oauth/Auth/OpenID','Consumer.php',2056],['admin/oauth/Auth/OpenID','Message.php',435]], 26],
'fromkvform': ['fromkvform', '', [['admin/oauth/Auth/OpenID','Message.php',597]], 1],
'getlocalid': ['getlocalid', '', [['admin/oauth/Auth/OpenID','Discover.php',159]], 5],
'setanonymous': ['setanonymous', 'Set whether this request should be made anonymously. If a request is anonymous, the identifier will not be sent in the request. This is only useful if you are making another kind of request with an extension in this request. ', [['admin/oauth/Auth/OpenID','Consumer.php',1795]], 1],
'beginwithoutdiscovery': ['beginwithoutdiscovery', 'Start OpenID verification without doing OpenID server discovery. This method is used internally by Consumer.begin after discovery is performed, and exists to provide an interface for library users needing to perform their own discovery. ', [['admin/oauth/Auth/OpenID','Consumer.php',357]], 1],
'tosession': ['tosession', 'Returns an array of keys and values built from the attributes of $obj.  If $this->prepareForSave($obj) returns an array, its keys and values are used to update the $data array of attributes from $obj. ', [['admin/oauth/Auth/Yadis','Manager.php',154]], 6],
'fromopenidargs': ['fromopenidargs', '', [['admin/oauth/Auth/OpenID','Message.php',480]], 2],
'getopenidnamespace': ['getopenidnamespace', '', [['admin/oauth/Auth/OpenID','Message.php',592]], 12],
'complete': ['complete', 'Called to interpret the server\'s response to an OpenID request. It is called in step 4 of the flow described in the consumer overview. ', [['admin/oauth/Auth/OpenID','Consumer.php',387],['admin/oauth/Auth/OpenID','Consumer.php',646]], 2],
'_requestassociation': ['_requestassociation', '', [['admin/oauth/Auth/OpenID','Consumer.php',1547]], 2],
'getdisplayidentifier': ['getdisplayidentifier', 'Return the display identifier for this response. ', [['admin/oauth/Auth/OpenID','Consumer.php',1982],['admin/oauth/Auth/OpenID','Discover.php',50]], 1],
'topostargs': ['topostargs', '', [['admin/oauth/Auth/OpenID','Message.php',609]], 7],
'auth_openid_consumer': ['auth_openid_consumer', 'Initialize a Consumer instance. ', [['admin/oauth/Auth/OpenID','Consumer.php',232]], 0],
'auth_openid_setupneededresponse': ['auth_openid_setupneededresponse', '', [['admin/oauth/Auth/OpenID','Consumer.php',2221]], 2],
'toformmarkup': ['toformmarkup', '', [['admin/oauth/Auth/OpenID','Server.php',208],['admin/oauth/Auth/OpenID','Server.php',1214],['admin/oauth/Auth/OpenID','Message.php',660]], 6],
'addextension': ['addextension', 'Add an extension to this checkid request. ', [['admin/oauth/Auth/OpenID','Consumer.php',1760],['admin/oauth/Auth/OpenID','Server.php',1246]], 0],
'haskey': ['haskey', '', [['admin/oauth/Auth/OpenID','Message.php',767]], 10],
'getassociation': ['getassociation', 'Retrieve an association. If no handle is specified, return the association with the most recent issue time. ', [['admin/oauth/Auth/OpenID','FileStore.php',226],['admin/oauth/Auth/OpenID','Server.php',1393],['admin/oauth/Auth/OpenID','MemcachedStore.php',87],['admin/oauth/Auth/OpenID','SQLStore.php',409],['admin/oauth/Auth/OpenID','DumbStore.php',65],['admin/oauth/Auth/OpenID','Interface.php',104]], 7],
'auth_openid_authrequest': ['auth_openid_authrequest', 'Initialize an authentication request with the specified token, association, and endpoint. ', [['admin/oauth/Auth/OpenID','Consumer.php',1742]], 1],
'match': ['match', 'Does this URL match the given trust root? ', [['admin/oauth/Auth/OpenID','TrustRoot.php',258]], 77],
'getsigned': ['getsigned', '', [['admin/oauth/Auth/OpenID','Consumer.php',2069]], 1],
'base64tolong': ['base64tolong', '', [['admin/oauth/Auth/OpenID','BigMath.php',112]], 4],
'getnextservice': ['getnextservice', 'Return the next authentication service for the pair of user_input and session. This function handles fallback. ', [['admin/oauth/Auth/Yadis','Manager.php',404]], 1],
'addprefix': ['addprefix', 'Adds a string prefix to all values of an array.  Returns a new array containing the prefixed values. ', [['admin/oauth/Auth','OpenID.php',222]], 1],
'autosubmithtml': ['autosubmithtml', '', [['admin/oauth/Auth','OpenID.php',534]], 3],
'_getopenid1sessiontype': ['_getopenid1sessiontype', 'Given an association response message, extract the OpenID 1.X session type. ', [['admin/oauth/Auth/OpenID','Consumer.php',1694]], 1],
'storeassociation': ['storeassociation', 'Store an association in the association directory. ', [['admin/oauth/Auth/OpenID','FileStore.php',179],['admin/oauth/Auth/OpenID','MemcachedStore.php',50],['admin/oauth/Auth/OpenID','SQLStore.php',346],['admin/oauth/Auth/OpenID','DumbStore.php',58],['admin/oauth/Auth/OpenID','Interface.php',31]], 2],
'getrequest': ['getrequest', '', [['admin/oauth/Auth/OpenID','Consumer.php',468],['admin/oauth/Auth/OpenID','Consumer.php',532]], 1],
'set': ['set', 'setter method, basically same as offsetSet(). ', [['admin/oauth/Zend','Registry.php',153],['admin/oauth/Auth/OpenID','Message.php',190],['admin/oauth/Auth/Yadis','Manager.php',18]], 13],
'del': ['del', 'Deletes a key-value pair from the mapping with the specified key. ', [['admin/oauth/Auth/OpenID','Message.php',244],['admin/oauth/Auth/Yadis','Manager.php',47]], 3],
'auth_openid_failureresponse': ['auth_openid_failureresponse', '', [['admin/oauth/Auth/OpenID','Consumer.php',2132]], 34],
'removeassociation': ['removeassociation', 'Remove an association if it exists. Do nothing if it does not. ', [['admin/oauth/Auth/OpenID','FileStore.php',333],['admin/oauth/Auth/OpenID','MemcachedStore.php',122],['admin/oauth/Auth/OpenID','SQLStore.php',392],['admin/oauth/Auth/OpenID','DumbStore.php',73],['admin/oauth/Auth/OpenID','Interface.php',140]], 4],
'_verifydiscoveryservices': ['_verifydiscoveryservices', '', [['admin/oauth/Auth/OpenID','Consumer.php',1199]], 1],
'extractsecret': ['extractsecret', '', [['admin/oauth/Auth/OpenID','Consumer.php',487],['admin/oauth/Auth/OpenID','Consumer.php',537]], 1],
'auth_openid_diffiehellmansha1consumersession': ['auth_openid_diffiehellmansha1consumersession', '', [['admin/oauth/Auth/OpenID','Consumer.php',459]], 0],
'checkmessagesignature': ['checkmessagesignature', 'Confirm that the signature of these fields matches the signature contained in the data. ', [['admin/oauth/Auth/OpenID','Association.php',361]], 2],
'_verifydiscoveryresultsopenid2': ['_verifydiscoveryresultsopenid2', '', [['admin/oauth/Auth/OpenID','Consumer.php',1103]], 1],
'issigned': ['issigned', '', [['admin/oauth/Auth/OpenID','Consumer.php',2061]], 2],
'_verifydiscoveryresults': ['_verifydiscoveryresults', '', [['admin/oauth/Auth/OpenID','Consumer.php',980]], 1],
'destroymanager': ['destroymanager', '', [['admin/oauth/Auth/Yadis','Manager.php',520]], 3],
'getdiscoveryobject': ['getdiscoveryobject', 'Used in testing to define the discovery mechanism. ', [['admin/oauth/Auth/OpenID','Consumer.php',279]], 2],
'usingdefaultvalues': ['usingdefaultvalues', '', [['admin/oauth/Auth/OpenID','DiffieHellman.php',92]], 1],
'preferrednamespace': ['preferrednamespace', '', [['admin/oauth/Auth/OpenID','Discover.php',76]], 3],
'_discoverandverify': ['_discoverandverify', '', [['admin/oauth/Auth/OpenID','Consumer.php',1179]], 3],
'_idresgetnonceopenid1': ['_idresgetnonceopenid1', 'Extract the nonce from an OpenID 1 response.  Return the nonce from the BARE_NS since we independently check the return_to arguments are the same as those in the response message. ', [['admin/oauth/Auth/OpenID','Consumer.php',1223]], 1],
'auth_openid_successresponse': ['auth_openid_successresponse', '', [['admin/oauth/Auth/OpenID','Consumer.php',2029]], 1],
'auth_openid_mknonce': ['auth_openid_mknonce', '', [['admin/oauth/Auth/OpenID','Nonce.php',93]], 2],
'_completeinvalid': ['_completeinvalid', '', [['admin/oauth/Auth/OpenID','Consumer.php',675]], 1],
'_idrescheckforfields': ['_idrescheckforfields', '', [['admin/oauth/Auth/OpenID','Consumer.php',1281]], 1],
'getargs': ['getargs', '', [['admin/oauth/Auth/OpenID','Message.php',824]], 8],
'_idreschecksignature': ['_idreschecksignature', '', [['admin/oauth/Auth/OpenID','Consumer.php',937]], 1],
'_complete_id_res': ['_complete_id_res', '', [['admin/oauth/Auth/OpenID','Consumer.php',722]], 0],
'auth_openid_splitnonce': ['auth_openid_splitnonce', '', [['admin/oauth/Auth/OpenID','Nonce.php',32]], 2],
'frommessage': ['frommessage', '', [['admin/oauth/Auth/OpenID','Consumer.php',2169],['admin/oauth/Auth/OpenID','Server.php',368],['admin/oauth/Auth/OpenID','Server.php',439],['admin/oauth/Auth/OpenID','Server.php',526],['admin/oauth/Auth/OpenID','Server.php',563],['admin/oauth/Auth/OpenID','Server.php',600],['admin/oauth/Auth/OpenID','Server.php',824]], 1],
'getmanager': ['getmanager', '', [['admin/oauth/Auth/Yadis','Manager.php',469]], 7],
'begin': ['begin', 'Start the OpenID authentication process. See steps 1-2 in the overview at the top of this file. ', [['admin/oauth/Auth/OpenID','Consumer.php',291],['admin/oauth/Auth/OpenID','Consumer.php',625],['admin/oauth/Auth/OpenID','DatabaseConnection.php',55]], 1],
'getsignedns': ['getsignedns', '', [['admin/oauth/Auth/OpenID','Consumer.php',2080]], 4],
'compatibilitymode': ['compatibilitymode', '', [['admin/oauth/Auth/OpenID','Discover.php',117]], 3],
'isopidentifier': ['isopidentifier', '', [['admin/oauth/Auth/OpenID','Discover.php',122]], 3],
'_httpresponsetomessage': ['_httpresponsetomessage', 'Adapt a POST response to a Message. ', [['admin/oauth/Auth/OpenID','Consumer.php',1392]], 1],
'fromsession': ['fromsession', 'Given a session data value (an array), this creates an object (returned by $this->newObject()) whose attributes and values are those in $data.  Returns null if $data lacks keys found in $this->requiredKeys().  Returns null if $this->check($data) evaluates to false.  Returns null if $this->newObject() evaluates to false. ', [['admin/oauth/Auth/Yadis','Manager.php',87]], 3],
'frompostargs': ['frompostargs', '', [['admin/oauth/Auth/OpenID','Message.php',445]], 4],
'tourlencoded': ['tourlencoded', '', [['admin/oauth/Auth/OpenID','Message.php',713]], 1],
'_extractsupportedassociationtype': ['_extractsupportedassociationtype', 'Handle ServerErrors resulting from association requests. ', [['admin/oauth/Auth/OpenID','Consumer.php',1454]], 1],
'array_key_exists': ['array_key_exists', '', [], 125],
'parse_str': ['parse_str', '', [], 3],
'explode': ['explode', '', [], 76],
'copy': ['copy', '', [], 4],
'array_merge': ['array_merge', '', [], 27],
'trigger_error': ['trigger_error', '', [], 35],
'is_string': ['is_string', '', [], 33],
'in_array': ['in_array', '', [], 83],
'call_user_func_array': ['call_user_func_array', '', [], 14],
'print_r': ['print_r', '', [], 7],
'intval': ['intval', '', [], 24],
'base64_decode': ['base64_decode', '', [], 6],
'serialize': ['serialize', '', [], 6],
'is_a': ['is_a', '', [], 16],
'call_user_func': ['call_user_func', '', [], 10],
'parse_url': ['parse_url', '', [], 9],
'is_callable': ['is_callable', '', [], 1],
'define': ['define', '', [], 176]};
CLASS_DATA={
'auth_yadis_phpsession': ['auth_yadis_phpsession', 'The base session class used by the Auth_Yadis_Manager.  This class wraps the default PHP session machinery and should be subclassed if your application doesn\'t use PHP sessioning. ', [['admin/oauth/Auth/Yadis','Manager.php',10]], 1],
'auth_openid_association': ['auth_openid_association', 'This class represents an association between a server and a consumer.  In general, users of this library will never see instances of this object.  The only exception is if you implement a custom {@link Auth_OpenID_OpenIDStore}. ', [['admin/oauth/Auth/OpenID','Association.php',32]], 6],
'auth_openid_genericconsumer': ['auth_openid_genericconsumer', 'This class is the interface to the OpenID consumer logic. Instances of it maintain no per-request state, so they can be reused (or even used by multiple threads concurrently) as needed. ', [['admin/oauth/Auth/OpenID','Consumer.php',561]], 2],
'auth_openid_serviceendpoint': ['auth_openid_serviceendpoint', 'Object representing an OpenID service endpoint. ', [['admin/oauth/Auth/OpenID','Discover.php',35]], 14],
'auth_openid_consumer': ['auth_openid_consumer', 'An OpenID consumer implementation that performs discovery and does session management.  See the Consumer.php file documentation for more information. ', [['admin/oauth/Auth/OpenID','Consumer.php',208]], 0],
'auth_openid_message': ['auth_openid_message', 'In the implementation of this object, null represents the global namespace as well as a namespace with no key. ', [['admin/oauth/Auth/OpenID','Message.php',409]], 14],
'auth_openid_setupneededresponse': ['auth_openid_setupneededresponse', 'A response with a status of Auth_OpenID_SETUP_NEEDED. Indicates that the request was in immediate mode, and the server is unable to authenticate the user without further interaction. ', [['admin/oauth/Auth/OpenID','Consumer.php',2201]], 2],
'auth_openid_cancelresponse': ['auth_openid_cancelresponse', 'A response with a status of Auth_OpenID_CANCEL. Indicates that the user cancelled the OpenID authentication request.  This has two relevant attributes: ', [['admin/oauth/Auth/OpenID','Consumer.php',2180]], 1],
'auth_yadis_discovery': ['auth_yadis_discovery', 'State management for discovery. ', [['admin/oauth/Auth/Yadis','Manager.php',359]], 1],
'auth_yadis_yadis': ['auth_yadis_yadis', 'This is the core of the PHP Yadis library.  This is the only class a user needs to use to perform Yadis discovery.  This class performs the discovery AND stores the result of the discovery. ', [['admin/oauth/Auth/Yadis','Yadis.php',161]], 9],
'auth_openid_diffiehellman': ['auth_openid_diffiehellman', 'The Diffie-Hellman key exchange class.  This class relies on {@link Auth_OpenID_MathLibrary} to perform large number operations. ', [['admin/oauth/Auth/OpenID','DiffieHellman.php',36]], 3],
'auth_openid_authrequest': ['auth_openid_authrequest', 'This class represents an authentication request from a consumer to an OpenID server. ', [['admin/oauth/Auth/OpenID','Consumer.php',1734]], 1],
'auth_openid_serviceendpointloader': ['auth_openid_serviceendpointloader', 'A concrete loader implementation for Auth_OpenID_ServiceEndpoints. ', [['admin/oauth/Auth/Yadis','Manager.php',191]], 4],
'auth_openid_plaintextconsumersession': ['auth_openid_plaintextconsumersession', 'A class implementing plaintext consumer sessions. ', [['admin/oauth/Auth/OpenID','Consumer.php',523]], 1],
'auth_openid_consumerresponse': ['auth_openid_consumerresponse', 'The base class for responses from the Auth_OpenID_Consumer. ', [['admin/oauth/Auth/OpenID','Consumer.php',1964]], 4],
'auth_openid_successresponse': ['auth_openid_successresponse', 'A response with a status of Auth_OpenID_SUCCESS. Indicates that this request is a successful acknowledgement from the OpenID server that the supplied URL is, indeed controlled by the requesting agent.  This has three relevant attributes: ', [['admin/oauth/Auth/OpenID','Consumer.php',2008]], 1],
'auth_openid_failureresponse': ['auth_openid_failureresponse', 'A response with a status of Auth_OpenID_FAILURE. Indicates that the OpenID protocol has failed. This could be locally or remotely triggered.  This has three relevant attributes: ', [['admin/oauth/Auth/OpenID','Consumer.php',2114]], 35],
'auth_openid_typeurimismatch': ['auth_openid_typeurimismatch', 'A specific, internal failure used to detect type URI mismatch. ', [['admin/oauth/Auth/OpenID','Consumer.php',2142]], 1],
'auth_openid_diffiehellmansha1consumersession': ['auth_openid_diffiehellmansha1consumersession', 'A class implementing HMAC/DH-SHA1 consumer sessions. ', [['admin/oauth/Auth/OpenID','Consumer.php',448]], 0],
'auth_openid': ['auth_openid', 'The OpenID utility function class. ', [['admin/oauth/Auth','OpenID.php',109]], 116],
'auth_openid_diffiehellmansha256consumersession': ['auth_openid_diffiehellmansha256consumersession', 'A class implementing HMAC/DH-SHA256 consumer sessions. ', [['admin/oauth/Auth/OpenID','Consumer.php',510]], 0],
'auth_openid_servererrorcontainer': ['auth_openid_servererrorcontainer', 'Exception that is raised when the server returns a 400 response code to a direct request. ', [['admin/oauth/Auth/OpenID','Consumer.php',2150]], 2],
'auth_yadis_managerloader': ['auth_yadis_managerloader', 'A concrete loader implementation for Auth_Yadis_Managers. ', [['admin/oauth/Auth/Yadis','Manager.php',218]], 4]};
CONST_DATA={
};
</script>
<div id="func-popup" class="funcpopup"><p id="func-title" class="popup-title">title</p><p id="func-desc" class="popup-desc">Description</p><p id="func-body" class="popup-body">Body</p></div>
<div id="class-popup" class="funcpopup"><p id="class-title" class="popup-title">title</p><p id="class-desc" class="popup-desc">Description</p><p id="class-body" class="popup-body">Body</p></div>
<div id="const-popup" class="funcpopup"><p id="const-title" class="popup-title">title</p><p id="const-desc" class="popup-desc">Description</p><p id="const-body" class="popup-body">Body</p></div>
<div id="req-popup" class="funcpopup"><p id="req-title" class="popup-title">title</p><p id="req-body" class="popup-body">Body</p></div>
<!-- A link to the phpxref site in your customized footer file is appreciated ;-) -->
<br><hr>
<table width="100%">
	<tr><td>Generated: Tue Dec  7 15:36:31 2010</td>
	<td align="right"><i>Cross-referenced by <a href="http://phpxref.sourceforge.net/">PHPXref 0.7</a></i></td>
	</tr>
</table>
</body></html>
